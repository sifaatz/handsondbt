2021-06-16 07:19:00.258634 (MainThread): Running with dbt=0.19.1
2021-06-16 07:19:00.501050 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:19:00.501655 (MainThread): Tracking: tracking
2021-06-16 07:19:00.507554 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f05c3da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f088c95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f088dd910>]}
2021-06-16 07:19:00.527883 (MainThread): Partial parsing not enabled
2021-06-16 07:19:00.529070 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:19:00.568846 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:19:00.587621 (MainThread): Parsing macros/relations.sql
2021-06-16 07:19:00.588601 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:19:00.589925 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:19:00.620085 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:19:00.623626 (MainThread): Parsing macros/relations.sql
2021-06-16 07:19:00.625656 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:19:00.629257 (MainThread): Parsing macros/core.sql
2021-06-16 07:19:00.635447 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:19:00.700688 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:19:00.714451 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:19:00.715995 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:19:00.718550 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:19:00.721589 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:19:00.724146 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:19:00.725780 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:19:00.739936 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:19:00.761077 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:19:00.764070 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:19:00.773970 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:19:00.806111 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:19:00.851455 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:19:00.854227 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:19:00.882058 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:19:00.892296 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:19:00.900163 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:19:00.909857 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:19:00.914128 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:19:00.916627 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:19:00.919612 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:19:00.930550 (MainThread): Partial parsing not enabled
2021-06-16 07:19:00.969136 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:00.984698 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.118155 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c12da95-afb4-4bde-ac6c-1a9d4d249da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f058ad950>]}
2021-06-16 07:19:01.122819 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c12da95-afb4-4bde-ac6c-1a9d4d249da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f058e9ad0>]}
2021-06-16 07:19:01.123151 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-16 07:19:01.124290 (MainThread): 
2021-06-16 07:19:01.124746 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:19:01.125746 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:19:01.141208 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:19:01.141379 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:19:01.141496 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:19:01.141594 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:19:01.166165 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.02 seconds
2021-06-16 07:19:01.169349 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:19:01.171356 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:19:01.181089 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:19:01.181237 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:19:01.181359 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:19:01.181454 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:19:01.193271 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:19:01.193436 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:19:01.193549 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:19:01.196329 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:19:01.197075 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:19:01.197999 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:19:01.204171 (MainThread): Using redshift connection "master".
2021-06-16 07:19:01.204308 (MainThread): On master: BEGIN
2021-06-16 07:19:01.204423 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:19:01.204520 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:19:01.216253 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:19:01.216442 (MainThread): Using redshift connection "master".
2021-06-16 07:19:01.216567 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:19:01.307645 (MainThread): SQL status: SELECT 3 in 0.09 seconds
2021-06-16 07:19:01.308651 (MainThread): On master: ROLLBACK
2021-06-16 07:19:01.309645 (MainThread): Using redshift connection "master".
2021-06-16 07:19:01.309766 (MainThread): On master: BEGIN
2021-06-16 07:19:01.311598 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.311769 (MainThread): On master: COMMIT
2021-06-16 07:19:01.311893 (MainThread): Using redshift connection "master".
2021-06-16 07:19:01.311998 (MainThread): On master: COMMIT
2021-06-16 07:19:01.312896 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.313041 (MainThread): On master: Close
2021-06-16 07:19:01.313632 (MainThread): 07:19:01 | Concurrency: 1 threads (target='dev')
2021-06-16 07:19:01.313919 (MainThread): 07:19:01 | 
2021-06-16 07:19:01.315677 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:19:01.316039 (Thread-1): 07:19:01 | 1 of 2 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:19:01.316392 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.316570 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:19:01.320125 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:19:01.320572 (Thread-1): finished collecting timing info
2021-06-16 07:19:01.341209 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.341429 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:19:01.341549 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:19:01.341647 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:19:01.353847 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:19:01.360453 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.360594 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:19:01.361791 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:19:01.362929 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.363064 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.363172 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.364129 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.364272 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.364378 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:19:01.365450 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.365623 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.365730 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.365826 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.366783 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.366936 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.367042 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:19:01.368009 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.369874 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.369998 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:19:01.371052 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:19:01.371971 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.372100 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.372206 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.373185 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.373324 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.373442 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:19:01.374392 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.400285 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:19:01.400787 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.400907 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:19:01.402804 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:19:01.411064 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.411207 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:19:01.412434 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:19:01.415033 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.415179 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:19:01.416238 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:19:01.428729 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.428874 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.428981 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.431036 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.433498 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.433628 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:19:01.434621 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.436381 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.436508 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:19:01.438238 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:19:01.439196 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.439329 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.439437 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:19:01.442429 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.442576 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:19:01.442679 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:19:01.443620 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.444229 (Thread-1): finished collecting timing info
2021-06-16 07:19:01.444404 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:19:01.445342 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:19:01.445903 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c12da95-afb4-4bde-ac6c-1a9d4d249da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f047bb210>]}
2021-06-16 07:19:01.446369 (Thread-1): 07:19:01 | 1 of 2 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.13s]
2021-06-16 07:19:01.446672 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:19:01.447091 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:19:01.447359 (Thread-1): 07:19:01 | 2 of 2 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:19:01.447772 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.447928 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:19:01.451219 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:19:01.451542 (Thread-1): finished collecting timing info
2021-06-16 07:19:01.470647 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.470835 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:19:01.470979 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:19:01.471078 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:19:01.483604 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:19:01.485583 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.485719 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:19:01.486827 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:19:01.487851 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.487982 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.488089 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.489045 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.489191 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.489294 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:19:01.490223 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.490398 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.490509 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.490612 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.491606 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.491747 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.491864 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:19:01.492761 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.494419 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.494550 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:19:01.495618 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:19:01.496588 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.496721 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.496829 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.497796 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.497932 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.498032 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:19:01.498953 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.505940 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:19:01.506285 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.506403 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:19:01.508464 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:19:01.511016 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.511151 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:19:01.512229 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:19:01.513550 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.513677 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.513782 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.515571 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.515915 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.516027 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:19:01.516970 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.518745 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.518869 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:19:01.519960 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:19:01.520824 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.520951 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.521058 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:19:01.521999 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.522134 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:19:01.522234 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:19:01.523182 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:19:01.523714 (Thread-1): finished collecting timing info
2021-06-16 07:19:01.523900 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:19:01.524820 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:19:01.525382 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c12da95-afb4-4bde-ac6c-1a9d4d249da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f058c6950>]}
2021-06-16 07:19:01.525849 (Thread-1): 07:19:01 | 2 of 2 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.08s]
2021-06-16 07:19:01.526158 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:19:01.616631 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:19:01.616893 (MainThread): Using redshift connection "master".
2021-06-16 07:19:01.617006 (MainThread): On master: BEGIN
2021-06-16 07:19:01.617116 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:19:01.617220 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:19:01.629529 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:19:01.629727 (MainThread): On master: COMMIT
2021-06-16 07:19:01.629839 (MainThread): Using redshift connection "master".
2021-06-16 07:19:01.629940 (MainThread): On master: COMMIT
2021-06-16 07:19:01.630832 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:19:01.631004 (MainThread): On master: Close
2021-06-16 07:19:01.631531 (MainThread): 07:19:01 | 
2021-06-16 07:19:01.631807 (MainThread): 07:19:01 | Finished running 1 table model, 1 view model in 0.51s.
2021-06-16 07:19:01.632078 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:19:01.632192 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:19:01.632284 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:19:01.638100 (MainThread): 
2021-06-16 07:19:01.638351 (MainThread): Completed successfully
2021-06-16 07:19:01.638606 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 07:19:01.638976 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f088c95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f05bb5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0599d610>]}
2021-06-16 07:19:01.639263 (MainThread): Flushing usage events
2021-06-16 07:26:37.570104 (MainThread): Running with dbt=0.19.1
2021-06-16 07:26:37.808214 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:26:37.808684 (MainThread): Tracking: tracking
2021-06-16 07:26:37.814386 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d240d0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d26ce0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2406bcd0>]}
2021-06-16 07:26:37.834606 (MainThread): Partial parsing not enabled
2021-06-16 07:26:37.835845 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:26:37.875557 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:26:37.894082 (MainThread): Parsing macros/relations.sql
2021-06-16 07:26:37.895083 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:26:37.896458 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:26:37.926546 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:26:37.929992 (MainThread): Parsing macros/relations.sql
2021-06-16 07:26:37.931974 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:26:37.935589 (MainThread): Parsing macros/core.sql
2021-06-16 07:26:37.941748 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:26:38.006227 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:26:38.019845 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:26:38.021323 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:26:38.023899 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:26:38.026983 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:26:38.029440 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:26:38.031042 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:26:38.044792 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:26:38.065308 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:26:38.068236 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:26:38.077953 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:26:38.109858 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:26:38.154553 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:26:38.157262 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:26:38.184391 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:26:38.194534 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:26:38.202206 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:26:38.211660 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:26:38.215878 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:26:38.218202 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:26:38.221127 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:26:38.231909 (MainThread): Partial parsing not enabled
2021-06-16 07:26:38.270091 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:26:38.285369 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:26:38.290978 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:26:38.295446 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:26:38.414329 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d23f18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d23f184d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d23d83f90>]}
2021-06-16 07:26:38.414731 (MainThread): Flushing usage events
2021-06-16 07:26:38.804729 (MainThread): Connection 'model.my_new_project.cls_customers' was properly closed.
2021-06-16 07:26:38.805285 (MainThread): Encountered an error:
2021-06-16 07:26:38.805610 (MainThread): Compilation Error in model cls_customers (models/northwind/cls_customers.sql)
  Model 'model.my_new_project.cls_customers' (models/northwind/cls_customers.sql) depends on a source named 'northwind.customers' which was not found
2021-06-16 07:26:38.811482 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model cls_customers (models/northwind/cls_customers.sql)
  Model 'model.my_new_project.cls_customers' (models/northwind/cls_customers.sql) depends on a source named 'northwind.customers' which was not found

2021-06-16 07:27:24.584562 (MainThread): Running with dbt=0.19.1
2021-06-16 07:27:24.836064 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:27:24.836570 (MainThread): Tracking: tracking
2021-06-16 07:27:24.842278 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36a382910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cf94690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cf94710>]}
2021-06-16 07:27:24.862737 (MainThread): Partial parsing not enabled
2021-06-16 07:27:24.863993 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:27:24.906980 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:27:24.925714 (MainThread): Parsing macros/relations.sql
2021-06-16 07:27:24.926696 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:27:24.928082 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:27:24.958594 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:27:24.962022 (MainThread): Parsing macros/relations.sql
2021-06-16 07:27:24.964043 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:27:24.967728 (MainThread): Parsing macros/core.sql
2021-06-16 07:27:24.973959 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:27:25.039315 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:27:25.052880 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:27:25.054364 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:27:25.056909 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:27:25.059939 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:27:25.062403 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:27:25.064053 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:27:25.078055 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:27:25.098830 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:27:25.101738 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:27:25.111461 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:27:25.142777 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:27:25.187285 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:27:25.189969 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:27:25.217236 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:27:25.227463 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:27:25.235080 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:27:25.244757 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:27:25.249078 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:27:25.251444 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:27:25.254253 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:27:25.265109 (MainThread): Partial parsing not enabled
2021-06-16 07:27:25.303693 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.319277 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.325171 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.330101 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:27:25.481304 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dfb33fb-41cb-4170-82af-e1b9e6c2327d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36a154e90>]}
2021-06-16 07:27:25.486851 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dfb33fb-41cb-4170-82af-e1b9e6c2327d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa370638f50>]}
2021-06-16 07:27:25.487249 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:27:25.488479 (MainThread): 
2021-06-16 07:27:25.488960 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:27:25.490088 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:27:25.505768 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:27:25.505967 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:27:25.506083 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:27:25.506180 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.530249 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.02 seconds
2021-06-16 07:27:25.533616 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:27:25.534326 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:27:25.536335 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:27:25.536465 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:27:25.536576 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:27:25.536671 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.550144 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.01 seconds
2021-06-16 07:27:25.550814 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:27:25.551656 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa_cls".
2021-06-16 07:27:25.551991 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa_cls".
2021-06-16 07:27:25.552182 (ThreadPoolExecutor-0_0): Creating schema ""postgres"."sifa_cls""
2021-06-16 07:27:25.560836 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_cls".
2021-06-16 07:27:25.560991 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cls: BEGIN
2021-06-16 07:27:25.561101 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:27:25.561202 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.572677 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:25.572851 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_cls".
2021-06-16 07:27:25.572963 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cls: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_postgres_sifa_cls"} */
create schema if not exists "sifa_cls"
2021-06-16 07:27:25.574090 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.00 seconds
2021-06-16 07:27:25.575345 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cls: COMMIT
2021-06-16 07:27:25.575482 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_cls".
2021-06-16 07:27:25.575589 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cls: COMMIT
2021-06-16 07:27:25.577736 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.577893 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cls: Close
2021-06-16 07:27:25.580117 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:27:25.590020 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:27:25.590172 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:27:25.590283 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:27:25.590389 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.602220 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:25.602408 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:27:25.602521 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:27:25.605211 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:27:25.605971 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:27:25.606973 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:27:25.607638 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cls".
2021-06-16 07:27:25.609806 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cls".
2021-06-16 07:27:25.609929 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: BEGIN
2021-06-16 07:27:25.610038 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:27:25.610129 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.621198 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:25.621383 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cls".
2021-06-16 07:27:25.621496 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cls"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cls'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cls'
  
2021-06-16 07:27:25.624073 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.00 seconds
2021-06-16 07:27:25.624453 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: ROLLBACK
2021-06-16 07:27:25.625367 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: Close
2021-06-16 07:27:25.632565 (MainThread): Using redshift connection "master".
2021-06-16 07:27:25.632710 (MainThread): On master: BEGIN
2021-06-16 07:27:25.632819 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:27:25.632911 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.644532 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:25.644717 (MainThread): Using redshift connection "master".
2021-06-16 07:27:25.644842 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:27:25.736193 (MainThread): SQL status: SELECT 3 in 0.09 seconds
2021-06-16 07:27:25.737187 (MainThread): On master: ROLLBACK
2021-06-16 07:27:25.738289 (MainThread): Using redshift connection "master".
2021-06-16 07:27:25.738422 (MainThread): On master: BEGIN
2021-06-16 07:27:25.740208 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.740348 (MainThread): On master: COMMIT
2021-06-16 07:27:25.740449 (MainThread): Using redshift connection "master".
2021-06-16 07:27:25.740542 (MainThread): On master: COMMIT
2021-06-16 07:27:25.741467 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.741605 (MainThread): On master: Close
2021-06-16 07:27:25.742163 (MainThread): 07:27:25 | Concurrency: 1 threads (target='dev')
2021-06-16 07:27:25.742451 (MainThread): 07:27:25 | 
2021-06-16 07:27:25.744261 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:27:25.744603 (Thread-1): 07:27:25 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:27:25.744955 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.745130 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:27:25.748585 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:27:25.748941 (Thread-1): finished collecting timing info
2021-06-16 07:27:25.768989 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.769175 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:27:25.769292 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:27:25.769386 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.783555 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:25.790155 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.790293 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:27:25.791405 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:27:25.792408 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.792535 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.792639 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.793601 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.793744 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.793847 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:27:25.794784 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.794977 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.795085 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.795179 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.796083 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.796214 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.796312 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:27:25.797271 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.798960 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.799087 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:27:25.800151 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:27:25.801061 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.801185 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.801289 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.802396 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.802530 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.802629 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:27:25.803607 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.830155 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:27:25.830645 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.830765 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:27:25.832659 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:27:25.841257 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.841436 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:27:25.842672 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:27:25.845593 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.845788 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:27:25.846852 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:27:25.858231 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.858400 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.858519 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.860848 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.863300 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.863446 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:27:25.864424 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.866487 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.866625 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:27:25.868211 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:27:25.869171 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.869296 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.869401 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:27:25.872243 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.872388 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:27:25.872492 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:27:25.873453 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.874032 (Thread-1): finished collecting timing info
2021-06-16 07:27:25.874205 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:27:25.875140 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:27:25.875747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dfb33fb-41cb-4170-82af-e1b9e6c2327d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa369f604d0>]}
2021-06-16 07:27:25.876229 (Thread-1): 07:27:25 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.13s]
2021-06-16 07:27:25.876531 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:27:25.876732 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:27:25.877210 (Thread-1): 07:27:25 | 2 of 3 START table model sifa_cls.cls_customers...................... [RUN]
2021-06-16 07:27:25.877636 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.877797 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:27:25.881310 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:27:25.881659 (Thread-1): finished collecting timing info
2021-06-16 07:27:25.883555 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.883697 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:27:25.883816 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:27:25.883914 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.895358 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:25.897815 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.897947 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_tmp" cascade
2021-06-16 07:27:25.899017 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:27:25.900047 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.900173 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.900276 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.901192 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.901327 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.901427 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:27:25.902333 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.902499 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.902600 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.902693 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.903641 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.903830 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.903948 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:27:25.904870 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.906697 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.906822 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_backup" cascade
2021-06-16 07:27:25.907878 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:27:25.908896 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.909041 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.909147 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.910053 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.910186 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.910286 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:27:25.911211 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.912382 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:27:25.912749 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.912865 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create  table
    "postgres"."sifa_cls"."cls_customers__dbt_tmp"
    
    
  as (
    




select * from "postgres"."northwind"."customers"
  );
2021-06-16 07:27:25.917275 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 07:27:25.919797 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.919925 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa_cls"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:27:25.921004 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:27:25.922286 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.922418 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.922526 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.924455 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.924737 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.924850 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:27:25.925791 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.927696 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.927838 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_backup" cascade
2021-06-16 07:27:25.928857 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:27:25.929724 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.929849 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.929952 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:27:25.930880 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.931038 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:27:25.931140 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:27:25.932061 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.932569 (Thread-1): finished collecting timing info
2021-06-16 07:27:25.932736 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:27:25.933641 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:27:25.934214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dfb33fb-41cb-4170-82af-e1b9e6c2327d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa369f81850>]}
2021-06-16 07:27:25.934625 (Thread-1): 07:27:25 | 2 of 3 OK created table model sifa_cls.cls_customers................. [SELECT 91 in 0.06s]
2021-06-16 07:27:25.934932 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:27:25.935131 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:27:25.935509 (Thread-1): 07:27:25 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:27:25.935904 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.936052 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:27:25.940599 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:27:25.940953 (Thread-1): finished collecting timing info
2021-06-16 07:27:25.960374 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.960547 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:27:25.960663 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:27:25.960758 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:25.972292 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:25.974081 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.974208 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:27:25.975258 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:27:25.976293 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:25.976423 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.976539 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:25.977484 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.977624 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.977738 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:27:25.978642 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.978818 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:25.978949 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.979050 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:25.979961 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.980093 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.980192 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:27:25.981085 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.982827 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.982984 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:27:25.983989 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:27:25.984946 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:25.985082 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.985199 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:25.986145 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:25.986282 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.986390 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:27:25.987325 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:25.994095 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:27:25.994498 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.994631 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:27:25.996495 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:27:25.999203 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:25.999343 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:27:26.000446 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:27:26.001751 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:26.001875 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:26.001976 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:26.003908 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:26.004180 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:26.004290 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:27:26.005219 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:26.006934 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:26.007059 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:27:26.008092 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:27:26.008944 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:26.009073 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:26.009174 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:27:26.010084 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:26.010214 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:27:26.010318 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:27:26.011198 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:27:26.011704 (Thread-1): finished collecting timing info
2021-06-16 07:27:26.011867 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:27:26.012755 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:27:26.013291 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dfb33fb-41cb-4170-82af-e1b9e6c2327d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3684db550>]}
2021-06-16 07:27:26.013747 (Thread-1): 07:27:26 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.08s]
2021-06-16 07:27:26.014028 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:27:26.051866 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:27:26.052131 (MainThread): Using redshift connection "master".
2021-06-16 07:27:26.052245 (MainThread): On master: BEGIN
2021-06-16 07:27:26.052355 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:27:26.052451 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:27:26.064040 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:27:26.064255 (MainThread): On master: COMMIT
2021-06-16 07:27:26.064367 (MainThread): Using redshift connection "master".
2021-06-16 07:27:26.064470 (MainThread): On master: COMMIT
2021-06-16 07:27:26.065364 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:27:26.065510 (MainThread): On master: Close
2021-06-16 07:27:26.066084 (MainThread): 07:27:26 | 
2021-06-16 07:27:26.066362 (MainThread): 07:27:26 | Finished running 2 table models, 1 view model in 0.58s.
2021-06-16 07:27:26.066618 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:27:26.066726 (MainThread): Connection 'create_postgres_sifa_cls' was properly closed.
2021-06-16 07:27:26.066817 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:27:26.071576 (MainThread): 
2021-06-16 07:27:26.071831 (MainThread): Completed successfully
2021-06-16 07:27:26.072069 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:27:26.072420 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3684db550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3684c23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa369f7d490>]}
2021-06-16 07:27:26.072703 (MainThread): Flushing usage events
2021-06-16 07:29:46.072143 (MainThread): Running with dbt=0.19.1
2021-06-16 07:29:46.309862 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:29:46.310340 (MainThread): Tracking: tracking
2021-06-16 07:29:46.316210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ee480490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6eb7ae6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ee45fc90>]}
2021-06-16 07:29:46.337023 (MainThread): Partial parsing not enabled
2021-06-16 07:29:46.338235 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:29:46.378415 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:29:46.397077 (MainThread): Parsing macros/relations.sql
2021-06-16 07:29:46.398045 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:29:46.399394 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:29:46.429876 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:29:46.433293 (MainThread): Parsing macros/relations.sql
2021-06-16 07:29:46.435380 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:29:46.439048 (MainThread): Parsing macros/core.sql
2021-06-16 07:29:46.445311 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:29:46.510939 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:29:46.524655 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:29:46.526146 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:29:46.528791 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:29:46.531834 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:29:46.534290 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:29:46.535952 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:29:46.549911 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:29:46.570710 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:29:46.573506 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:29:46.583233 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:29:46.614785 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:29:46.659705 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:29:46.662383 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:29:46.689753 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:29:46.699999 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:29:46.707778 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:29:46.717244 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:29:46.721398 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:29:46.723771 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:29:46.726739 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:29:46.737453 (MainThread): Partial parsing not enabled
2021-06-16 07:29:46.775939 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:46.791303 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:46.797250 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:46.801758 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:29:46.959189 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83e5872b-5ea4-44cd-a582-6311b5ebf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6eec79890>]}
2021-06-16 07:29:46.964856 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83e5872b-5ea4-44cd-a582-6311b5ebf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6eb7e1e10>]}
2021-06-16 07:29:46.965228 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:29:46.966563 (MainThread): 
2021-06-16 07:29:46.967076 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:29:46.968225 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:29:46.983752 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:29:46.983903 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:29:46.984018 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:29:46.984117 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.005795 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.02 seconds
2021-06-16 07:29:47.011198 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:29:47.011884 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:29:47.013835 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:29:47.013962 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:29:47.014075 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:29:47.014169 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.028381 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.01 seconds
2021-06-16 07:29:47.028895 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:29:47.031025 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cls".
2021-06-16 07:29:47.040630 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cls".
2021-06-16 07:29:47.040762 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: BEGIN
2021-06-16 07:29:47.040871 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:29:47.040973 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.052220 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:29:47.052370 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cls".
2021-06-16 07:29:47.052477 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cls"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cls'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cls'
  
2021-06-16 07:29:47.055132 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:29:47.055800 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: ROLLBACK
2021-06-16 07:29:47.056768 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: Close
2021-06-16 07:29:47.057388 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:29:47.059502 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:29:47.059630 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:29:47.059737 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:29:47.059836 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.070826 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:29:47.071014 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:29:47.071130 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:29:47.073750 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:29:47.074453 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:29:47.075443 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:29:47.082742 (MainThread): Using redshift connection "master".
2021-06-16 07:29:47.082992 (MainThread): On master: BEGIN
2021-06-16 07:29:47.083129 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:29:47.083226 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.094801 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:29:47.095036 (MainThread): Using redshift connection "master".
2021-06-16 07:29:47.095153 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:29:47.192933 (MainThread): SQL status: SELECT 3 in 0.10 seconds
2021-06-16 07:29:47.193886 (MainThread): On master: ROLLBACK
2021-06-16 07:29:47.194878 (MainThread): Using redshift connection "master".
2021-06-16 07:29:47.195026 (MainThread): On master: BEGIN
2021-06-16 07:29:47.196767 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.196898 (MainThread): On master: COMMIT
2021-06-16 07:29:47.197004 (MainThread): Using redshift connection "master".
2021-06-16 07:29:47.197098 (MainThread): On master: COMMIT
2021-06-16 07:29:47.197972 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.198114 (MainThread): On master: Close
2021-06-16 07:29:47.198668 (MainThread): 07:29:47 | Concurrency: 1 threads (target='dev')
2021-06-16 07:29:47.199001 (MainThread): 07:29:47 | 
2021-06-16 07:29:47.200656 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:29:47.200982 (Thread-1): 07:29:47 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:29:47.201326 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.201488 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:29:47.204846 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:29:47.205201 (Thread-1): finished collecting timing info
2021-06-16 07:29:47.225044 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.225198 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:29:47.225319 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:29:47.225412 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.237016 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:29:47.243362 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.243495 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:29:47.244532 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:29:47.245670 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.245805 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.245913 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.246825 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.246990 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.247096 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:29:47.248014 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.248177 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.248278 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.248370 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.249357 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.249540 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.249657 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:29:47.250651 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.252400 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.252538 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:29:47.253505 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:29:47.254382 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.254513 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.254616 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.255554 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.255692 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.255799 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:29:47.256685 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.282130 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:29:47.282581 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.282701 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:29:47.284493 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:29:47.292477 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.292611 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:29:47.293782 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:29:47.296458 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.296593 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:29:47.297679 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:29:47.309052 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.309205 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.309311 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.311200 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.313668 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.313798 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:29:47.314729 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.316803 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.316934 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:29:47.318393 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:29:47.319408 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.319539 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.319645 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:29:47.322581 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.322750 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:29:47.322867 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:29:47.323797 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.324438 (Thread-1): finished collecting timing info
2021-06-16 07:29:47.324612 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:29:47.325537 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:29:47.326159 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5872b-5ea4-44cd-a582-6311b5ebf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6eaa11d90>]}
2021-06-16 07:29:47.326654 (Thread-1): 07:29:47 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.12s]
2021-06-16 07:29:47.326967 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:29:47.327157 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:29:47.327635 (Thread-1): 07:29:47 | 2 of 3 START table model sifa_cls.cls_customers...................... [RUN]
2021-06-16 07:29:47.328055 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.328205 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:29:47.331942 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:29:47.332289 (Thread-1): finished collecting timing info
2021-06-16 07:29:47.334298 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.334430 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:29:47.334551 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:29:47.334647 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.346016 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:29:47.347909 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.348037 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_tmp" cascade
2021-06-16 07:29:47.349081 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:29:47.350048 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.350171 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.350272 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.351148 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.351283 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.351380 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:29:47.352266 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.352425 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.352524 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.352614 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.353517 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.353646 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.353750 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:29:47.354648 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.356324 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.356463 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_backup" cascade
2021-06-16 07:29:47.357515 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:29:47.358412 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.358535 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.358636 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.359551 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.359695 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.359803 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:29:47.360664 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.361761 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:29:47.362113 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.362229 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create  table
    "postgres"."sifa_cls"."cls_customers__dbt_tmp"
    
    
  as (
    




select * from "postgres"."northwind"."customers"
  );
2021-06-16 07:29:47.366691 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 07:29:47.369248 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.369374 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa_cls"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:29:47.370489 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:29:47.372956 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.373088 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa_cls"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:29:47.374110 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:29:47.375368 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.375503 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.375607 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.377341 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.377605 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.377715 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:29:47.378641 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.381526 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.381650 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_backup" cascade
2021-06-16 07:29:47.383058 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:29:47.383949 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.384082 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.384189 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:29:47.387042 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.387175 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:29:47.387274 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:29:47.388208 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.388696 (Thread-1): finished collecting timing info
2021-06-16 07:29:47.388857 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:29:47.389751 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:29:47.390273 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5872b-5ea4-44cd-a582-6311b5ebf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f0843210>]}
2021-06-16 07:29:47.390707 (Thread-1): 07:29:47 | 2 of 3 OK created table model sifa_cls.cls_customers................. [SELECT 91 in 0.06s]
2021-06-16 07:29:47.391007 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:29:47.391192 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:29:47.391526 (Thread-1): 07:29:47 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:29:47.391925 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.392063 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:29:47.394838 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:29:47.395201 (Thread-1): finished collecting timing info
2021-06-16 07:29:47.414382 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.414547 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:29:47.414662 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:29:47.414756 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.426241 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:29:47.428073 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.428202 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:29:47.429311 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:29:47.430254 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.430376 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.430485 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.431397 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.431533 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.431631 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:29:47.432511 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.432672 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.432769 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.432859 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.433743 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.433873 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.433969 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:29:47.434851 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.436635 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.436753 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:29:47.437799 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:29:47.438681 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.438804 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.438927 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.439836 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.439967 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.440062 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:29:47.440939 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.447632 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:29:47.448009 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.448127 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:29:47.449920 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:29:47.452455 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.452581 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:29:47.453621 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:29:47.454869 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.455036 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.455142 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.456668 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.456927 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.457035 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:29:47.457959 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.459666 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.459800 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:29:47.460770 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:29:47.461627 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.461751 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.461851 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:29:47.462760 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.462911 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:29:47.463017 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:29:47.463906 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:29:47.464404 (Thread-1): finished collecting timing info
2021-06-16 07:29:47.464570 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:29:47.465453 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:29:47.465981 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5872b-5ea4-44cd-a582-6311b5ebf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f0849610>]}
2021-06-16 07:29:47.466426 (Thread-1): 07:29:47 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.07s]
2021-06-16 07:29:47.466717 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:29:47.511641 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:29:47.511909 (MainThread): Using redshift connection "master".
2021-06-16 07:29:47.512020 (MainThread): On master: BEGIN
2021-06-16 07:29:47.512127 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:29:47.512217 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:29:47.524159 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:29:47.524387 (MainThread): On master: COMMIT
2021-06-16 07:29:47.524505 (MainThread): Using redshift connection "master".
2021-06-16 07:29:47.524615 (MainThread): On master: COMMIT
2021-06-16 07:29:47.525585 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:29:47.525742 (MainThread): On master: Close
2021-06-16 07:29:47.526334 (MainThread): 07:29:47 | 
2021-06-16 07:29:47.526654 (MainThread): 07:29:47 | Finished running 2 table models, 1 view model in 0.56s.
2021-06-16 07:29:47.526898 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:29:47.527051 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:29:47.527158 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:29:47.532224 (MainThread): 
2021-06-16 07:29:47.532479 (MainThread): Completed successfully
2021-06-16 07:29:47.532718 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:29:47.533091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6eec79890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6eb4a7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6eb541b10>]}
2021-06-16 07:29:47.533346 (MainThread): Flushing usage events
2021-06-16 07:31:21.377238 (MainThread): Running with dbt=0.19.1
2021-06-16 07:31:21.621127 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:31:21.621599 (MainThread): Tracking: tracking
2021-06-16 07:31:21.627247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1953b4a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1953b4af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19567a4f50>]}
2021-06-16 07:31:21.647720 (MainThread): Partial parsing not enabled
2021-06-16 07:31:21.648890 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:31:21.688834 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:31:21.707488 (MainThread): Parsing macros/relations.sql
2021-06-16 07:31:21.708484 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:31:21.709809 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:31:21.740212 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:31:21.743747 (MainThread): Parsing macros/relations.sql
2021-06-16 07:31:21.745765 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:31:21.749449 (MainThread): Parsing macros/core.sql
2021-06-16 07:31:21.755809 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:31:21.820788 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:31:21.834567 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:31:21.836238 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:31:21.838781 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:31:21.841855 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:31:21.844410 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:31:21.846037 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:31:21.860507 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:31:21.881680 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:31:21.884608 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:31:21.894468 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:31:21.926532 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:31:21.972001 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:31:21.974788 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:31:22.002752 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:31:22.013022 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:31:22.020976 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:31:22.030576 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:31:22.034743 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:31:22.037223 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:31:22.040151 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:31:22.051078 (MainThread): Partial parsing not enabled
2021-06-16 07:31:22.090087 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.105555 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.111392 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.115823 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:31:22.269726 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ee94e93-12ea-4d8e-99e0-fcd1924ca94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19537c6c50>]}
2021-06-16 07:31:22.275421 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ee94e93-12ea-4d8e-99e0-fcd1924ca94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f195393bdd0>]}
2021-06-16 07:31:22.275736 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:31:22.277083 (MainThread): 
2021-06-16 07:31:22.277547 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:31:22.278687 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:31:22.294309 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:31:22.294480 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:31:22.294603 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:31:22.294703 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.362489 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.07 seconds
2021-06-16 07:31:22.365903 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:31:22.366589 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:31:22.368479 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:31:22.368603 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:31:22.368712 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:31:22.368803 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.408185 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.04 seconds
2021-06-16 07:31:22.408866 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:31:22.411006 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:31:22.420815 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:31:22.420947 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:31:22.421064 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:31:22.421155 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.433400 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:31:22.433590 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:31:22.433705 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:31:22.436442 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:31:22.437231 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:31:22.438397 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:31:22.439084 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cls".
2021-06-16 07:31:22.441308 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cls".
2021-06-16 07:31:22.441433 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: BEGIN
2021-06-16 07:31:22.441540 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:31:22.441630 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.453438 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:31:22.453614 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cls".
2021-06-16 07:31:22.453727 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cls"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cls'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cls'
  
2021-06-16 07:31:22.456482 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:31:22.457189 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: ROLLBACK
2021-06-16 07:31:22.458169 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cls: Close
2021-06-16 07:31:22.465577 (MainThread): Using redshift connection "master".
2021-06-16 07:31:22.465716 (MainThread): On master: BEGIN
2021-06-16 07:31:22.465823 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:31:22.465913 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.481375 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:31:22.481593 (MainThread): Using redshift connection "master".
2021-06-16 07:31:22.481702 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:31:22.581263 (MainThread): SQL status: SELECT 3 in 0.10 seconds
2021-06-16 07:31:22.582249 (MainThread): On master: ROLLBACK
2021-06-16 07:31:22.587099 (MainThread): Using redshift connection "master".
2021-06-16 07:31:22.587249 (MainThread): On master: BEGIN
2021-06-16 07:31:22.596730 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:31:22.596899 (MainThread): On master: COMMIT
2021-06-16 07:31:22.597006 (MainThread): Using redshift connection "master".
2021-06-16 07:31:22.597112 (MainThread): On master: COMMIT
2021-06-16 07:31:22.603237 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-06-16 07:31:22.603450 (MainThread): On master: Close
2021-06-16 07:31:22.604036 (MainThread): 07:31:22 | Concurrency: 1 threads (target='dev')
2021-06-16 07:31:22.604308 (MainThread): 07:31:22 | 
2021-06-16 07:31:22.608109 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:31:22.608468 (Thread-1): 07:31:22 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:31:22.608868 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.609037 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:31:22.612440 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:31:22.612801 (Thread-1): finished collecting timing info
2021-06-16 07:31:22.633167 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.633362 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:31:22.633474 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:31:22.633564 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.664431 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-06-16 07:31:22.671207 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.671387 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:31:22.672814 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:31:22.673976 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.674099 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.674209 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.675150 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.675291 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.675391 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:31:22.676286 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.676449 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.676550 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.676641 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.677629 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.677793 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.677903 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:31:22.678977 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.680856 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.680990 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:31:22.682037 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:31:22.682999 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.683138 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.683243 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.684162 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.684299 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.684400 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:31:22.685309 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.711302 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:31:22.711840 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.711962 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:31:22.714010 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:31:22.722064 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.722197 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:31:22.723378 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:31:22.725895 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.726025 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:31:22.727182 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:31:22.738296 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.738444 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.738551 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.743489 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.746195 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.746326 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:31:22.748945 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.751007 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.751138 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:31:22.755769 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:31:22.756862 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.756992 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.757101 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:31:22.762729 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 07:31:22.762905 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:31:22.763016 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:31:22.767935 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.768587 (Thread-1): finished collecting timing info
2021-06-16 07:31:22.768759 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:31:22.774225 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:31:22.774843 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ee94e93-12ea-4d8e-99e0-fcd1924ca94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1952d33b10>]}
2021-06-16 07:31:22.775318 (Thread-1): 07:31:22 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.17s]
2021-06-16 07:31:22.775633 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:31:22.775835 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:31:22.776344 (Thread-1): 07:31:22 | 2 of 3 START table model sifa_cls.cls_customers...................... [RUN]
2021-06-16 07:31:22.776766 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.776920 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:31:22.780679 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:31:22.781034 (Thread-1): finished collecting timing info
2021-06-16 07:31:22.783083 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.783222 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:31:22.783338 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:31:22.783436 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.795662 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:31:22.797548 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.797676 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_tmp" cascade
2021-06-16 07:31:22.798735 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:31:22.799804 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.799934 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.800041 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.800982 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.801116 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.801217 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:31:22.802206 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.802375 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.802481 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.802579 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.803743 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.803877 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.803977 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:31:22.804954 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.806639 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.806764 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_backup" cascade
2021-06-16 07:31:22.807909 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:31:22.808809 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.808942 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.809047 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.810019 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.810154 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.810262 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:31:22.811161 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.812341 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:31:22.812754 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.812885 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create  table
    "postgres"."sifa_cls"."cls_customers__dbt_tmp"
    
    
  as (
    




select * from "postgres"."northwind"."customers"
  );
2021-06-16 07:31:22.817032 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 07:31:22.819691 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.819824 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa_cls"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:31:22.820968 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:31:22.823578 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.823709 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa_cls"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:31:22.825231 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:31:22.826505 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.826630 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.826732 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.832155 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 07:31:22.832438 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.832548 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:31:22.838014 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:31:22.841334 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.841464 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop table if exists "postgres"."sifa_cls"."cls_customers__dbt_backup" cascade
2021-06-16 07:31:22.846293 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:31:22.847322 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.847454 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.847572 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:31:22.850549 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.850683 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:31:22.850783 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:31:22.851773 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.852356 (Thread-1): finished collecting timing info
2021-06-16 07:31:22.852523 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:31:22.855666 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:31:22.856233 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ee94e93-12ea-4d8e-99e0-fcd1924ca94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1958b74110>]}
2021-06-16 07:31:22.856666 (Thread-1): 07:31:22 | 2 of 3 OK created table model sifa_cls.cls_customers................. [SELECT 91 in 0.08s]
2021-06-16 07:31:22.856938 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:31:22.857124 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:31:22.857476 (Thread-1): 07:31:22 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:31:22.857879 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.858032 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:31:22.861137 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:31:22.861493 (Thread-1): finished collecting timing info
2021-06-16 07:31:22.881205 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.881400 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:31:22.881514 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:31:22.881608 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:22.898146 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:31:22.900163 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.900292 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:31:22.901328 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:31:22.902341 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.902467 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.902573 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.903553 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.903699 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.903804 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:31:22.904726 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.904903 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.905009 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.905105 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.906008 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.906148 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.906248 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:31:22.907159 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.909000 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.909123 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:31:22.910147 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:31:22.911064 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.911191 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.911295 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.912258 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.912390 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.912488 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:31:22.913422 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.920415 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:31:22.920833 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.920954 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:31:22.923031 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:31:22.925875 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.926003 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:31:22.927067 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:31:22.928361 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.928486 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.928589 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.930208 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.930464 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.930571 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:31:22.931532 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.933238 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.933374 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:31:22.934395 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:31:22.935311 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.935468 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.935577 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:31:22.936520 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:22.936651 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:31:22.936750 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:31:22.937686 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:31:22.938219 (Thread-1): finished collecting timing info
2021-06-16 07:31:22.938400 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:31:22.939283 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:31:22.939833 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ee94e93-12ea-4d8e-99e0-fcd1924ca94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1958b7f390>]}
2021-06-16 07:31:22.940279 (Thread-1): 07:31:22 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.08s]
2021-06-16 07:31:22.940557 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:31:23.013542 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:31:23.013801 (MainThread): Using redshift connection "master".
2021-06-16 07:31:23.013917 (MainThread): On master: BEGIN
2021-06-16 07:31:23.014028 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:31:23.014129 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:31:23.026597 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:31:23.026781 (MainThread): On master: COMMIT
2021-06-16 07:31:23.026928 (MainThread): Using redshift connection "master".
2021-06-16 07:31:23.027057 (MainThread): On master: COMMIT
2021-06-16 07:31:23.028008 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:31:23.028166 (MainThread): On master: Close
2021-06-16 07:31:23.028685 (MainThread): 07:31:23 | 
2021-06-16 07:31:23.028963 (MainThread): 07:31:23 | Finished running 2 table models, 1 view model in 0.75s.
2021-06-16 07:31:23.029232 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:31:23.029339 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:31:23.029429 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:31:23.034392 (MainThread): 
2021-06-16 07:31:23.034639 (MainThread): Completed successfully
2021-06-16 07:31:23.034918 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:31:23.035256 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1958b7f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1958b84c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f195376f450>]}
2021-06-16 07:31:23.035561 (MainThread): Flushing usage events
2021-06-16 07:34:15.098476 (MainThread): Running with dbt=0.19.1
2021-06-16 07:34:15.342660 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:34:15.343187 (MainThread): Tracking: tracking
2021-06-16 07:34:15.348878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062d8a0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062d8386d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062d839ed0>]}
2021-06-16 07:34:15.369258 (MainThread): Partial parsing not enabled
2021-06-16 07:34:15.370459 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:34:15.410721 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:34:15.429975 (MainThread): Parsing macros/relations.sql
2021-06-16 07:34:15.431046 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:34:15.432357 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:34:15.463100 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:34:15.466760 (MainThread): Parsing macros/relations.sql
2021-06-16 07:34:15.468815 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:34:15.472432 (MainThread): Parsing macros/core.sql
2021-06-16 07:34:15.478712 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:34:15.544519 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:34:15.558667 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:34:15.560222 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:34:15.562832 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:34:15.565949 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:34:15.568510 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:34:15.570106 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:34:15.584149 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:34:15.605396 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:34:15.608321 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:34:15.618140 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:34:15.649864 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:34:15.694813 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:34:15.697541 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:34:15.725146 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:34:15.735320 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:34:15.743080 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:34:15.752758 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:34:15.756957 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:34:15.759330 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:34:15.762155 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:34:15.772871 (MainThread): Partial parsing not enabled
2021-06-16 07:34:15.811323 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:15.826734 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:15.832435 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:15.838623 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:34:15.995833 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.northwind_cls
- models.dbtintro.northwind_core
- models.dbtintro.example

2021-06-16 07:34:15.996800 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dd3e59b-1a2b-4d56-86d8-f858be964c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062d86aa50>]}
2021-06-16 07:34:16.002642 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dd3e59b-1a2b-4d56-86d8-f858be964c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062d67be90>]}
2021-06-16 07:34:16.003032 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:34:16.004417 (MainThread): 
2021-06-16 07:34:16.004918 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:34:16.006024 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:34:16.021375 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:34:16.021553 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:34:16.021667 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:34:16.021764 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:34:16.041271 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.02 seconds
2021-06-16 07:34:16.044663 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:34:16.047037 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:34:16.056859 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:34:16.057028 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:34:16.057146 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:34:16.057239 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:34:16.068888 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:34:16.069077 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:34:16.069195 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:34:16.071908 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:34:16.072678 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:34:16.073619 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:34:16.080109 (MainThread): Using redshift connection "master".
2021-06-16 07:34:16.080248 (MainThread): On master: BEGIN
2021-06-16 07:34:16.080358 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:34:16.080451 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:34:16.092365 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:34:16.092563 (MainThread): Using redshift connection "master".
2021-06-16 07:34:16.092672 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:34:16.191055 (MainThread): SQL status: SELECT 3 in 0.10 seconds
2021-06-16 07:34:16.192020 (MainThread): On master: ROLLBACK
2021-06-16 07:34:16.193006 (MainThread): Using redshift connection "master".
2021-06-16 07:34:16.193128 (MainThread): On master: BEGIN
2021-06-16 07:34:16.195011 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.195148 (MainThread): On master: COMMIT
2021-06-16 07:34:16.195253 (MainThread): Using redshift connection "master".
2021-06-16 07:34:16.195356 (MainThread): On master: COMMIT
2021-06-16 07:34:16.196278 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.196414 (MainThread): On master: Close
2021-06-16 07:34:16.196974 (MainThread): 07:34:16 | Concurrency: 1 threads (target='dev')
2021-06-16 07:34:16.197256 (MainThread): 07:34:16 | 
2021-06-16 07:34:16.200206 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:34:16.200551 (Thread-1): 07:34:16 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:34:16.200912 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.201078 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:34:16.204395 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:34:16.204771 (Thread-1): finished collecting timing info
2021-06-16 07:34:16.224915 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.225116 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:34:16.225235 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:34:16.225332 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:34:16.236931 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:34:16.243258 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.243397 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:34:16.244499 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:34:16.245802 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.245929 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.246034 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.247061 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.247218 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.247318 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:34:16.248208 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.248372 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.248473 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.248564 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.249440 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.249563 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.249656 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:34:16.250538 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.252325 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.252452 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:34:16.253452 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:34:16.254408 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.254533 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.254638 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.255590 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.255732 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.255840 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:34:16.256749 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.282366 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:34:16.282852 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.283013 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:34:16.284886 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:34:16.295056 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.295226 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:34:16.296393 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:34:16.299220 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.299354 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:34:16.300394 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:34:16.311488 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.311627 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.311732 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.313657 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.316133 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.316264 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:34:16.317209 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.319136 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.319264 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:34:16.320716 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:34:16.321635 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.321758 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.321860 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:34:16.324850 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.324991 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:34:16.325093 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:34:16.326028 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.326609 (Thread-1): finished collecting timing info
2021-06-16 07:34:16.326789 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:34:16.327726 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:34:16.328289 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd3e59b-1a2b-4d56-86d8-f858be964c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062d3d3790>]}
2021-06-16 07:34:16.328736 (Thread-1): 07:34:16 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.13s]
2021-06-16 07:34:16.329019 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:34:16.329208 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:34:16.329651 (Thread-1): 07:34:16 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:34:16.330049 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.330201 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:34:16.333663 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:34:16.334009 (Thread-1): finished collecting timing info
2021-06-16 07:34:16.353088 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.353281 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:34:16.353400 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:34:16.353494 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:34:16.365380 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:34:16.367391 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.367528 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:34:16.368581 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:34:16.369625 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.369753 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.369858 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.370778 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.370933 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.371039 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:34:16.371934 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.372099 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.372200 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.372290 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.373178 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.373305 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.373416 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:34:16.374316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.376280 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.376409 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:34:16.377406 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:34:16.378351 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.378473 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.378574 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.379533 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.379670 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.379768 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:34:16.380696 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.387561 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:34:16.387963 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.388095 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select * from "postgres"."northwind"."customers"
  ) ;

2021-06-16 07:34:16.390205 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:34:16.393117 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.393252 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:34:16.394364 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:34:16.395763 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.395900 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.396006 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.397882 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.398169 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.398281 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:34:16.399166 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.402267 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.402427 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:34:16.403503 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:34:16.404456 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.404584 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.404689 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:34:16.405657 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.405831 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:34:16.405946 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:34:16.406834 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.407419 (Thread-1): finished collecting timing info
2021-06-16 07:34:16.407603 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:34:16.408484 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:34:16.409040 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd3e59b-1a2b-4d56-86d8-f858be964c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06329293d0>]}
2021-06-16 07:34:16.409488 (Thread-1): 07:34:16 | 2 of 3 OK created view model sifa.cls_customers...................... [CREATE VIEW in 0.08s]
2021-06-16 07:34:16.409766 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:34:16.409950 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:34:16.410302 (Thread-1): 07:34:16 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:34:16.410706 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.410852 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:34:16.413804 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:34:16.414154 (Thread-1): finished collecting timing info
2021-06-16 07:34:16.416279 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.416415 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:34:16.416536 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:34:16.416631 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:34:16.428241 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:34:16.430489 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.430628 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:34:16.431673 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:34:16.432713 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.432848 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.432952 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.433874 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.434016 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.434126 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:34:16.435060 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.435255 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.435359 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.435474 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.436370 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.436502 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.436609 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:34:16.437526 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.439422 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.439560 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:34:16.440542 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:34:16.441529 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.441656 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.441761 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.442646 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.442784 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.442905 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:34:16.443777 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.444460 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:34:16.444857 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.444978 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:34:16.447388 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:34:16.450199 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.450324 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:34:16.451395 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:34:16.452714 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.452847 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.452950 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.454819 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.455123 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.455238 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:34:16.456177 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.458135 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.458261 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:34:16.459289 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:34:16.460244 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.460371 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.460474 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:34:16.461429 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.461568 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:34:16.461668 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:34:16.462639 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:34:16.463208 (Thread-1): finished collecting timing info
2021-06-16 07:34:16.463397 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:34:16.464332 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:34:16.464929 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd3e59b-1a2b-4d56-86d8-f858be964c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06329293d0>]}
2021-06-16 07:34:16.465383 (Thread-1): 07:34:16 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:34:16.465688 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:34:16.503279 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:34:16.503563 (MainThread): Using redshift connection "master".
2021-06-16 07:34:16.503677 (MainThread): On master: BEGIN
2021-06-16 07:34:16.503787 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:34:16.503883 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:34:16.515473 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:34:16.515665 (MainThread): On master: COMMIT
2021-06-16 07:34:16.515780 (MainThread): Using redshift connection "master".
2021-06-16 07:34:16.515884 (MainThread): On master: COMMIT
2021-06-16 07:34:16.516801 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:34:16.516962 (MainThread): On master: Close
2021-06-16 07:34:16.517520 (MainThread): 07:34:16 | 
2021-06-16 07:34:16.517800 (MainThread): 07:34:16 | Finished running 1 table model, 2 view models in 0.51s.
2021-06-16 07:34:16.518095 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:34:16.518210 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:34:16.518304 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:34:16.523469 (MainThread): 
2021-06-16 07:34:16.523736 (MainThread): Completed successfully
2021-06-16 07:34:16.523984 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:34:16.524374 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062d7ba810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062c382a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062c36a110>]}
2021-06-16 07:34:16.524629 (MainThread): Flushing usage events
2021-06-16 07:42:54.082996 (MainThread): Running with dbt=0.19.1
2021-06-16 07:42:54.326229 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:42:54.326702 (MainThread): Tracking: tracking
2021-06-16 07:42:54.332602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41302bfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4132ef5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4130257550>]}
2021-06-16 07:42:54.352998 (MainThread): Partial parsing not enabled
2021-06-16 07:42:54.354240 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:42:54.398414 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:42:54.417362 (MainThread): Parsing macros/relations.sql
2021-06-16 07:42:54.418354 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:42:54.419691 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:42:54.449715 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:42:54.453270 (MainThread): Parsing macros/relations.sql
2021-06-16 07:42:54.455288 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:42:54.458963 (MainThread): Parsing macros/core.sql
2021-06-16 07:42:54.464994 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:42:54.530559 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:42:54.544226 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:42:54.545700 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:42:54.548329 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:42:54.551299 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:42:54.553730 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:42:54.555409 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:42:54.569494 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:42:54.590529 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:42:54.593382 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:42:54.603058 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:42:54.634365 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:42:54.678696 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:42:54.681451 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:42:54.708552 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:42:54.718416 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:42:54.725987 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:42:54.735303 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:42:54.739399 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:42:54.741710 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:42:54.744651 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:42:54.755201 (MainThread): Partial parsing not enabled
2021-06-16 07:42:54.793082 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:54.807907 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:54.813202 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:54.819025 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:42:54.975442 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.northwind_cls
- models.dbtintro.example
- models.dbtintro.northwind_core

2021-06-16 07:42:54.976295 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3463ea3-ebf5-4a45-9a1e-5cf264f30a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412fe18c10>]}
2021-06-16 07:42:54.981967 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3463ea3-ebf5-4a45-9a1e-5cf264f30a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f413024bf50>]}
2021-06-16 07:42:54.982263 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:42:54.983608 (MainThread): 
2021-06-16 07:42:54.984104 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:42:54.985193 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:42:55.000455 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:42:55.000610 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:42:55.000720 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:42:55.000812 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:42:55.035476 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.03 seconds
2021-06-16 07:42:55.038844 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:42:55.041084 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:42:55.051013 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:42:55.051150 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:42:55.051261 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:42:55.051362 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:42:55.063491 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:42:55.063715 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:42:55.063840 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:42:55.066575 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 07:42:55.067429 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:42:55.068457 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:42:55.075210 (MainThread): Using redshift connection "master".
2021-06-16 07:42:55.075370 (MainThread): On master: BEGIN
2021-06-16 07:42:55.075496 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:42:55.075593 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:42:55.087819 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:42:55.088036 (MainThread): Using redshift connection "master".
2021-06-16 07:42:55.088153 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:42:55.193586 (MainThread): SQL status: SELECT 4 in 0.11 seconds
2021-06-16 07:42:55.194617 (MainThread): On master: ROLLBACK
2021-06-16 07:42:55.195615 (MainThread): Using redshift connection "master".
2021-06-16 07:42:55.195749 (MainThread): On master: BEGIN
2021-06-16 07:42:55.197535 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.197678 (MainThread): On master: COMMIT
2021-06-16 07:42:55.197789 (MainThread): Using redshift connection "master".
2021-06-16 07:42:55.197888 (MainThread): On master: COMMIT
2021-06-16 07:42:55.198968 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.199113 (MainThread): On master: Close
2021-06-16 07:42:55.199714 (MainThread): 07:42:55 | Concurrency: 1 threads (target='dev')
2021-06-16 07:42:55.200050 (MainThread): 07:42:55 | 
2021-06-16 07:42:55.203075 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:42:55.203408 (Thread-1): 07:42:55 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:42:55.203758 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.203922 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:42:55.207181 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:42:55.207549 (Thread-1): finished collecting timing info
2021-06-16 07:42:55.227801 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.227999 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:42:55.228117 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:42:55.228215 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:42:55.244287 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:42:55.250983 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.251155 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:42:55.252339 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:42:55.253637 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.253766 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.253871 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.254785 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.254953 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.255066 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:42:55.256384 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.256556 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.256683 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.256779 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.257722 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.257858 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.257958 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:42:55.258897 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.260790 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.260915 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:42:55.261963 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:42:55.262927 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.263068 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.263174 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.264096 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.264230 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.264339 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:42:55.265357 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.293180 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:42:55.293668 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.293789 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:42:55.295770 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:42:55.303933 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.304107 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:42:55.305293 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:42:55.307864 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.308007 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:42:55.309031 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:42:55.319929 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.320071 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.320181 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.322138 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.324589 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.324723 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:42:55.325660 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.327627 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.327768 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:42:55.329264 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:42:55.330184 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.330310 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.330423 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:42:55.333379 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.333522 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:42:55.333624 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:42:55.334527 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.335100 (Thread-1): finished collecting timing info
2021-06-16 07:42:55.335283 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:42:55.336190 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:42:55.336751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3463ea3-ebf5-4a45-9a1e-5cf264f30a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412fdfbad0>]}
2021-06-16 07:42:55.337229 (Thread-1): 07:42:55 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.13s]
2021-06-16 07:42:55.337535 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:42:55.337736 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:42:55.338240 (Thread-1): 07:42:55 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:42:55.338658 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.338807 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:42:55.342298 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:42:55.342649 (Thread-1): finished collecting timing info
2021-06-16 07:42:55.361773 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.361929 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:42:55.362042 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:42:55.362136 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:42:55.374432 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:42:55.376388 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.376522 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:42:55.377566 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:42:55.378604 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.378732 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.378837 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.379872 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.380012 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.380116 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:42:55.381085 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.381291 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.381406 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.381517 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.382400 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.382531 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.382631 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:42:55.383528 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.385360 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.385482 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:42:55.386527 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:42:55.387433 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.387561 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.387690 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.388611 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.388758 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.388855 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:42:55.389758 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.396463 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:42:55.396867 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.396996 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select * from "postgres"."northwind"."customers"
  ) ;

2021-06-16 07:42:55.398960 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:42:55.401650 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.401776 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:42:55.402960 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:42:55.406749 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.406942 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:42:55.408101 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:42:55.409376 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.409500 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.409601 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.411431 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.411696 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.411805 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:42:55.412801 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.414480 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.414604 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:42:55.415954 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:42:55.416892 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.417029 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.417135 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:42:55.418635 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.418775 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:42:55.418877 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:42:55.419845 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.420372 (Thread-1): finished collecting timing info
2021-06-16 07:42:55.420538 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:42:55.421446 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:42:55.421989 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3463ea3-ebf5-4a45-9a1e-5cf264f30a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412e3a1d50>]}
2021-06-16 07:42:55.422404 (Thread-1): 07:42:55 | 2 of 3 OK created view model sifa.cls_customers...................... [CREATE VIEW in 0.08s]
2021-06-16 07:42:55.422738 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:42:55.422955 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:42:55.423312 (Thread-1): 07:42:55 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:42:55.423743 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.423894 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:42:55.427043 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:42:55.427393 (Thread-1): finished collecting timing info
2021-06-16 07:42:55.429412 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.429543 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:42:55.429654 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:42:55.429748 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:42:55.443586 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:42:55.445367 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.445505 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:42:55.446582 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:42:55.447629 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.447768 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.447878 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.448882 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.449028 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.449144 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:42:55.450074 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.450238 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.450349 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.450446 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.451346 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.451477 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.451576 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:42:55.452505 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.454256 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.454387 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:42:55.455457 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:42:55.456412 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.456548 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.456657 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.457576 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.457715 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.457828 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:42:55.458731 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.459386 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:42:55.459762 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.459887 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:42:55.461746 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:42:55.464265 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.464393 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:42:55.465474 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:42:55.466749 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.466875 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.467019 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.468687 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.468970 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.469082 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:42:55.469990 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.471737 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.471864 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:42:55.472862 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:42:55.473731 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.473857 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.473961 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:42:55.474850 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.475008 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:42:55.475110 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:42:55.476014 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:42:55.476554 (Thread-1): finished collecting timing info
2021-06-16 07:42:55.476722 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:42:55.477619 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:42:55.478164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3463ea3-ebf5-4a45-9a1e-5cf264f30a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f413531c5d0>]}
2021-06-16 07:42:55.478632 (Thread-1): 07:42:55 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:42:55.478945 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:42:55.507751 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:42:55.507988 (MainThread): Using redshift connection "master".
2021-06-16 07:42:55.508121 (MainThread): On master: BEGIN
2021-06-16 07:42:55.508241 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:42:55.508334 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:42:55.520358 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:42:55.520524 (MainThread): On master: COMMIT
2021-06-16 07:42:55.520637 (MainThread): Using redshift connection "master".
2021-06-16 07:42:55.520737 (MainThread): On master: COMMIT
2021-06-16 07:42:55.521626 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:42:55.521765 (MainThread): On master: Close
2021-06-16 07:42:55.522260 (MainThread): 07:42:55 | 
2021-06-16 07:42:55.522524 (MainThread): 07:42:55 | Finished running 1 table model, 2 view models in 0.54s.
2021-06-16 07:42:55.522804 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:42:55.522937 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:42:55.523034 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:42:55.528264 (MainThread): 
2021-06-16 07:42:55.528516 (MainThread): Completed successfully
2021-06-16 07:42:55.528732 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:42:55.529116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f413010a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412fed1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412fdeaa50>]}
2021-06-16 07:42:55.529361 (MainThread): Flushing usage events
2021-06-16 07:45:20.650930 (MainThread): Running with dbt=0.19.1
2021-06-16 07:45:20.894480 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:45:20.895008 (MainThread): Tracking: tracking
2021-06-16 07:45:20.900740 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eed93c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eed26410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eed97290>]}
2021-06-16 07:45:20.921082 (MainThread): Partial parsing not enabled
2021-06-16 07:45:20.922293 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:45:20.962211 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:45:20.981518 (MainThread): Parsing macros/relations.sql
2021-06-16 07:45:20.982491 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:45:20.983866 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:45:21.014348 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:45:21.017915 (MainThread): Parsing macros/relations.sql
2021-06-16 07:45:21.019942 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:45:21.023521 (MainThread): Parsing macros/core.sql
2021-06-16 07:45:21.029662 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:45:21.096570 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:45:21.110443 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:45:21.111954 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:45:21.114549 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:45:21.117647 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:45:21.120169 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:45:21.121806 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:45:21.135943 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:45:21.157269 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:45:21.160170 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:45:21.170103 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:45:21.201903 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:45:21.246982 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:45:21.249696 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:45:21.277313 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:45:21.287617 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:45:21.295317 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:45:21.304923 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:45:21.309131 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:45:21.311690 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:45:21.314658 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:45:21.325664 (MainThread): Partial parsing not enabled
2021-06-16 07:45:21.364478 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.379665 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.385038 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.391084 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:45:21.549391 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.northwind_cls
- models.dbtintro.northwind_core
- models.dbtintro.example

2021-06-16 07:45:21.550305 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b572293-615a-4fc2-8dbb-4caac406d135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eeb96610>]}
2021-06-16 07:45:21.556305 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b572293-615a-4fc2-8dbb-4caac406d135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eebdca10>]}
2021-06-16 07:45:21.556660 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:45:21.557990 (MainThread): 
2021-06-16 07:45:21.558493 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:45:21.559661 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:45:21.575191 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:45:21.575350 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:45:21.575479 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:45:21.575580 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:21.593129 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.02 seconds
2021-06-16 07:45:21.596414 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:45:21.598646 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:45:21.608490 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:45:21.608621 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:45:21.608740 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:45:21.608834 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:21.620255 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:21.620548 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:45:21.620657 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:45:21.623229 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 07:45:21.623952 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:45:21.624910 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:45:21.631143 (MainThread): Using redshift connection "master".
2021-06-16 07:45:21.631276 (MainThread): On master: BEGIN
2021-06-16 07:45:21.631387 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:45:21.631481 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:21.642665 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:21.642842 (MainThread): Using redshift connection "master".
2021-06-16 07:45:21.642997 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:45:21.748707 (MainThread): SQL status: SELECT 4 in 0.11 seconds
2021-06-16 07:45:21.749756 (MainThread): On master: ROLLBACK
2021-06-16 07:45:21.750703 (MainThread): Using redshift connection "master".
2021-06-16 07:45:21.750827 (MainThread): On master: BEGIN
2021-06-16 07:45:21.752559 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.752691 (MainThread): On master: COMMIT
2021-06-16 07:45:21.752800 (MainThread): Using redshift connection "master".
2021-06-16 07:45:21.752898 (MainThread): On master: COMMIT
2021-06-16 07:45:21.753825 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.754012 (MainThread): On master: Close
2021-06-16 07:45:21.754621 (MainThread): 07:45:21 | Concurrency: 1 threads (target='dev')
2021-06-16 07:45:21.754985 (MainThread): 07:45:21 | 
2021-06-16 07:45:21.757929 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:45:21.758256 (Thread-1): 07:45:21 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:45:21.758617 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.758780 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:45:21.762134 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:45:21.762511 (Thread-1): finished collecting timing info
2021-06-16 07:45:21.782648 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.782801 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:21.782947 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:45:21.783054 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:21.794467 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:21.800784 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.800917 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:45:21.801984 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:45:21.803255 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.803399 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.803509 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.804431 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.804572 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.804675 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:21.805592 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.805808 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.805931 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.806040 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.806968 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.807123 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.807230 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:21.808114 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.809829 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.809955 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:45:21.810944 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:45:21.811874 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.812001 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.812104 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.812991 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.813132 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.813233 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:21.814117 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.839932 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:45:21.840391 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.840518 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:45:21.842342 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:45:21.850413 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.850546 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:45:21.851698 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:45:21.854229 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.854365 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:45:21.855429 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:45:21.866748 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.866911 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.867044 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.868579 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.870967 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.871094 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:21.872013 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.873821 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.873947 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:45:21.875465 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:45:21.876389 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.876525 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.876629 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:21.879425 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.879560 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:21.879660 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:21.880566 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.881104 (Thread-1): finished collecting timing info
2021-06-16 07:45:21.881269 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:45:21.882209 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:45:21.882776 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b572293-615a-4fc2-8dbb-4caac406d135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ee8c9b10>]}
2021-06-16 07:45:21.883268 (Thread-1): 07:45:21 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.12s]
2021-06-16 07:45:21.883571 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:45:21.883773 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:45:21.884225 (Thread-1): 07:45:21 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:45:21.884639 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.884790 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:45:21.888339 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:45:21.888688 (Thread-1): finished collecting timing info
2021-06-16 07:45:21.908445 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.908613 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:21.908727 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:45:21.908822 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:21.920133 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:21.921953 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.922074 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:45:21.923071 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:21.924083 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:21.924213 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.924319 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:21.925270 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.925414 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.925521 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:21.926417 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.926583 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:21.926688 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.926793 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:21.927675 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.927816 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.927917 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:21.928805 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.930486 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.930608 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:45:21.931599 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:21.932493 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:21.932620 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.932726 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:21.933619 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.933754 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.933856 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:21.934729 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.941497 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:45:21.941893 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:21.942017 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(m.CustomerID as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:45:21.943182 (Thread-1): Postgres error: column m.customerid does not exist
LINE 11:     , CAST(m.CustomerID as varchar(12))                   as...
                    ^
HINT:  Perhaps you meant to reference the column "m.CustomerID".

2021-06-16 07:45:21.943321 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:45:21.944311 (Thread-1): finished collecting timing info
2021-06-16 07:45:21.944483 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:45:21.944974 (Thread-1): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  column m.customerid does not exist
  LINE 11:     , CAST(m.CustomerID as varchar(12))                   as...
                      ^
  HINT:  Perhaps you meant to reference the column "m.CustomerID".
  compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column m.customerid does not exist
LINE 11:     , CAST(m.CustomerID as varchar(12))                   as...
                    ^
HINT:  Perhaps you meant to reference the column "m.CustomerID".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  column m.customerid does not exist
  LINE 11:     , CAST(m.CustomerID as varchar(12))                   as...
                      ^
  HINT:  Perhaps you meant to reference the column "m.CustomerID".
  compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
2021-06-16 07:45:21.955020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b572293-615a-4fc2-8dbb-4caac406d135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eea41890>]}
2021-06-16 07:45:21.955453 (Thread-1): 07:45:21 | 2 of 3 ERROR creating view model sifa.cls_customers.................. [ERROR in 0.07s]
2021-06-16 07:45:21.955757 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:45:21.955956 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:45:21.956373 (Thread-1): 07:45:21 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:45:21.956823 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.956973 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:45:21.960132 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:45:21.960438 (Thread-1): finished collecting timing info
2021-06-16 07:45:21.963874 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.964052 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:21.964170 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:45:21.964267 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:21.975489 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:21.977172 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.977306 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:45:21.978329 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:21.979350 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:21.979480 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.979584 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:21.980486 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.980619 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.980718 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:21.981589 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.981748 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:21.981848 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.981941 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:21.982824 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.982972 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.983069 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:21.983954 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.985698 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.985823 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:45:21.986810 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:21.987740 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:21.987873 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.987980 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:21.988900 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:21.989037 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.989138 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:21.990063 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:21.990685 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:45:21.991068 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.991190 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:45:21.993043 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:45:21.995668 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.995807 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:45:21.996872 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:45:21.998148 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:21.998283 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:21.998396 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:22.000156 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:22.000412 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:22.000520 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:22.001476 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:22.003125 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:22.003251 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:45:22.004286 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:22.005395 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:22.005525 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:22.005633 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:22.006527 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:22.006665 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:22.006766 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:22.007668 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:22.008202 (Thread-1): finished collecting timing info
2021-06-16 07:45:22.008369 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:45:22.009238 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:45:22.009776 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b572293-615a-4fc2-8dbb-4caac406d135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec3919d0>]}
2021-06-16 07:45:22.010219 (Thread-1): 07:45:22 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:45:22.010505 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:45:22.064867 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:45:22.065125 (MainThread): Using redshift connection "master".
2021-06-16 07:45:22.065239 (MainThread): On master: BEGIN
2021-06-16 07:45:22.065349 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:45:22.065444 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:22.077558 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:22.077736 (MainThread): On master: COMMIT
2021-06-16 07:45:22.077855 (MainThread): Using redshift connection "master".
2021-06-16 07:45:22.077964 (MainThread): On master: COMMIT
2021-06-16 07:45:22.078939 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:22.079091 (MainThread): On master: Close
2021-06-16 07:45:22.079598 (MainThread): 07:45:22 | 
2021-06-16 07:45:22.079893 (MainThread): 07:45:22 | Finished running 1 table model, 2 view models in 0.52s.
2021-06-16 07:45:22.080165 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:45:22.080273 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:45:22.080365 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:45:22.085427 (MainThread): 
2021-06-16 07:45:22.085673 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 07:45:22.085943 (MainThread): 
2021-06-16 07:45:22.086252 (MainThread): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 07:45:22.086495 (MainThread):   column m.customerid does not exist
2021-06-16 07:45:22.086704 (MainThread):   LINE 11:     , CAST(m.CustomerID as varchar(12))                   as...
2021-06-16 07:45:22.086923 (MainThread):                       ^
2021-06-16 07:45:22.087103 (MainThread):   HINT:  Perhaps you meant to reference the column "m.CustomerID".
2021-06-16 07:45:22.087325 (MainThread):   compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
2021-06-16 07:45:22.087590 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-06-16 07:45:22.087882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec3919d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ec38b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3eeb6cc10>]}
2021-06-16 07:45:22.088128 (MainThread): Flushing usage events
2021-06-16 07:45:50.813502 (MainThread): Running with dbt=0.19.1
2021-06-16 07:45:51.050134 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:45:51.050606 (MainThread): Tracking: tracking
2021-06-16 07:45:51.056287 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641e3a6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f642100c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6420fba390>]}
2021-06-16 07:45:51.076385 (MainThread): Partial parsing not enabled
2021-06-16 07:45:51.077553 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:45:51.117572 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:45:51.136328 (MainThread): Parsing macros/relations.sql
2021-06-16 07:45:51.137259 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:45:51.138606 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:45:51.169145 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:45:51.172698 (MainThread): Parsing macros/relations.sql
2021-06-16 07:45:51.174726 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:45:51.178368 (MainThread): Parsing macros/core.sql
2021-06-16 07:45:51.184550 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:45:51.249171 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:45:51.262759 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:45:51.264232 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:45:51.266822 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:45:51.269818 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:45:51.272273 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:45:51.273916 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:45:51.287901 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:45:51.309620 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:45:51.312510 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:45:51.322324 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:45:51.353839 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:45:51.398843 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:45:51.401561 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:45:51.429242 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:45:51.439468 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:45:51.447292 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:45:51.456981 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:45:51.461203 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:45:51.463569 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:45:51.466537 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:45:51.477233 (MainThread): Partial parsing not enabled
2021-06-16 07:45:51.515854 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.531030 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:51.536481 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:51.542469 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:45:51.700964 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.northwind_core
- models.dbtintro.example
- models.dbtintro.northwind_cls

2021-06-16 07:45:51.701806 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5acbb7d2-ac64-483f-869a-c0563aa62ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641e17fc50>]}
2021-06-16 07:45:51.707529 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5acbb7d2-ac64-483f-869a-c0563aa62ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641e318390>]}
2021-06-16 07:45:51.707808 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:45:51.709060 (MainThread): 
2021-06-16 07:45:51.709536 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:45:51.710612 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:45:51.725903 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:45:51.726073 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:45:51.726189 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:45:51.726291 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:51.742979 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.02 seconds
2021-06-16 07:45:51.746242 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:45:51.748455 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:45:51.758298 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:45:51.758465 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:45:51.758578 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:45:51.758672 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:51.770167 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:51.770373 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:45:51.770489 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:45:51.773144 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 07:45:51.773952 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:45:51.774858 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:45:51.781421 (MainThread): Using redshift connection "master".
2021-06-16 07:45:51.781560 (MainThread): On master: BEGIN
2021-06-16 07:45:51.781673 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:45:51.781772 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:51.793452 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:51.793594 (MainThread): Using redshift connection "master".
2021-06-16 07:45:51.793701 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:45:51.899445 (MainThread): SQL status: SELECT 4 in 0.11 seconds
2021-06-16 07:45:51.900454 (MainThread): On master: ROLLBACK
2021-06-16 07:45:51.901433 (MainThread): Using redshift connection "master".
2021-06-16 07:45:51.901554 (MainThread): On master: BEGIN
2021-06-16 07:45:51.903285 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:51.903452 (MainThread): On master: COMMIT
2021-06-16 07:45:51.903570 (MainThread): Using redshift connection "master".
2021-06-16 07:45:51.903672 (MainThread): On master: COMMIT
2021-06-16 07:45:51.904581 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:51.904732 (MainThread): On master: Close
2021-06-16 07:45:51.905317 (MainThread): 07:45:51 | Concurrency: 1 threads (target='dev')
2021-06-16 07:45:51.905656 (MainThread): 07:45:51 | 
2021-06-16 07:45:51.908628 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:45:51.908956 (Thread-1): 07:45:51 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:45:51.909291 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.909466 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:45:51.912726 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:45:51.913076 (Thread-1): finished collecting timing info
2021-06-16 07:45:51.932914 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.933071 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:51.933185 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:45:51.933278 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:51.945212 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:51.951370 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.951499 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:45:51.952600 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:45:51.953843 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:51.953967 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.954069 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:51.955017 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:51.955184 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.955298 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:51.956299 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:51.956490 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:51.956598 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.956707 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:51.957711 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:51.957850 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.957946 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:51.959214 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:51.960994 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.961118 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:45:51.962099 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:45:51.963049 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:51.963178 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.963283 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:51.964309 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:51.964444 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.964542 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:51.965451 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:51.991144 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:45:51.991584 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:51.991712 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:45:51.993456 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:45:52.001570 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:52.001713 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:45:52.002974 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:45:52.005645 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:52.005779 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:45:52.006828 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:45:52.018000 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:52.018147 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:52.018253 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:52.019970 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.022320 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:52.022457 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:52.023414 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.025287 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:52.025425 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:45:52.027013 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:45:52.028025 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:52.028166 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:52.028276 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:45:52.031373 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.031514 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:45:52.031614 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:45:52.032534 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.033089 (Thread-1): finished collecting timing info
2021-06-16 07:45:52.033258 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:45:52.034162 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:45:52.034743 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5acbb7d2-ac64-483f-869a-c0563aa62ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641c451050>]}
2021-06-16 07:45:52.035241 (Thread-1): 07:45:52 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.13s]
2021-06-16 07:45:52.035544 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:45:52.035742 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:45:52.036206 (Thread-1): 07:45:52 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:45:52.036629 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.036786 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:45:52.040444 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:45:52.040790 (Thread-1): finished collecting timing info
2021-06-16 07:45:52.060509 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.060697 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:52.060815 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:45:52.060912 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:52.072404 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:52.074274 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.074403 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:45:52.075496 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:52.076539 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:52.076664 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.076769 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:52.077676 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.077815 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.077918 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:52.078803 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.078988 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:52.079097 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.079191 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:52.080099 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.080226 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.080321 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:52.081292 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.083222 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.083350 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:45:52.084358 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:52.085256 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:52.085403 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.085513 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:45:52.086371 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.086510 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.086613 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:45:52.087490 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.094346 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:45:52.094753 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:45:52.094876 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST("m.CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:45:52.096152 (Thread-1): Postgres error: column "m.CustomerID" does not exist
LINE 11:     , CAST("m.CustomerID" as varchar(12))                   ...
                    ^
HINT:  Perhaps you meant to reference the column "m.CustomerID".

2021-06-16 07:45:52.096282 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:45:52.097226 (Thread-1): finished collecting timing info
2021-06-16 07:45:52.097406 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:45:52.097908 (Thread-1): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  column "m.CustomerID" does not exist
  LINE 11:     , CAST("m.CustomerID" as varchar(12))                   ...
                      ^
  HINT:  Perhaps you meant to reference the column "m.CustomerID".
  compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "m.CustomerID" does not exist
LINE 11:     , CAST("m.CustomerID" as varchar(12))                   ...
                    ^
HINT:  Perhaps you meant to reference the column "m.CustomerID".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  column "m.CustomerID" does not exist
  LINE 11:     , CAST("m.CustomerID" as varchar(12))                   ...
                      ^
  HINT:  Perhaps you meant to reference the column "m.CustomerID".
  compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
2021-06-16 07:45:52.099925 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5acbb7d2-ac64-483f-869a-c0563aa62ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641dec3690>]}
2021-06-16 07:45:52.100330 (Thread-1): 07:45:52 | 2 of 3 ERROR creating view model sifa.cls_customers.................. [ERROR in 0.06s]
2021-06-16 07:45:52.100617 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:45:52.100811 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:45:52.101230 (Thread-1): 07:45:52 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:45:52.101641 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.101785 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:45:52.104934 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:45:52.105278 (Thread-1): finished collecting timing info
2021-06-16 07:45:52.108808 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.108947 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:52.109059 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:45:52.109159 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:52.120677 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:52.122552 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.122682 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:45:52.123757 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:52.124826 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.124967 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.125084 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.125997 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.126139 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.126251 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:52.127163 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.127385 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.127508 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.127615 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.128516 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.128647 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.128746 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:52.129643 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.131415 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.131540 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:45:52.132549 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:52.133463 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.133590 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.133695 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.134581 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.134724 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.134826 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:52.135741 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.136408 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:45:52.136798 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.136920 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:45:52.138680 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:45:52.141292 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.141438 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:45:52.142517 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:45:52.143843 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.143975 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.144089 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.145761 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.146022 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.146133 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:52.147026 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.148694 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.148814 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:45:52.149793 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:45:52.150839 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.150989 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.151094 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:45:52.151995 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.152134 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:45:52.152232 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:45:52.153122 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:45:52.153670 (Thread-1): finished collecting timing info
2021-06-16 07:45:52.153844 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:45:52.154764 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:45:52.155348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5acbb7d2-ac64-483f-869a-c0563aa62ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641c3a5b90>]}
2021-06-16 07:45:52.155827 (Thread-1): 07:45:52 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:45:52.156123 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:45:52.214645 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:45:52.214937 (MainThread): Using redshift connection "master".
2021-06-16 07:45:52.215057 (MainThread): On master: BEGIN
2021-06-16 07:45:52.215171 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:45:52.215268 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:45:52.226844 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:45:52.227046 (MainThread): On master: COMMIT
2021-06-16 07:45:52.227163 (MainThread): Using redshift connection "master".
2021-06-16 07:45:52.227268 (MainThread): On master: COMMIT
2021-06-16 07:45:52.228162 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:45:52.228304 (MainThread): On master: Close
2021-06-16 07:45:52.228790 (MainThread): 07:45:52 | 
2021-06-16 07:45:52.229069 (MainThread): 07:45:52 | Finished running 1 table model, 2 view models in 0.52s.
2021-06-16 07:45:52.229350 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:45:52.229457 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:45:52.229548 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:45:52.234572 (MainThread): 
2021-06-16 07:45:52.234843 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 07:45:52.235153 (MainThread): 
2021-06-16 07:45:52.235409 (MainThread): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 07:45:52.235669 (MainThread):   column "m.CustomerID" does not exist
2021-06-16 07:45:52.235881 (MainThread):   LINE 11:     , CAST("m.CustomerID" as varchar(12))                   ...
2021-06-16 07:45:52.236099 (MainThread):                       ^
2021-06-16 07:45:52.236299 (MainThread):   HINT:  Perhaps you meant to reference the column "m.CustomerID".
2021-06-16 07:45:52.236494 (MainThread):   compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
2021-06-16 07:45:52.236692 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-06-16 07:45:52.236984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641c485d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641e33de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f641c47b210>]}
2021-06-16 07:45:52.237252 (MainThread): Flushing usage events
2021-06-16 07:46:17.975327 (MainThread): Running with dbt=0.19.1
2021-06-16 07:46:18.215860 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:46:18.216355 (MainThread): Tracking: tracking
2021-06-16 07:46:18.221978 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8dbf5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8db8c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8db8ce90>]}
2021-06-16 07:46:18.242246 (MainThread): Partial parsing not enabled
2021-06-16 07:46:18.243476 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:46:18.283673 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:46:18.302383 (MainThread): Parsing macros/relations.sql
2021-06-16 07:46:18.303412 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:46:18.304781 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:46:18.335503 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:46:18.339103 (MainThread): Parsing macros/relations.sql
2021-06-16 07:46:18.341212 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:46:18.345058 (MainThread): Parsing macros/core.sql
2021-06-16 07:46:18.351330 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:46:18.416921 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:46:18.430680 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:46:18.432189 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:46:18.434851 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:46:18.437947 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:46:18.440465 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:46:18.442089 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:46:18.456298 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:46:18.477713 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:46:18.480824 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:46:18.490781 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:46:18.522934 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:46:18.568685 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:46:18.571449 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:46:18.599548 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:46:18.609817 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:46:18.617676 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:46:18.627253 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:46:18.631445 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:46:18.633879 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:46:18.636906 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:46:18.647811 (MainThread): Partial parsing not enabled
2021-06-16 07:46:18.686772 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:18.701841 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:18.707338 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:18.713369 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:46:18.870623 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.northwind_cls
- models.dbtintro.example
- models.dbtintro.northwind_core

2021-06-16 07:46:18.871504 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdaa444b-1bca-47ae-a8d8-19397a8c223b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8d8ad190>]}
2021-06-16 07:46:18.877326 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdaa444b-1bca-47ae-a8d8-19397a8c223b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8d8ad190>]}
2021-06-16 07:46:18.877662 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:46:18.879002 (MainThread): 
2021-06-16 07:46:18.879455 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:46:18.880584 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:46:18.895842 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:46:18.896019 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:46:18.896136 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:46:18.896232 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:18.924002 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.03 seconds
2021-06-16 07:46:18.927363 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:46:18.929595 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:46:18.939532 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:46:18.939682 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:46:18.939796 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:46:18.939901 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:18.982640 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.04 seconds
2021-06-16 07:46:18.982877 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:46:18.983037 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:46:18.985889 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 07:46:18.986739 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:46:18.987724 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:46:18.994298 (MainThread): Using redshift connection "master".
2021-06-16 07:46:18.994451 (MainThread): On master: BEGIN
2021-06-16 07:46:18.994576 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:46:18.994677 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:19.007793 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:19.008035 (MainThread): Using redshift connection "master".
2021-06-16 07:46:19.008156 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:46:19.116254 (MainThread): SQL status: SELECT 4 in 0.11 seconds
2021-06-16 07:46:19.117298 (MainThread): On master: ROLLBACK
2021-06-16 07:46:19.118358 (MainThread): Using redshift connection "master".
2021-06-16 07:46:19.118479 (MainThread): On master: BEGIN
2021-06-16 07:46:19.120303 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.120444 (MainThread): On master: COMMIT
2021-06-16 07:46:19.120551 (MainThread): Using redshift connection "master".
2021-06-16 07:46:19.120648 (MainThread): On master: COMMIT
2021-06-16 07:46:19.121742 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.121879 (MainThread): On master: Close
2021-06-16 07:46:19.122428 (MainThread): 07:46:19 | Concurrency: 1 threads (target='dev')
2021-06-16 07:46:19.122709 (MainThread): 07:46:19 | 
2021-06-16 07:46:19.125772 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:46:19.126114 (Thread-1): 07:46:19 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:46:19.126457 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.126637 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:46:19.129955 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:46:19.130311 (Thread-1): finished collecting timing info
2021-06-16 07:46:19.150324 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.150506 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:19.150636 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:19.150734 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:19.174052 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:46:19.180716 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.180888 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:46:19.182079 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:19.183417 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.183556 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.183665 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.184614 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.184751 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.184852 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:19.185844 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.186013 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.186118 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.186216 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.187268 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.187404 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.187503 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:19.188434 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.190299 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.190427 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:46:19.191440 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:19.192380 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.192513 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.192617 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.193537 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.193670 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.193770 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:19.194729 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.220192 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:46:19.220667 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.220800 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:46:19.222622 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:46:19.230719 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.230863 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:46:19.235091 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:19.237904 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.238038 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:46:19.242095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:19.253130 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.253291 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.253399 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.255318 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.257784 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.257914 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:19.258882 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.260853 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.260978 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:46:19.262464 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:19.263425 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.263555 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.263660 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:19.266641 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.266786 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:19.266913 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:19.267915 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.268484 (Thread-1): finished collecting timing info
2021-06-16 07:46:19.268650 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:46:19.269574 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:46:19.270131 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdaa444b-1bca-47ae-a8d8-19397a8c223b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8d74c150>]}
2021-06-16 07:46:19.270585 (Thread-1): 07:46:19 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.14s]
2021-06-16 07:46:19.270905 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:46:19.271101 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:46:19.271547 (Thread-1): 07:46:19 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:46:19.271959 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.272106 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:46:19.275717 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:46:19.276071 (Thread-1): finished collecting timing info
2021-06-16 07:46:19.295070 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.295223 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:19.295340 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:19.295438 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:19.334861 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-06-16 07:46:19.336985 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.337125 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:46:19.338196 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:19.339207 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:19.339339 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.339444 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:19.340352 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.340486 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.340586 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:19.341495 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.341656 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:19.341756 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.341850 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:19.342801 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.342957 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.343062 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:19.343946 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.345679 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.345801 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:46:19.346898 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:19.347797 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:19.347921 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.348025 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:19.349003 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.349142 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.349243 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:19.350285 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.357090 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:46:19.357503 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:19.357622 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(CustomerID as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:46:19.358874 (Thread-1): Postgres error: column "customerid" does not exist
LINE 11:     , CAST(CustomerID as varchar(12))                   as c...
                    ^
HINT:  Perhaps you meant to reference the column "m.CustomerID".

2021-06-16 07:46:19.359035 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:46:19.360147 (Thread-1): finished collecting timing info
2021-06-16 07:46:19.360314 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:46:19.360801 (Thread-1): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  column "customerid" does not exist
  LINE 11:     , CAST(CustomerID as varchar(12))                   as c...
                      ^
  HINT:  Perhaps you meant to reference the column "m.CustomerID".
  compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "customerid" does not exist
LINE 11:     , CAST(CustomerID as varchar(12))                   as c...
                    ^
HINT:  Perhaps you meant to reference the column "m.CustomerID".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  column "customerid" does not exist
  LINE 11:     , CAST(CustomerID as varchar(12))                   as c...
                      ^
  HINT:  Perhaps you meant to reference the column "m.CustomerID".
  compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
2021-06-16 07:46:19.362869 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdaa444b-1bca-47ae-a8d8-19397a8c223b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8c673cd0>]}
2021-06-16 07:46:19.363333 (Thread-1): 07:46:19 | 2 of 3 ERROR creating view model sifa.cls_customers.................. [ERROR in 0.09s]
2021-06-16 07:46:19.363632 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:46:19.363831 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:46:19.364260 (Thread-1): 07:46:19 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:46:19.364678 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.364830 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:46:19.368048 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:46:19.368371 (Thread-1): finished collecting timing info
2021-06-16 07:46:19.371743 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.371890 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:19.372008 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:19.372105 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:19.385977 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:19.387944 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.388077 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:46:19.389088 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:19.390077 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.390217 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.390323 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.391413 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.391552 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.391652 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:19.393140 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.393304 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.393405 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.393499 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.395338 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.395468 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.395564 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:19.398598 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.400453 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.400581 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:46:19.405254 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:19.406201 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.406324 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.406433 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.408003 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.408184 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.408304 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:19.409231 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.409930 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:46:19.410315 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.410442 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:46:19.412295 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:46:19.415021 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.415157 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:46:19.427537 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-06-16 07:46:19.429018 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.429155 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.429262 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.431017 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.431298 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.431426 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:19.437183 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:19.439149 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.439283 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:46:19.441801 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:19.443027 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.443167 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.443278 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:19.444754 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.444900 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:19.445006 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:19.446641 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:19.447253 (Thread-1): finished collecting timing info
2021-06-16 07:46:19.447433 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:46:19.448436 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:46:19.448987 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdaa444b-1bca-47ae-a8d8-19397a8c223b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8c6738d0>]}
2021-06-16 07:46:19.449451 (Thread-1): 07:46:19 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.08s]
2021-06-16 07:46:19.449757 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:46:19.534047 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:46:19.534312 (MainThread): Using redshift connection "master".
2021-06-16 07:46:19.536652 (MainThread): On master: BEGIN
2021-06-16 07:46:19.536915 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:46:19.537020 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:19.577308 (MainThread): SQL status: BEGIN in 0.04 seconds
2021-06-16 07:46:19.577571 (MainThread): On master: COMMIT
2021-06-16 07:46:19.577694 (MainThread): Using redshift connection "master".
2021-06-16 07:46:19.577807 (MainThread): On master: COMMIT
2021-06-16 07:46:19.578703 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:19.578854 (MainThread): On master: Close
2021-06-16 07:46:19.579452 (MainThread): 07:46:19 | 
2021-06-16 07:46:19.579761 (MainThread): 07:46:19 | Finished running 1 table model, 2 view models in 0.70s.
2021-06-16 07:46:19.580010 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:46:19.580120 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:46:19.580212 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:46:19.585393 (MainThread): 
2021-06-16 07:46:19.585644 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 07:46:19.585872 (MainThread): 
2021-06-16 07:46:19.586155 (MainThread): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 07:46:19.586402 (MainThread):   column "customerid" does not exist
2021-06-16 07:46:19.586642 (MainThread):   LINE 11:     , CAST(CustomerID as varchar(12))                   as c...
2021-06-16 07:46:19.586869 (MainThread):                       ^
2021-06-16 07:46:19.587107 (MainThread):   HINT:  Perhaps you meant to reference the column "m.CustomerID".
2021-06-16 07:46:19.587316 (MainThread):   compiled SQL at target/run/my_new_project/models/northwind_cls/cls_customers.sql
2021-06-16 07:46:19.587542 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-06-16 07:46:19.587842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8da3e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8c655650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8d9ef910>]}
2021-06-16 07:46:19.588096 (MainThread): Flushing usage events
2021-06-16 07:46:43.290026 (MainThread): Running with dbt=0.19.1
2021-06-16 07:46:43.531226 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:46:43.531706 (MainThread): Tracking: tracking
2021-06-16 07:46:43.537487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452414b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524161050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524166910>]}
2021-06-16 07:46:43.557912 (MainThread): Partial parsing not enabled
2021-06-16 07:46:43.559164 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:46:43.599110 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:46:43.617976 (MainThread): Parsing macros/relations.sql
2021-06-16 07:46:43.618971 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:46:43.620276 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:46:43.650595 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:46:43.654111 (MainThread): Parsing macros/relations.sql
2021-06-16 07:46:43.656162 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:46:43.659799 (MainThread): Parsing macros/core.sql
2021-06-16 07:46:43.665925 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:46:43.730109 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:46:43.743676 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:46:43.745116 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:46:43.747639 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:46:43.750567 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:46:43.753016 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:46:43.754657 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:46:43.768486 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:46:43.789331 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:46:43.792224 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:46:43.801781 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:46:43.833042 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:46:43.877658 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:46:43.880379 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:46:43.907693 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:46:43.917884 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:46:43.925526 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:46:43.935162 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:46:43.939437 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:46:43.941846 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:46:43.944844 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:46:43.955496 (MainThread): Partial parsing not enabled
2021-06-16 07:46:43.994122 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.009397 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.014854 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.020968 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:46:44.178550 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.northwind_cls
- models.dbtintro.northwind_core
- models.dbtintro.example

2021-06-16 07:46:44.179433 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9520a009-8a02-453b-a917-fa2843607ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4523f3d710>]}
2021-06-16 07:46:44.185330 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9520a009-8a02-453b-a917-fa2843607ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45240c8550>]}
2021-06-16 07:46:44.185666 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:46:44.186990 (MainThread): 
2021-06-16 07:46:44.187485 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:46:44.188580 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:46:44.203795 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:46:44.203966 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:46:44.204083 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:46:44.204180 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:44.225130 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.02 seconds
2021-06-16 07:46:44.228479 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:46:44.230744 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:46:44.240514 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:46:44.240647 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:46:44.240756 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:46:44.240847 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:44.273169 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2021-06-16 07:46:44.273381 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:46:44.273495 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:46:44.276234 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 07:46:44.277021 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:46:44.277971 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:46:44.284408 (MainThread): Using redshift connection "master".
2021-06-16 07:46:44.284547 (MainThread): On master: BEGIN
2021-06-16 07:46:44.284656 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:46:44.284747 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:44.299440 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:44.299650 (MainThread): Using redshift connection "master".
2021-06-16 07:46:44.299763 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:46:44.405728 (MainThread): SQL status: SELECT 4 in 0.11 seconds
2021-06-16 07:46:44.406761 (MainThread): On master: ROLLBACK
2021-06-16 07:46:44.407848 (MainThread): Using redshift connection "master".
2021-06-16 07:46:44.407971 (MainThread): On master: BEGIN
2021-06-16 07:46:44.409969 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.410143 (MainThread): On master: COMMIT
2021-06-16 07:46:44.410262 (MainThread): Using redshift connection "master".
2021-06-16 07:46:44.410374 (MainThread): On master: COMMIT
2021-06-16 07:46:44.411494 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.411642 (MainThread): On master: Close
2021-06-16 07:46:44.412211 (MainThread): 07:46:44 | Concurrency: 1 threads (target='dev')
2021-06-16 07:46:44.412538 (MainThread): 07:46:44 | 
2021-06-16 07:46:44.415542 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:46:44.415886 (Thread-1): 07:46:44 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:46:44.416237 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.416404 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:46:44.419787 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:46:44.420157 (Thread-1): finished collecting timing info
2021-06-16 07:46:44.440067 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.440244 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:44.440358 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:44.440452 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:44.474376 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-06-16 07:46:44.480949 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.481101 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:46:44.482241 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:44.483563 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.483710 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.483820 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.484768 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.484920 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.485020 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:44.485976 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.486151 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.486259 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.486354 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.487300 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.487438 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.487537 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:44.488478 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.490151 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.490275 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:46:44.491323 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:44.492210 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.492342 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.492445 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.493454 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.493596 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.493699 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:44.494646 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.520431 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:46:44.520905 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.521025 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:46:44.522816 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:46:44.530866 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.531033 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:46:44.534189 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:44.536908 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.537048 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:46:44.541761 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:44.552902 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.553055 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.553162 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.557189 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.559729 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.559859 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:44.560778 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.562711 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.562840 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:46:44.564373 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:44.565375 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.565515 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.565622 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:44.568599 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.568740 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:44.568841 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:44.569816 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.570393 (Thread-1): finished collecting timing info
2021-06-16 07:46:44.570562 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:46:44.571506 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:46:44.572076 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9520a009-8a02-453b-a917-fa2843607ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4523daf390>]}
2021-06-16 07:46:44.572526 (Thread-1): 07:46:44 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.16s]
2021-06-16 07:46:44.572817 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:46:44.573005 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:46:44.573481 (Thread-1): 07:46:44 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:46:44.573903 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.574056 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:46:44.577808 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:46:44.578149 (Thread-1): finished collecting timing info
2021-06-16 07:46:44.597621 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.597809 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:44.597935 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:44.598030 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:44.612357 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:44.614280 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.614410 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:46:44.615522 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:44.616543 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.616668 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.616771 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.617734 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.617872 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.617973 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:44.618947 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.619114 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.619215 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.619307 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.620336 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.620462 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.620625 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:44.621816 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.623584 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.623715 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:46:44.624758 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:44.625687 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.625815 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.625920 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.626863 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.627020 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.627119 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:44.628039 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.634784 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:46:44.635203 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.635326 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST("CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:46:44.637406 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:46:44.640082 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.640210 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:46:44.641937 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:44.645796 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.645934 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:46:44.651336 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-06-16 07:46:44.652573 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.652698 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.652799 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.656945 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.657260 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.657388 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:44.659337 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.661011 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.661135 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:46:44.662520 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:44.663508 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.663642 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.663750 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:44.665435 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.665571 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:44.665670 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:44.667162 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.667707 (Thread-1): finished collecting timing info
2021-06-16 07:46:44.667873 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:46:44.671187 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:46:44.671723 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9520a009-8a02-453b-a917-fa2843607ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4520ddf510>]}
2021-06-16 07:46:44.672125 (Thread-1): 07:46:44 | 2 of 3 OK created view model sifa.cls_customers...................... [CREATE VIEW in 0.10s]
2021-06-16 07:46:44.672414 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:46:44.672601 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:46:44.672948 (Thread-1): 07:46:44 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:46:44.673398 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.673547 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:46:44.676747 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:46:44.677100 (Thread-1): finished collecting timing info
2021-06-16 07:46:44.679177 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.679311 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:44.679421 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:44.679511 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:44.691050 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:44.692735 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.692859 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:46:44.693901 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:44.694925 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.695058 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.695165 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.696110 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.696242 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.696340 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:44.697233 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.697403 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.697525 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.697617 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.698584 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.698720 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.698819 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:44.699820 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.701533 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.701664 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:46:44.702764 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:44.703658 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.703786 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.703889 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.704857 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.704989 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.705087 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:44.705994 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.706614 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:46:44.706995 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.707114 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:46:44.708941 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:46:44.711445 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.711572 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:46:44.712706 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:44.713935 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.714057 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.714158 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.715814 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.716080 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.716210 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:44.717147 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.718963 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.719098 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:46:44.720125 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:44.721096 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.721260 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.721365 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:44.722285 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.722421 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:44.722518 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:44.723454 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:44.723995 (Thread-1): finished collecting timing info
2021-06-16 07:46:44.724162 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:46:44.725133 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:46:44.725696 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9520a009-8a02-453b-a917-fa2843607ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4520e0a0d0>]}
2021-06-16 07:46:44.726141 (Thread-1): 07:46:44 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:46:44.726420 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:46:44.822118 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:46:44.822390 (MainThread): Using redshift connection "master".
2021-06-16 07:46:44.822514 (MainThread): On master: BEGIN
2021-06-16 07:46:44.822624 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:46:44.822727 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:44.837321 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:44.837493 (MainThread): On master: COMMIT
2021-06-16 07:46:44.837619 (MainThread): Using redshift connection "master".
2021-06-16 07:46:44.837719 (MainThread): On master: COMMIT
2021-06-16 07:46:44.838699 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:44.838873 (MainThread): On master: Close
2021-06-16 07:46:44.839449 (MainThread): 07:46:44 | 
2021-06-16 07:46:44.839719 (MainThread): 07:46:44 | Finished running 1 table model, 2 view models in 0.65s.
2021-06-16 07:46:44.839995 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:46:44.840104 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:46:44.840193 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:46:44.845191 (MainThread): 
2021-06-16 07:46:44.845439 (MainThread): Completed successfully
2021-06-16 07:46:44.845678 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:46:44.846009 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4520ddf950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452222c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4523f52d50>]}
2021-06-16 07:46:44.846287 (MainThread): Flushing usage events
2021-06-16 07:46:54.619930 (MainThread): Running with dbt=0.19.1
2021-06-16 07:46:54.861217 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:46:54.861715 (MainThread): Tracking: tracking
2021-06-16 07:46:54.867334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131385910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e771c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e777090>]}
2021-06-16 07:46:54.887339 (MainThread): Partial parsing not enabled
2021-06-16 07:46:54.888468 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:46:54.928065 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:46:54.947025 (MainThread): Parsing macros/relations.sql
2021-06-16 07:46:54.948030 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:46:54.949360 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:46:54.979919 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:46:54.983323 (MainThread): Parsing macros/relations.sql
2021-06-16 07:46:54.985333 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:46:54.989009 (MainThread): Parsing macros/core.sql
2021-06-16 07:46:54.995072 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:46:55.060993 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:46:55.074764 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:46:55.076338 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:46:55.078966 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:46:55.081929 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:46:55.084449 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:46:55.086113 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:46:55.100303 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:46:55.121356 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:46:55.124242 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:46:55.134060 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:46:55.165981 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:46:55.210854 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:46:55.213597 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:46:55.241476 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:46:55.251873 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:46:55.259678 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:46:55.269327 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:46:55.273556 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:46:55.275939 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:46:55.278809 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:46:55.289647 (MainThread): Partial parsing not enabled
2021-06-16 07:46:55.327664 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.342596 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.348127 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.354306 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:46:55.510941 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.northwind_core
- models.dbtintro.example
- models.dbtintro.northwind_cls

2021-06-16 07:46:55.511862 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2495c0d4-6414-484f-bcc2-d5ae9893003b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e563b50>]}
2021-06-16 07:46:55.517893 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2495c0d4-6414-484f-bcc2-d5ae9893003b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e6db990>]}
2021-06-16 07:46:55.518234 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:46:55.519550 (MainThread): 
2021-06-16 07:46:55.520033 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:46:55.521110 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:46:55.536435 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:46:55.536597 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:46:55.536715 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:46:55.536812 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:55.553987 (ThreadPoolExecutor-0_0): SQL status: SELECT 11 in 0.02 seconds
2021-06-16 07:46:55.557379 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:46:55.559718 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:46:55.569796 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:46:55.569985 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:46:55.570103 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:46:55.570202 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:55.582081 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:55.582283 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:46:55.582397 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:46:55.585067 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 07:46:55.585887 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:46:55.586842 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:46:55.593482 (MainThread): Using redshift connection "master".
2021-06-16 07:46:55.593626 (MainThread): On master: BEGIN
2021-06-16 07:46:55.593739 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:46:55.593834 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:55.605214 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:55.605382 (MainThread): Using redshift connection "master".
2021-06-16 07:46:55.605499 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:46:55.712316 (MainThread): SQL status: SELECT 4 in 0.11 seconds
2021-06-16 07:46:55.713341 (MainThread): On master: ROLLBACK
2021-06-16 07:46:55.714388 (MainThread): Using redshift connection "master".
2021-06-16 07:46:55.714515 (MainThread): On master: BEGIN
2021-06-16 07:46:55.716393 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.716535 (MainThread): On master: COMMIT
2021-06-16 07:46:55.716640 (MainThread): Using redshift connection "master".
2021-06-16 07:46:55.716735 (MainThread): On master: COMMIT
2021-06-16 07:46:55.717718 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.717859 (MainThread): On master: Close
2021-06-16 07:46:55.718431 (MainThread): 07:46:55 | Concurrency: 1 threads (target='dev')
2021-06-16 07:46:55.718723 (MainThread): 07:46:55 | 
2021-06-16 07:46:55.721693 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:46:55.722027 (Thread-1): 07:46:55 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:46:55.722373 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.722532 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:46:55.725892 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:46:55.726255 (Thread-1): finished collecting timing info
2021-06-16 07:46:55.746262 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.746435 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:55.746558 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:55.746668 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:55.758265 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:55.764549 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.764689 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:46:55.765820 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:55.767094 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.767224 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.767329 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.768260 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.768402 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.768505 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:55.769435 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.769603 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.769706 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.769800 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.770698 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.770825 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.770945 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:55.771838 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.773553 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.773676 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:46:55.774683 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:55.775603 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.775734 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.775841 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.776787 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.776923 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.777021 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:55.777915 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.803580 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:46:55.804070 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.804191 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:46:55.805950 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:46:55.813878 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.814022 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:46:55.815131 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:55.817839 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.817982 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:46:55.819111 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:55.830154 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.830299 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.830405 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.832373 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.834835 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.835003 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:55.835952 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.837930 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.838059 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:46:55.839552 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:46:55.840486 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.840609 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.840712 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:46:55.843711 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.843854 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:46:55.843955 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:46:55.844886 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.845448 (Thread-1): finished collecting timing info
2021-06-16 07:46:55.845616 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:46:55.846552 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:46:55.847119 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2495c0d4-6414-484f-bcc2-d5ae9893003b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e578fd0>]}
2021-06-16 07:46:55.847568 (Thread-1): 07:46:55 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.12s]
2021-06-16 07:46:55.847853 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:46:55.848050 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:46:55.848495 (Thread-1): 07:46:55 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:46:55.848900 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.849051 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:46:55.852697 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:46:55.853054 (Thread-1): finished collecting timing info
2021-06-16 07:46:55.872515 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.872728 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:55.872853 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:55.872949 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:55.884456 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:55.886358 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.886485 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:46:55.887547 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:55.888572 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.888701 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.888807 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.889727 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.889860 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.889960 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:55.890856 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.891042 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.891144 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.891235 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.892123 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.892248 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.892343 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:55.893236 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.895017 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.895144 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:46:55.896117 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:55.897049 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.897183 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.897291 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.898193 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.898340 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.898437 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:55.899476 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.906137 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:46:55.906546 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.906665 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST("CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:46:55.908759 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:46:55.911653 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.911780 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:46:55.912998 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:55.916937 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.917070 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:46:55.918232 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:55.919652 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.919787 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.919902 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.921473 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.921730 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.921841 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:55.922779 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.924576 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.924706 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:46:55.926041 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:55.927012 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.927187 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.927296 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:46:55.929101 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.929260 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:46:55.929361 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:46:55.930262 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.930818 (Thread-1): finished collecting timing info
2021-06-16 07:46:55.931016 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:46:55.931941 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:46:55.932526 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2495c0d4-6414-484f-bcc2-d5ae9893003b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc131b05210>]}
2021-06-16 07:46:55.932983 (Thread-1): 07:46:55 | 2 of 3 OK created view model sifa.cls_customers...................... [CREATE VIEW in 0.08s]
2021-06-16 07:46:55.933271 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:46:55.933473 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:46:55.933891 (Thread-1): 07:46:55 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:46:55.934312 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.934463 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:46:55.937726 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:46:55.938087 (Thread-1): finished collecting timing info
2021-06-16 07:46:55.940177 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.940318 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:55.940437 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:46:55.940535 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:55.952072 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:55.954138 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.954270 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:46:55.955411 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:55.956522 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.956656 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.956768 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.957658 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.957803 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.957909 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:55.958870 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.959100 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.959230 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.959340 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.960236 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.960371 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.960472 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:55.961391 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.963462 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.963596 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:46:55.964580 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:55.965569 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.965697 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.965804 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.966696 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.966830 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.966970 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:55.967885 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.968528 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:46:55.968904 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.969022 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:46:55.970856 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:46:55.973475 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.973604 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:46:55.974701 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:46:55.976025 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.976160 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.976267 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.977851 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.978103 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.978211 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:55.979110 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.980861 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.980985 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:46:55.981964 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:46:55.982840 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.982991 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.983099 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:46:55.984007 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:55.984147 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:46:55.984248 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:46:55.985162 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:46:55.985714 (Thread-1): finished collecting timing info
2021-06-16 07:46:55.985886 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:46:55.986794 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:46:55.987366 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2495c0d4-6414-484f-bcc2-d5ae9893003b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12c7f1a50>]}
2021-06-16 07:46:55.987833 (Thread-1): 07:46:55 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:46:55.988134 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:46:56.028037 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:46:56.028288 (MainThread): Using redshift connection "master".
2021-06-16 07:46:56.028398 (MainThread): On master: BEGIN
2021-06-16 07:46:56.028505 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:46:56.028597 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:46:56.040296 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:46:56.040504 (MainThread): On master: COMMIT
2021-06-16 07:46:56.040615 (MainThread): Using redshift connection "master".
2021-06-16 07:46:56.040717 (MainThread): On master: COMMIT
2021-06-16 07:46:56.041605 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:46:56.041747 (MainThread): On master: Close
2021-06-16 07:46:56.042288 (MainThread): 07:46:56 | 
2021-06-16 07:46:56.042617 (MainThread): 07:46:56 | Finished running 1 table model, 2 view models in 0.52s.
2021-06-16 07:46:56.042847 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:46:56.042987 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:46:56.043083 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:46:56.048196 (MainThread): 
2021-06-16 07:46:56.048455 (MainThread): Completed successfully
2021-06-16 07:46:56.048696 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:46:56.049068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e413e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e38af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12e302990>]}
2021-06-16 07:46:56.049322 (MainThread): Flushing usage events
2021-06-16 07:48:36.503535 (MainThread): Running with dbt=0.19.1
2021-06-16 07:48:36.750918 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:48:36.751423 (MainThread): Tracking: tracking
2021-06-16 07:48:36.757217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd646320d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6462b45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd646324810>]}
2021-06-16 07:48:36.777859 (MainThread): Partial parsing not enabled
2021-06-16 07:48:36.779081 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:48:36.818754 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:48:36.838207 (MainThread): Parsing macros/relations.sql
2021-06-16 07:48:36.839250 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:48:36.840593 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:48:36.872839 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:48:36.876363 (MainThread): Parsing macros/relations.sql
2021-06-16 07:48:36.878379 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:48:36.881958 (MainThread): Parsing macros/core.sql
2021-06-16 07:48:36.887970 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:48:36.953740 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:48:36.967506 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:48:36.968992 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:48:36.971564 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:48:36.974516 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:48:36.977121 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:48:36.978754 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:48:36.992959 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:48:37.014408 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:48:37.017424 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:48:37.027332 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:48:37.059363 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:48:37.104598 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:48:37.107408 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:48:37.137656 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:48:37.147984 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:48:37.155885 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:48:37.165449 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:48:37.169686 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:48:37.172104 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:48:37.175121 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:48:37.185867 (MainThread): Partial parsing not enabled
2021-06-16 07:48:37.224830 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.240041 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.245523 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.251822 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:48:37.410864 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.example
- models.dbtintro.northwind_core
- models.dbtintro.northwind_cls

2021-06-16 07:48:37.411829 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19c221bc-48b0-46e4-8ac8-defaf39a235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64629a410>]}
2021-06-16 07:48:37.417930 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19c221bc-48b0-46e4-8ac8-defaf39a235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd648f66750>]}
2021-06-16 07:48:37.418314 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:48:37.419659 (MainThread): 
2021-06-16 07:48:37.420166 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:48:37.421269 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:48:37.436909 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:48:37.437117 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:48:37.437238 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:48:37.437338 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.460276 (ThreadPoolExecutor-0_0): SQL status: SELECT 9 in 0.02 seconds
2021-06-16 07:48:37.463645 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:48:37.464504 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa".
2021-06-16 07:48:37.464858 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa".
2021-06-16 07:48:37.465060 (ThreadPoolExecutor-0_0): Creating schema ""postgres"."sifa""
2021-06-16 07:48:37.473899 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa".
2021-06-16 07:48:37.474044 (ThreadPoolExecutor-0_0): On create_postgres_sifa: BEGIN
2021-06-16 07:48:37.474168 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:48:37.474265 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.485802 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:48:37.485981 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa".
2021-06-16 07:48:37.486100 (ThreadPoolExecutor-0_0): On create_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_postgres_sifa"} */
create schema if not exists "sifa"
2021-06-16 07:48:37.487218 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.00 seconds
2021-06-16 07:48:37.488429 (ThreadPoolExecutor-0_0): On create_postgres_sifa: COMMIT
2021-06-16 07:48:37.488557 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa".
2021-06-16 07:48:37.488659 (ThreadPoolExecutor-0_0): On create_postgres_sifa: COMMIT
2021-06-16 07:48:37.490374 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.490522 (ThreadPoolExecutor-0_0): On create_postgres_sifa: Close
2021-06-16 07:48:37.492843 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:48:37.503719 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:48:37.503855 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:48:37.503967 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:48:37.504061 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.524006 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:48:37.524223 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:48:37.524341 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:48:37.528464 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.00 seconds
2021-06-16 07:48:37.528879 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:48:37.530448 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:48:37.537037 (MainThread): Using redshift connection "master".
2021-06-16 07:48:37.537176 (MainThread): On master: BEGIN
2021-06-16 07:48:37.537291 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:48:37.537386 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.558870 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:48:37.559111 (MainThread): Using redshift connection "master".
2021-06-16 07:48:37.559228 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:48:37.641790 (MainThread): SQL status: SELECT 2 in 0.08 seconds
2021-06-16 07:48:37.642667 (MainThread): On master: ROLLBACK
2021-06-16 07:48:37.643683 (MainThread): Using redshift connection "master".
2021-06-16 07:48:37.643808 (MainThread): On master: BEGIN
2021-06-16 07:48:37.645756 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.645893 (MainThread): On master: COMMIT
2021-06-16 07:48:37.646005 (MainThread): Using redshift connection "master".
2021-06-16 07:48:37.646103 (MainThread): On master: COMMIT
2021-06-16 07:48:37.647057 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.647215 (MainThread): On master: Close
2021-06-16 07:48:37.647800 (MainThread): 07:48:37 | Concurrency: 1 threads (target='dev')
2021-06-16 07:48:37.648127 (MainThread): 07:48:37 | 
2021-06-16 07:48:37.650099 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:48:37.650431 (Thread-1): 07:48:37 | 1 of 3 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:48:37.650762 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.650954 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:48:37.654053 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:48:37.654414 (Thread-1): finished collecting timing info
2021-06-16 07:48:37.674648 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.674821 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:48:37.674959 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:48:37.675064 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.686832 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:48:37.693162 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.693302 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:48:37.694531 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:48:37.695585 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.695718 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.695826 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.696798 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.696937 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.697039 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:48:37.697956 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.698119 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.698219 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.698311 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.699200 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.699337 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.699434 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:48:37.700344 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.702159 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.702290 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:48:37.703330 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:48:37.704218 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.704347 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.704452 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.705401 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.705534 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.705633 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:48:37.706606 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.732154 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:48:37.732623 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.732750 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:48:37.734596 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:48:37.742501 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.742640 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:48:37.743756 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:48:37.754911 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.755060 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.755166 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.757238 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.759705 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.759833 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:48:37.760782 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.762661 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.762783 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:48:37.767859 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:48:37.768826 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.768951 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.769053 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:48:37.769990 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.770133 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:48:37.770233 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:48:37.771174 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.771738 (Thread-1): finished collecting timing info
2021-06-16 07:48:37.771905 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:48:37.772823 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:48:37.773371 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19c221bc-48b0-46e4-8ac8-defaf39a235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd645f0d7d0>]}
2021-06-16 07:48:37.773767 (Thread-1): 07:48:37 | 1 of 3 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.12s]
2021-06-16 07:48:37.774050 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:48:37.774240 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:48:37.774684 (Thread-1): 07:48:37 | 2 of 3 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:48:37.775084 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.775231 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:48:37.778786 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:48:37.779149 (Thread-1): finished collecting timing info
2021-06-16 07:48:37.798196 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.798347 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:48:37.798458 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:48:37.798551 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.810568 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:48:37.812476 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.812628 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:48:37.813671 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:48:37.814668 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.814793 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.814920 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.815895 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.816033 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.816135 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:48:37.817089 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.817252 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.817353 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.817444 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.818340 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.818466 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.818562 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:48:37.819498 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.821233 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.821354 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:48:37.822342 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:48:37.823265 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.823395 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.823501 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.824411 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.824549 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.824659 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:48:37.825555 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.832373 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:48:37.832802 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.832925 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(m."CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:48:37.835067 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:48:37.837820 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.837954 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:48:37.839022 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:48:37.840300 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.840424 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.840526 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.842476 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.842734 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.842842 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:48:37.843830 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.846605 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.846730 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:48:37.847749 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:48:37.848649 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.848776 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.848880 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:48:37.849878 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.850016 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:48:37.850113 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:48:37.850974 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.851492 (Thread-1): finished collecting timing info
2021-06-16 07:48:37.851656 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:48:37.852630 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:48:37.853171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19c221bc-48b0-46e4-8ac8-defaf39a235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd644409f10>]}
2021-06-16 07:48:37.853615 (Thread-1): 07:48:37 | 2 of 3 OK created view model sifa.cls_customers...................... [CREATE VIEW in 0.08s]
2021-06-16 07:48:37.853904 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:48:37.854099 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:48:37.854494 (Thread-1): 07:48:37 | 3 of 3 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:48:37.854946 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.855126 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:48:37.857923 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:48:37.858263 (Thread-1): finished collecting timing info
2021-06-16 07:48:37.860305 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.860436 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:48:37.860545 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:48:37.860653 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.872708 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:48:37.874494 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.874617 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:48:37.875689 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:48:37.876644 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.876768 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.876870 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.877899 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.878038 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.878138 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:48:37.879076 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.879247 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.879353 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.879448 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.880367 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.880494 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.880595 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:48:37.881574 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.883153 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.883285 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:48:37.884462 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:48:37.885375 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.885503 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.885610 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.886555 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.886691 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.886793 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:48:37.887765 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.888425 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:48:37.888806 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.888922 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:48:37.890758 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:48:37.893344 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.893474 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:48:37.894535 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:48:37.895851 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.895982 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.896087 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.897822 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.898087 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.898199 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:48:37.899088 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.900811 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.900932 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:48:37.901937 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:48:37.902794 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.902953 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.903062 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:48:37.903989 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.904121 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:48:37.904220 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:48:37.905132 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:48:37.905640 (Thread-1): finished collecting timing info
2021-06-16 07:48:37.905804 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:48:37.906756 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:48:37.907299 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19c221bc-48b0-46e4-8ac8-defaf39a235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd644409910>]}
2021-06-16 07:48:37.907743 (Thread-1): 07:48:37 | 3 of 3 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:48:37.908026 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:48:37.955930 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:48:37.956180 (MainThread): Using redshift connection "master".
2021-06-16 07:48:37.956292 (MainThread): On master: BEGIN
2021-06-16 07:48:37.956412 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:48:37.956515 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:48:37.970529 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:48:37.970752 (MainThread): On master: COMMIT
2021-06-16 07:48:37.970869 (MainThread): Using redshift connection "master".
2021-06-16 07:48:37.971017 (MainThread): On master: COMMIT
2021-06-16 07:48:37.971914 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:48:37.972062 (MainThread): On master: Close
2021-06-16 07:48:37.972637 (MainThread): 07:48:37 | 
2021-06-16 07:48:37.972935 (MainThread): 07:48:37 | Finished running 1 table model, 2 view models in 0.55s.
2021-06-16 07:48:37.973189 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:48:37.973301 (MainThread): Connection 'create_postgres_sifa' was properly closed.
2021-06-16 07:48:37.973393 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:48:37.978835 (MainThread): 
2021-06-16 07:48:37.979178 (MainThread): Completed successfully
2021-06-16 07:48:37.979440 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-16 07:48:37.979823 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd646237750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6443db050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6443db490>]}
2021-06-16 07:48:37.980082 (MainThread): Flushing usage events
2021-06-16 07:50:43.609152 (MainThread): Running with dbt=0.19.1
2021-06-16 07:50:43.848882 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:50:43.849369 (MainThread): Tracking: tracking
2021-06-16 07:50:43.855055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25050b7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2505041550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25050b6390>]}
2021-06-16 07:50:43.875530 (MainThread): Partial parsing not enabled
2021-06-16 07:50:43.876701 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:50:43.916358 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:50:43.934989 (MainThread): Parsing macros/relations.sql
2021-06-16 07:50:43.935911 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:50:43.937218 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:50:43.967404 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:50:43.970824 (MainThread): Parsing macros/relations.sql
2021-06-16 07:50:43.972803 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:50:43.976494 (MainThread): Parsing macros/core.sql
2021-06-16 07:50:43.982572 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:50:44.047620 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:50:44.061243 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:50:44.062646 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:50:44.065244 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:50:44.068330 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:50:44.070804 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:50:44.072451 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:50:44.086379 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:50:44.107364 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:50:44.110150 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:50:44.119921 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:50:44.151859 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:50:44.197013 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:50:44.199762 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:50:44.227243 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:50:44.237292 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:50:44.244896 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:50:44.254313 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:50:44.258529 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:50:44.260933 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:50:44.263810 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:50:44.274332 (MainThread): Partial parsing not enabled
2021-06-16 07:50:44.312792 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.328270 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.333749 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.339770 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.498190 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbtintro.example
- models.dbtintro.northwind_core
- models.dbtintro.northwind_cls

2021-06-16 07:50:44.499080 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '028f96b6-dfe1-40d7-b9fa-80c8cb83bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2504e86f50>]}
2021-06-16 07:50:44.504823 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '028f96b6-dfe1-40d7-b9fa-80c8cb83bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2504c64450>]}
2021-06-16 07:50:44.505176 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:50:44.506539 (MainThread): 
2021-06-16 07:50:44.507063 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:50:44.508278 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:50:44.523648 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:50:44.523826 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:50:44.523944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:50:44.524046 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:44.543809 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.02 seconds
2021-06-16 07:50:44.547140 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:50:44.549385 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:50:44.559276 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:50:44.559416 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:50:44.559535 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:50:44.559639 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:44.570830 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:44.571007 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:50:44.571123 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:50:44.573764 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 07:50:44.574527 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:50:44.575480 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:50:44.581744 (MainThread): Using redshift connection "master".
2021-06-16 07:50:44.581884 (MainThread): On master: BEGIN
2021-06-16 07:50:44.581995 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:50:44.582089 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:44.593302 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:44.593465 (MainThread): Using redshift connection "master".
2021-06-16 07:50:44.593578 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:50:44.697045 (MainThread): SQL status: SELECT 4 in 0.10 seconds
2021-06-16 07:50:44.698040 (MainThread): On master: ROLLBACK
2021-06-16 07:50:44.699063 (MainThread): Using redshift connection "master".
2021-06-16 07:50:44.699191 (MainThread): On master: BEGIN
2021-06-16 07:50:44.700931 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.701063 (MainThread): On master: COMMIT
2021-06-16 07:50:44.701170 (MainThread): Using redshift connection "master".
2021-06-16 07:50:44.701267 (MainThread): On master: COMMIT
2021-06-16 07:50:44.702152 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.702291 (MainThread): On master: Close
2021-06-16 07:50:44.702853 (MainThread): 07:50:44 | Concurrency: 1 threads (target='dev')
2021-06-16 07:50:44.703226 (MainThread): 07:50:44 | 
2021-06-16 07:50:44.706204 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:50:44.706523 (Thread-1): 07:50:44 | 1 of 4 START view model sifa.cls_customers........................... [RUN]
2021-06-16 07:50:44.706857 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.707053 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:50:44.710806 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:50:44.711313 (Thread-1): finished collecting timing info
2021-06-16 07:50:44.737021 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.737172 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:50:44.737285 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:50:44.737379 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:44.748678 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:44.754847 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.755026 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_tmp" cascade
2021-06-16 07:50:44.756150 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:44.757244 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.757369 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.757474 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.758396 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.758529 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.758628 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:50:44.759504 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.759670 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.759772 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.759863 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.761095 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.761220 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.761315 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:50:44.762547 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.764233 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.764363 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:50:44.765432 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:44.766341 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.766472 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.766591 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.767537 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.767714 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.767831 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:50:44.768735 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.775434 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:50:44.775812 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.775932 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(m."CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:50:44.778151 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:50:44.785861 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.785996 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:50:44.787218 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:50:44.789742 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.789867 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:50:44.791125 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:50:44.802211 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.802377 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.802484 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.804458 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.807135 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.807312 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:50:44.808314 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.810123 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.810248 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa"."cls_customers__dbt_backup" cascade
2021-06-16 07:50:44.811628 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:44.812616 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.812744 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.812848 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:50:44.815310 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.815449 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:50:44.815551 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:50:44.816466 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.817060 (Thread-1): finished collecting timing info
2021-06-16 07:50:44.817230 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:50:44.818421 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:50:44.819025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028f96b6-dfe1-40d7-b9fa-80c8cb83bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2504be49d0>]}
2021-06-16 07:50:44.819492 (Thread-1): 07:50:44 | 1 of 4 OK created view model sifa.cls_customers...................... [CREATE VIEW in 0.11s]
2021-06-16 07:50:44.819786 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:50:44.819971 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:50:44.820422 (Thread-1): 07:50:44 | 2 of 4 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:50:44.820846 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.820994 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:50:44.824159 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:50:44.824522 (Thread-1): finished collecting timing info
2021-06-16 07:50:44.844346 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.844539 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:50:44.844657 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:50:44.844765 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:44.856589 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:44.858468 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.858595 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:50:44.859630 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:50:44.860621 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.860749 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.860854 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.861746 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.861881 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.861983 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:50:44.862918 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.863111 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.863216 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.863310 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.864202 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.864335 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.864444 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:50:44.865355 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.867030 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.867168 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:50:44.868187 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:50:44.869056 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.869182 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.869287 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.870183 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.870325 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.870427 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:50:44.871321 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.890031 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:50:44.890466 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.890588 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:50:44.892302 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:50:44.895195 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.895326 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:50:44.896437 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:50:44.898944 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.899080 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:50:44.900096 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:50:44.901337 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.901462 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.901563 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.903329 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.903609 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.903720 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:50:44.904643 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.907674 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.907835 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:50:44.909476 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:50:44.910337 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.910461 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.910563 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:50:44.913703 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.913842 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:50:44.913942 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:50:44.914883 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.915410 (Thread-1): finished collecting timing info
2021-06-16 07:50:44.915580 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:50:44.916496 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:50:44.917038 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028f96b6-dfe1-40d7-b9fa-80c8cb83bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25041b11d0>]}
2021-06-16 07:50:44.917476 (Thread-1): 07:50:44 | 2 of 4 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.10s]
2021-06-16 07:50:44.917762 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:50:44.917940 (Thread-1): Began running node model.my_new_project.dim_customers
2021-06-16 07:50:44.918366 (Thread-1): 07:50:44 | 3 of 4 START view model sifa.dim_customers........................... [RUN]
2021-06-16 07:50:44.918773 (Thread-1): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.918942 (Thread-1): Compiling model.my_new_project.dim_customers
2021-06-16 07:50:44.921713 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-06-16 07:50:44.922039 (Thread-1): finished collecting timing info
2021-06-16 07:50:44.923856 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.923992 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:50:44.924106 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:50:44.924203 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:44.935315 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:44.937038 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.937161 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
drop view if exists "postgres"."sifa"."dim_customers__dbt_tmp" cascade
2021-06-16 07:50:44.938294 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:44.939276 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.939406 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.939510 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.940436 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.940568 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.940666 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:50:44.941591 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.941757 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.941859 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.941975 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.942848 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.942998 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.943099 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:50:44.943995 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.945673 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.945814 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
drop view if exists "postgres"."sifa"."dim_customers__dbt_backup" cascade
2021-06-16 07:50:44.946777 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:44.947682 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.947815 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.947922 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.948833 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.948965 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.949064 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:50:44.949948 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.950557 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-06-16 07:50:44.950912 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.951043 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */


  create view "postgres"."sifa"."dim_customers__dbt_tmp" as (
    select *
from "postgres"."sifa"."cls_customers"
  ) ;

2021-06-16 07:50:44.953083 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:50:44.955560 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.955703 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
alter table "postgres"."sifa"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 07:50:44.956803 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:50:44.958081 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.958204 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.958306 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.960117 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.960376 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.960486 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:50:44.961406 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.962967 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.963097 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
drop view if exists "postgres"."sifa"."dim_customers__dbt_backup" cascade
2021-06-16 07:50:44.964092 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:44.964988 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.965115 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.965221 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:50:44.966101 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.966238 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:50:44.966339 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:50:44.967236 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.967738 (Thread-1): finished collecting timing info
2021-06-16 07:50:44.967905 (Thread-1): On model.my_new_project.dim_customers: ROLLBACK
2021-06-16 07:50:44.968818 (Thread-1): On model.my_new_project.dim_customers: Close
2021-06-16 07:50:44.969339 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028f96b6-dfe1-40d7-b9fa-80c8cb83bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250419aed0>]}
2021-06-16 07:50:44.969772 (Thread-1): 07:50:44 | 3 of 4 OK created view model sifa.dim_customers...................... [CREATE VIEW in 0.05s]
2021-06-16 07:50:44.970055 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-06-16 07:50:44.970237 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:50:44.970578 (Thread-1): 07:50:44 | 4 of 4 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:50:44.971003 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.971154 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:50:44.974088 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:50:44.974409 (Thread-1): finished collecting timing info
2021-06-16 07:50:44.976406 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.976543 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:50:44.976665 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:50:44.976762 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:44.988786 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:44.990399 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.990520 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:50:44.991629 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:44.992699 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:44.992824 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.992926 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:44.993817 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.993949 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.994046 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:50:44.994908 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.995104 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:44.995207 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.995299 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:44.996191 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:44.996319 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.996422 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:50:44.997315 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:44.998906 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:44.999041 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:50:45.000010 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:45.000924 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:45.001052 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.001159 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:45.004731 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:45.004866 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.004980 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:50:45.010977 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:45.011661 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:50:45.012029 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.012154 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:50:45.020209 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-06-16 07:50:45.022914 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.023051 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:50:45.034183 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-06-16 07:50:45.035503 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:45.035629 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.035735 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:45.037642 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:45.037925 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.038037 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:50:45.039103 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:45.040773 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.040895 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:50:45.042088 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:50:45.042979 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:45.043115 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.043220 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:50:45.045138 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:45.045279 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:50:45.045377 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:50:45.047357 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:50:45.047864 (Thread-1): finished collecting timing info
2021-06-16 07:50:45.048026 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:50:45.049172 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:50:45.049714 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028f96b6-dfe1-40d7-b9fa-80c8cb83bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2504bd1810>]}
2021-06-16 07:50:45.050152 (Thread-1): 07:50:45 | 4 of 4 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.08s]
2021-06-16 07:50:45.050439 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:50:45.108765 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:50:45.108975 (MainThread): Using redshift connection "master".
2021-06-16 07:50:45.109080 (MainThread): On master: BEGIN
2021-06-16 07:50:45.109192 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:50:45.109277 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:50:45.120939 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:50:45.121099 (MainThread): On master: COMMIT
2021-06-16 07:50:45.121208 (MainThread): Using redshift connection "master".
2021-06-16 07:50:45.121306 (MainThread): On master: COMMIT
2021-06-16 07:50:45.123107 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:50:45.123250 (MainThread): On master: Close
2021-06-16 07:50:45.123745 (MainThread): 07:50:45 | 
2021-06-16 07:50:45.124037 (MainThread): 07:50:45 | Finished running 3 view models, 1 table model in 0.62s.
2021-06-16 07:50:45.124318 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:50:45.124429 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:50:45.124523 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:50:45.129673 (MainThread): 
2021-06-16 07:50:45.129922 (MainThread): Completed successfully
2021-06-16 07:50:45.130163 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-16 07:50:45.130531 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2504bd1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2504e87690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2504be1310>]}
2021-06-16 07:50:45.130773 (MainThread): Flushing usage events
2021-06-16 07:51:50.897085 (MainThread): Running with dbt=0.19.1
2021-06-16 07:51:51.149794 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:51:51.150271 (MainThread): Tracking: tracking
2021-06-16 07:51:51.156170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec89832dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8981ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec897c2b90>]}
2021-06-16 07:51:51.176923 (MainThread): Partial parsing not enabled
2021-06-16 07:51:51.178144 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:51:51.218339 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:51:51.237194 (MainThread): Parsing macros/relations.sql
2021-06-16 07:51:51.238189 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:51:51.239556 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:51:51.269928 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:51:51.273375 (MainThread): Parsing macros/relations.sql
2021-06-16 07:51:51.275379 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:51:51.278945 (MainThread): Parsing macros/core.sql
2021-06-16 07:51:51.284962 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:51:51.350280 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:51:51.363819 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:51:51.365320 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:51:51.367949 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:51:51.371032 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:51:51.373513 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:51:51.375166 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:51:51.389220 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:51:51.410512 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:51:51.413424 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:51:51.423223 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:51:51.455219 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:51:51.500767 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:51:51.503632 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:51:51.531727 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:51:51.542149 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:51:51.550131 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:51:51.559933 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:51:51.564222 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:51:51.566697 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:51:51.569708 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:51:51.580691 (MainThread): Partial parsing not enabled
2021-06-16 07:51:51.619965 (MainThread): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:51.635653 (MainThread): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:51.641620 (MainThread): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:51.646235 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:51:51.648467 (MainThread): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:51.652059 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:51:51.811136 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2e9ce66-091f-40de-a809-5dd6481483dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec89388990>]}
2021-06-16 07:51:51.817139 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2e9ce66-091f-40de-a809-5dd6481483dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec897940d0>]}
2021-06-16 07:51:51.817455 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:51:51.818953 (MainThread): 
2021-06-16 07:51:51.819461 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:51:51.820747 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:51:51.836189 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:51:51.836336 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:51:51.836450 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:51:51.836557 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:51.863734 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.03 seconds
2021-06-16 07:51:51.866850 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:51:51.867565 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:51:51.869510 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:51:51.869637 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:51:51.869753 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:51:51.869851 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:51.881814 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.01 seconds
2021-06-16 07:51:51.882359 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:51:51.883005 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:51:51.885038 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:51:51.885162 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:51:51.885274 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:51:51.885369 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:51.897238 (ThreadPoolExecutor-0_0): SQL status: SELECT 10 in 0.01 seconds
2021-06-16 07:51:51.897768 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:51:51.898509 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa_cleansing".
2021-06-16 07:51:51.898838 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa_cleansing".
2021-06-16 07:51:51.899069 (ThreadPoolExecutor-0_0): Creating schema ""postgres"."sifa_cleansing""
2021-06-16 07:51:51.908580 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_cleansing".
2021-06-16 07:51:51.908729 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cleansing: BEGIN
2021-06-16 07:51:51.908843 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:51:51.908939 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:51.920721 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:51.920865 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_cleansing".
2021-06-16 07:51:51.920974 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_postgres_sifa_cleansing"} */
create schema if not exists "sifa_cleansing"
2021-06-16 07:51:51.922098 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.00 seconds
2021-06-16 07:51:51.923268 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cleansing: COMMIT
2021-06-16 07:51:51.923407 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_cleansing".
2021-06-16 07:51:51.923515 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cleansing: COMMIT
2021-06-16 07:51:51.925348 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:51.925488 (ThreadPoolExecutor-0_0): On create_postgres_sifa_cleansing: Close
2021-06-16 07:51:51.926226 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa_core".
2021-06-16 07:51:51.926593 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "create_postgres_sifa_core".
2021-06-16 07:51:51.926772 (ThreadPoolExecutor-0_0): Creating schema ""postgres"."sifa_core""
2021-06-16 07:51:51.928893 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_core".
2021-06-16 07:51:51.929020 (ThreadPoolExecutor-0_0): On create_postgres_sifa_core: BEGIN
2021-06-16 07:51:51.929130 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:51:51.929224 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:51.956246 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.03 seconds
2021-06-16 07:51:51.956466 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_core".
2021-06-16 07:51:51.956597 (ThreadPoolExecutor-0_0): On create_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_postgres_sifa_core"} */
create schema if not exists "sifa_core"
2021-06-16 07:51:51.961402 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.00 seconds
2021-06-16 07:51:51.962498 (ThreadPoolExecutor-0_0): On create_postgres_sifa_core: COMMIT
2021-06-16 07:51:51.962626 (ThreadPoolExecutor-0_0): Using redshift connection "create_postgres_sifa_core".
2021-06-16 07:51:51.962738 (ThreadPoolExecutor-0_0): On create_postgres_sifa_core: COMMIT
2021-06-16 07:51:51.964556 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:51.964711 (ThreadPoolExecutor-0_0): On create_postgres_sifa_core: Close
2021-06-16 07:51:51.967156 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:51:51.977051 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:51:51.977192 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 07:51:51.977306 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:51:51.977413 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:51.990003 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:51.990185 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:51:51.990296 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 07:51:51.993070 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.00 seconds
2021-06-16 07:51:51.993448 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 07:51:51.994377 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 07:51:51.995051 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:51:51.997197 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:51:51.997324 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:51:51.997437 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:51:51.997534 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.009939 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:52.010135 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:51:52.010249 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:51:52.012917 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 07:51:52.013731 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:51:52.014683 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:51:52.015364 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 07:51:52.017535 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:51:52.017660 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 07:51:52.017771 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:51:52.017865 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.032350 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:52.032517 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:51:52.032627 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 07:51:52.035271 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.00 seconds
2021-06-16 07:51:52.035659 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 07:51:52.036678 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 07:51:52.043092 (MainThread): Using redshift connection "master".
2021-06-16 07:51:52.043224 (MainThread): On master: BEGIN
2021-06-16 07:51:52.043342 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:51:52.043450 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.073222 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-06-16 07:51:52.073447 (MainThread): Using redshift connection "master".
2021-06-16 07:51:52.073564 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:51:52.180769 (MainThread): SQL status: SELECT 5 in 0.11 seconds
2021-06-16 07:51:52.181823 (MainThread): On master: ROLLBACK
2021-06-16 07:51:52.183886 (MainThread): Using redshift connection "master".
2021-06-16 07:51:52.184022 (MainThread): On master: BEGIN
2021-06-16 07:51:52.188247 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.188406 (MainThread): On master: COMMIT
2021-06-16 07:51:52.188512 (MainThread): Using redshift connection "master".
2021-06-16 07:51:52.188617 (MainThread): On master: COMMIT
2021-06-16 07:51:52.189681 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.189824 (MainThread): On master: Close
2021-06-16 07:51:52.190396 (MainThread): 07:51:52 | Concurrency: 1 threads (target='dev')
2021-06-16 07:51:52.190686 (MainThread): 07:51:52 | 
2021-06-16 07:51:52.192443 (Thread-1): Began running node model.my_new_project.cls_customers
2021-06-16 07:51:52.192804 (Thread-1): 07:51:52 | 1 of 4 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 07:51:52.193146 (Thread-1): Acquiring new redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.193309 (Thread-1): Compiling model.my_new_project.cls_customers
2021-06-16 07:51:52.197543 (Thread-1): Writing injected SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:51:52.197910 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.223989 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.224188 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:51:52.224308 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:51:52.224407 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.236002 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:52.242455 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.242588 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 07:51:52.244896 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:51:52.245905 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.246040 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.246146 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.247108 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.247254 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.247360 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:51:52.248258 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.248419 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.248521 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.248621 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.249517 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.249641 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.249739 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:51:52.250691 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.252343 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.252467 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:51:52.253490 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:51:52.254398 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.254524 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.254631 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.255589 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.255724 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.255824 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:51:52.256720 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.263423 (Thread-1): Writing runtime SQL for node "model.my_new_project.cls_customers"
2021-06-16 07:51:52.263807 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.263925 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(m."CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:51:52.266108 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:51:52.273694 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.273828 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:51:52.275508 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:51:52.286600 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.286736 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.286840 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.289543 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.291894 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.292021 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:51:52.296064 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.297794 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.297921 (Thread-1): On model.my_new_project.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:51:52.299916 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:51:52.300932 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.301059 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.301165 (Thread-1): On model.my_new_project.cls_customers: COMMIT
2021-06-16 07:51:52.302122 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.302263 (Thread-1): Using redshift connection "model.my_new_project.cls_customers".
2021-06-16 07:51:52.302376 (Thread-1): On model.my_new_project.cls_customers: BEGIN
2021-06-16 07:51:52.303282 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.303868 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.304036 (Thread-1): On model.my_new_project.cls_customers: ROLLBACK
2021-06-16 07:51:52.304930 (Thread-1): On model.my_new_project.cls_customers: Close
2021-06-16 07:51:52.305481 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e9ce66-091f-40de-a809-5dd6481483dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8829c910>]}
2021-06-16 07:51:52.305944 (Thread-1): 07:51:52 | 1 of 4 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 07:51:52.306269 (Thread-1): Finished running node model.my_new_project.cls_customers
2021-06-16 07:51:52.306464 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-06-16 07:51:52.306973 (Thread-1): 07:51:52 | 2 of 4 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:51:52.307414 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.307561 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-06-16 07:51:52.310710 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:51:52.311085 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.332350 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.332555 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:51:52.332679 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:51:52.332777 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.346268 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:52.348475 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.348617 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:51:52.350613 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:51:52.351691 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.351822 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.351931 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.356361 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.356504 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.356613 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:51:52.357520 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.357691 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.357793 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.357893 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.359374 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.359502 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.359599 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:51:52.361274 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.363029 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.363158 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:51:52.364370 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:51:52.365319 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.365445 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.365551 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.366568 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.366708 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.366812 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:51:52.367838 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.386762 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-06-16 07:51:52.387254 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.387393 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:51:52.389269 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:51:52.392210 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.392371 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:51:52.393560 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:51:52.396203 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.396332 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:51:52.397398 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:51:52.398648 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.398773 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.398899 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.400596 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.400857 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.400968 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:51:52.401894 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.403679 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.403807 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:51:52.405262 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:51:52.406138 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.406264 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.406385 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2021-06-16 07:51:52.409400 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.409544 (Thread-1): Using redshift connection "model.my_new_project.my_first_dbt_model".
2021-06-16 07:51:52.409648 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2021-06-16 07:51:52.411289 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.411823 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.411990 (Thread-1): On model.my_new_project.my_first_dbt_model: ROLLBACK
2021-06-16 07:51:52.412934 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-06-16 07:51:52.413488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e9ce66-091f-40de-a809-5dd6481483dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8829bd10>]}
2021-06-16 07:51:52.413961 (Thread-1): 07:51:52 | 2 of 4 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.11s]
2021-06-16 07:51:52.414257 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-06-16 07:51:52.414461 (Thread-1): Began running node model.my_new_project.dim_customers
2021-06-16 07:51:52.414959 (Thread-1): 07:51:52 | 3 of 4 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 07:51:52.415399 (Thread-1): Acquiring new redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.415551 (Thread-1): Compiling model.my_new_project.dim_customers
2021-06-16 07:51:52.418484 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-06-16 07:51:52.418835 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.420874 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.421008 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:51:52.421126 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:51:52.421235 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.433194 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:52.435107 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.435243 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 07:51:52.436286 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:51:52.437292 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.437418 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.437543 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.438488 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.438624 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.438738 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:51:52.439663 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.439844 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.439947 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.440041 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.440955 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.441082 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.441178 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:51:52.442063 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.443889 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.444017 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 07:51:52.444984 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:51:52.445928 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.446057 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.446167 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.447078 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.447232 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.447343 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:51:52.448414 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.449453 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-06-16 07:51:52.449834 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.449961 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 07:51:52.454928 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 07:51:52.457538 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.457667 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 07:51:52.458748 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:51:52.460240 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.460371 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.460478 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.462574 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.462830 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.462965 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:51:52.464132 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.465722 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.465849 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 07:51:52.466950 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:51:52.467872 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.468002 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.468119 (Thread-1): On model.my_new_project.dim_customers: COMMIT
2021-06-16 07:51:52.470260 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.470408 (Thread-1): Using redshift connection "model.my_new_project.dim_customers".
2021-06-16 07:51:52.470514 (Thread-1): On model.my_new_project.dim_customers: BEGIN
2021-06-16 07:51:52.475633 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:51:52.476251 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.476440 (Thread-1): On model.my_new_project.dim_customers: ROLLBACK
2021-06-16 07:51:52.481398 (Thread-1): On model.my_new_project.dim_customers: Close
2021-06-16 07:51:52.481940 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e9ce66-091f-40de-a809-5dd6481483dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec893d1850>]}
2021-06-16 07:51:52.482339 (Thread-1): 07:51:52 | 3 of 4 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.07s]
2021-06-16 07:51:52.482631 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-06-16 07:51:52.482822 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-06-16 07:51:52.483221 (Thread-1): 07:51:52 | 4 of 4 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:51:52.483618 (Thread-1): Acquiring new redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.483763 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-06-16 07:51:52.487041 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:51:52.487467 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.489542 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.489670 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:51:52.489781 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:51:52.489881 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.513448 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:51:52.515535 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.515676 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:51:52.516749 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:51:52.517786 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.517921 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.518028 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.519371 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.519512 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.519615 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:51:52.520624 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.520787 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.520888 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.520980 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.522027 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.522154 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.522248 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:51:52.523189 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.524986 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.525110 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:51:52.526119 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:51:52.527052 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.527185 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.527305 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.528204 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.528339 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.528450 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:51:52.529368 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.530033 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-06-16 07:51:52.530424 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.530543 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:51:52.532360 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:51:52.536216 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.536352 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:51:52.537430 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:51:52.538655 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.538777 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.538905 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.540668 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.540915 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.541022 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:51:52.541923 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.543519 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.543647 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:51:52.544685 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:51:52.592327 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.592518 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.592633 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2021-06-16 07:51:52.594791 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.594951 (Thread-1): Using redshift connection "model.my_new_project.my_second_dbt_model".
2021-06-16 07:51:52.595060 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2021-06-16 07:51:52.595984 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:51:52.596576 (Thread-1): finished collecting timing info
2021-06-16 07:51:52.596757 (Thread-1): On model.my_new_project.my_second_dbt_model: ROLLBACK
2021-06-16 07:51:52.597761 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-06-16 07:51:52.598316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e9ce66-091f-40de-a809-5dd6481483dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec893f17d0>]}
2021-06-16 07:51:52.598755 (Thread-1): 07:51:52 | 4 of 4 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.11s]
2021-06-16 07:51:52.599061 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-06-16 07:51:52.693690 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:51:52.693973 (MainThread): Using redshift connection "master".
2021-06-16 07:51:52.694088 (MainThread): On master: BEGIN
2021-06-16 07:51:52.694198 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:51:52.694293 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:51:52.711256 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:51:52.711436 (MainThread): On master: COMMIT
2021-06-16 07:51:52.711548 (MainThread): Using redshift connection "master".
2021-06-16 07:51:52.711649 (MainThread): On master: COMMIT
2021-06-16 07:51:52.712677 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:51:52.712818 (MainThread): On master: Close
2021-06-16 07:51:52.713355 (MainThread): 07:51:52 | 
2021-06-16 07:51:52.713627 (MainThread): 07:51:52 | Finished running 2 view models, 2 table models in 0.89s.
2021-06-16 07:51:52.713935 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:51:52.714045 (MainThread): Connection 'create_postgres_sifa_core' was properly closed.
2021-06-16 07:51:52.714139 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-06-16 07:51:52.719288 (MainThread): 
2021-06-16 07:51:52.719535 (MainThread): Completed successfully
2021-06-16 07:51:52.719783 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-16 07:51:52.720139 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8cbc22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec89869650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec898694d0>]}
2021-06-16 07:51:52.720382 (MainThread): Flushing usage events
2021-06-16 07:54:25.037856 (MainThread): Running with dbt=0.19.1
2021-06-16 07:54:25.277738 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:54:25.278212 (MainThread): Tracking: tracking
2021-06-16 07:54:25.283886 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8673ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8934b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8934b310>]}
2021-06-16 07:54:25.304092 (MainThread): Partial parsing not enabled
2021-06-16 07:54:25.305260 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:54:25.345349 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:54:25.364108 (MainThread): Parsing macros/relations.sql
2021-06-16 07:54:25.365042 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:54:25.366364 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:54:25.396803 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:54:25.400375 (MainThread): Parsing macros/relations.sql
2021-06-16 07:54:25.402434 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:54:25.406114 (MainThread): Parsing macros/core.sql
2021-06-16 07:54:25.412206 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:54:25.479739 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:54:25.493563 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:54:25.495055 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:54:25.497710 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:54:25.500784 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:54:25.503262 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:54:25.504919 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:54:25.519206 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:54:25.540539 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:54:25.543438 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:54:25.553406 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:54:25.585756 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:54:25.631283 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:54:25.634051 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:54:25.662420 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:54:25.672919 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:54:25.680917 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:54:25.690598 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:54:25.694842 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:54:25.697352 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:54:25.700279 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:54:25.710966 (MainThread): Partial parsing not enabled
2021-06-16 07:54:25.749555 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:25.764868 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:25.770570 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:25.774982 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:54:25.777058 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:25.780601 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:54:25.936295 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7911607c-91f0-43f0-869a-31390ab7fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f865261d0>]}
2021-06-16 07:54:25.942093 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7911607c-91f0-43f0-869a-31390ab7fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f866f6b90>]}
2021-06-16 07:54:25.942369 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:54:25.943814 (MainThread): 
2021-06-16 07:54:25.944313 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:54:25.945629 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:54:25.961101 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:54:25.961235 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:54:25.961350 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:54:25.961448 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:25.982367 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 07:54:25.985531 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:54:25.986214 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:54:25.988274 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:54:25.988404 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:54:25.988518 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:54:25.988616 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:25.999941 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 07:54:26.000635 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:54:26.001237 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:54:26.003081 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:54:26.003211 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:54:26.003333 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:54:26.003430 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.015083 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 07:54:26.015678 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:54:26.017978 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:54:26.028878 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:54:26.029012 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:54:26.029126 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:54:26.029222 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.040224 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.040369 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:54:26.040481 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:54:26.043079 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 07:54:26.043824 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:54:26.044734 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:54:26.045335 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:54:26.047524 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:54:26.047658 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 07:54:26.047775 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:54:26.047887 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.058924 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.059073 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:54:26.059187 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 07:54:26.061836 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:54:26.062429 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 07:54:26.063365 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 07:54:26.063978 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 07:54:26.065992 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:54:26.066122 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 07:54:26.066237 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:54:26.066348 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.077392 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.077557 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:54:26.077672 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 07:54:26.080300 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:54:26.080922 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 07:54:26.081883 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 07:54:26.088333 (MainThread): Using redshift connection "master".
2021-06-16 07:54:26.088476 (MainThread): On master: BEGIN
2021-06-16 07:54:26.088603 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:54:26.088701 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.099810 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.099957 (MainThread): Using redshift connection "master".
2021-06-16 07:54:26.100071 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:54:26.223890 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 07:54:26.225027 (MainThread): On master: ROLLBACK
2021-06-16 07:54:26.226018 (MainThread): Using redshift connection "master".
2021-06-16 07:54:26.226142 (MainThread): On master: BEGIN
2021-06-16 07:54:26.227861 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.227999 (MainThread): On master: COMMIT
2021-06-16 07:54:26.228116 (MainThread): Using redshift connection "master".
2021-06-16 07:54:26.228219 (MainThread): On master: COMMIT
2021-06-16 07:54:26.229130 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.229282 (MainThread): On master: Close
2021-06-16 07:54:26.229861 (MainThread): 07:54:26 | Concurrency: 1 threads (target='dev')
2021-06-16 07:54:26.230194 (MainThread): 07:54:26 | 
2021-06-16 07:54:26.232176 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 07:54:26.232513 (Thread-1): 07:54:26 | 1 of 4 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 07:54:26.232855 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.233021 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 07:54:26.237144 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 07:54:26.237567 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.263976 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.264148 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:54:26.264284 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:54:26.264385 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.275781 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.281949 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.282089 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 07:54:26.283218 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:54:26.284366 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.284501 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.284616 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.285574 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.285717 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.285824 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:54:26.286738 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.286934 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.287050 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.287150 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.288054 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.288196 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.288297 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:54:26.289196 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.290859 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.291023 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:54:26.292049 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:54:26.292967 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.293108 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.293221 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.294142 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.294283 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.294389 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:54:26.295312 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.302127 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 07:54:26.302570 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.302692 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(m."CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:54:26.304791 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:54:26.313087 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.313244 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:54:26.314431 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:54:26.317084 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.317217 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:54:26.318353 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:54:26.329948 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.330115 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.330224 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.332234 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.334811 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.334968 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:54:26.335904 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.337742 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.337867 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:54:26.339261 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:54:26.340206 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.340332 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.340442 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:54:26.342021 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.342160 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:54:26.342263 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:54:26.343201 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.343769 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.343950 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 07:54:26.344869 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 07:54:26.345429 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7911607c-91f0-43f0-869a-31390ab7fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f86308890>]}
2021-06-16 07:54:26.345888 (Thread-1): 07:54:26 | 1 of 4 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 07:54:26.346175 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 07:54:26.346364 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 07:54:26.346816 (Thread-1): 07:54:26 | 2 of 4 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 07:54:26.347263 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.347413 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 07:54:26.350287 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 07:54:26.350617 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.370539 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.370702 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 07:54:26.370828 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:54:26.370958 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.382309 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.385367 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.385508 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 07:54:26.386522 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:54:26.387516 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.387649 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.387757 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.388735 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.388921 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.389043 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 07:54:26.389946 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.390121 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.390232 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.390333 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.391222 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.391360 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.391463 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 07:54:26.392341 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.393995 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.394127 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:54:26.395096 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:54:26.395996 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.396132 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.396240 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.397150 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.397290 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.397394 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 07:54:26.398275 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.417314 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 07:54:26.417716 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.417838 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 07:54:26.419627 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 07:54:26.422216 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.422343 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 07:54:26.423440 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:54:26.426029 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.426160 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 07:54:26.427181 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:54:26.428426 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.428558 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.428667 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.430502 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.430788 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.430921 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 07:54:26.431860 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.433605 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.433769 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 07:54:26.435171 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:54:26.436044 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.436180 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.436296 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 07:54:26.439107 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.439252 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:54:26.439357 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 07:54:26.440256 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.440787 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.440964 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 07:54:26.441860 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 07:54:26.442430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7911607c-91f0-43f0-869a-31390ab7fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f866ea290>]}
2021-06-16 07:54:26.442906 (Thread-1): 07:54:26 | 2 of 4 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.10s]
2021-06-16 07:54:26.443216 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 07:54:26.443418 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 07:54:26.443875 (Thread-1): 07:54:26 | 3 of 4 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 07:54:26.444304 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.444457 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 07:54:26.447288 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 07:54:26.447622 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.449600 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.449744 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:54:26.449878 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:54:26.449980 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.461149 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.462999 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.463133 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 07:54:26.464162 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:54:26.465178 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.465311 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.465426 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.466357 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.466511 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.466629 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:54:26.467552 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.467739 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.467848 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.467946 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.468851 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.468983 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.469084 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:54:26.469970 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.471636 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.471777 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 07:54:26.472896 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:54:26.473834 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.473966 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.474078 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.474978 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.475126 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.475234 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:54:26.476125 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.477200 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 07:54:26.477591 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.477719 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 07:54:26.482598 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 07:54:26.485377 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.485517 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 07:54:26.486631 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:54:26.489256 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.489398 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 07:54:26.490471 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:54:26.491755 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.491885 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.491991 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.493609 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.493871 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.493981 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:54:26.494882 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.496670 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.496795 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 07:54:26.498199 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:54:26.499119 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.499253 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.499381 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:54:26.502420 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.502556 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:54:26.502659 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:54:26.503554 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.504083 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.504258 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 07:54:26.505168 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 07:54:26.505743 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7911607c-91f0-43f0-869a-31390ab7fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8626d7d0>]}
2021-06-16 07:54:26.506194 (Thread-1): 07:54:26 | 3 of 4 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.06s]
2021-06-16 07:54:26.506498 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 07:54:26.506694 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 07:54:26.507197 (Thread-1): 07:54:26 | 4 of 4 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 07:54:26.507671 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.507829 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 07:54:26.511053 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 07:54:26.511362 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.513214 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.513355 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 07:54:26.513487 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:54:26.513592 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.524635 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.526450 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.526593 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 07:54:26.527655 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:54:26.528631 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.528759 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.528868 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.529757 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.529898 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.530002 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 07:54:26.530916 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.531109 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.531216 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.531313 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.532250 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.532383 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.532483 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 07:54:26.533334 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.535165 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.535348 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:54:26.536373 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:54:26.537306 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.537446 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.537559 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.538506 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.538644 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.538755 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 07:54:26.539813 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.540507 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 07:54:26.540841 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.540963 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 07:54:26.542744 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:54:26.546813 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.546987 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 07:54:26.548073 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:54:26.549309 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.549443 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.549549 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.551049 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.551315 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.551427 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 07:54:26.552332 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.553905 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.554036 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 07:54:26.555016 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:54:26.555937 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.556079 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.556192 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 07:54:26.557080 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.557227 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:54:26.557342 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 07:54:26.558243 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:54:26.558772 (Thread-1): finished collecting timing info
2021-06-16 07:54:26.558961 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 07:54:26.559865 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 07:54:26.560411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7911607c-91f0-43f0-869a-31390ab7fdfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8476b810>]}
2021-06-16 07:54:26.560856 (Thread-1): 07:54:26 | 4 of 4 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 07:54:26.561142 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 07:54:26.636184 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:54:26.636460 (MainThread): Using redshift connection "master".
2021-06-16 07:54:26.636574 (MainThread): On master: BEGIN
2021-06-16 07:54:26.636698 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:54:26.636797 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:54:26.648284 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:54:26.648454 (MainThread): On master: COMMIT
2021-06-16 07:54:26.648573 (MainThread): Using redshift connection "master".
2021-06-16 07:54:26.648680 (MainThread): On master: COMMIT
2021-06-16 07:54:26.649564 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:54:26.649711 (MainThread): On master: Close
2021-06-16 07:54:26.650238 (MainThread): 07:54:26 | 
2021-06-16 07:54:26.650548 (MainThread): 07:54:26 | Finished running 2 view models, 2 table models in 0.71s.
2021-06-16 07:54:26.650801 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:54:26.650943 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:54:26.651050 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 07:54:26.703790 (MainThread): 
2021-06-16 07:54:26.704145 (MainThread): Completed successfully
2021-06-16 07:54:26.704425 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-16 07:54:26.704799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8676cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8676ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f8676cc90>]}
2021-06-16 07:54:26.705060 (MainThread): Flushing usage events
2021-06-16 07:55:44.774906 (MainThread): Running with dbt=0.19.1
2021-06-16 07:55:45.015169 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:55:45.015684 (MainThread): Tracking: tracking
2021-06-16 07:55:45.021452 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9731cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaac38f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa96c3590>]}
2021-06-16 07:55:45.041958 (MainThread): Partial parsing not enabled
2021-06-16 07:55:45.043194 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:55:45.083613 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:55:45.102664 (MainThread): Parsing macros/relations.sql
2021-06-16 07:55:45.103708 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:55:45.105086 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:55:45.135861 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:55:45.139461 (MainThread): Parsing macros/relations.sql
2021-06-16 07:55:45.141464 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:55:45.145194 (MainThread): Parsing macros/core.sql
2021-06-16 07:55:45.151479 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:55:45.218021 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:55:45.232046 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:55:45.233582 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:55:45.236268 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:55:45.239333 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:55:45.241842 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:55:45.243513 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:55:45.257654 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:55:45.278853 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:55:45.281744 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:55:45.291525 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:55:45.323458 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:55:45.368593 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:55:45.371367 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:55:45.399253 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:55:45.409757 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:55:45.417788 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:55:45.427394 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:55:45.431605 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:55:45.433974 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:55:45.436909 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:55:45.447681 (MainThread): Partial parsing not enabled
2021-06-16 07:55:45.487599 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:55:45.503138 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:55:45.509188 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:45.513803 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:55:45.515997 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:55:45.519654 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:55:45.678407 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6200dc4-78dd-4998-b685-bd6549844c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9517c10>]}
2021-06-16 07:55:45.684499 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6200dc4-78dd-4998-b685-bd6549844c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9519110>]}
2021-06-16 07:55:45.684884 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:55:45.686147 (MainThread): 
2021-06-16 07:55:45.686653 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:55:45.687620 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:55:45.702865 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:55:45.703055 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:55:45.703172 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:55:45.703273 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:55:45.725957 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 07:55:45.729295 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:55:45.731483 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 07:55:45.741326 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:55:45.741478 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 07:55:45.741593 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:55:45.741687 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:55:45.752983 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:55:45.753137 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:55:45.753252 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 07:55:45.755946 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:55:45.756645 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 07:55:45.757569 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 07:55:45.758231 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:55:45.761408 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:55:45.761554 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 07:55:45.761669 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:55:45.761765 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:55:45.772674 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:55:45.772884 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:55:45.773001 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 07:55:45.775576 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:55:45.776350 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 07:55:45.777239 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 07:55:45.777930 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:55:45.779987 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:55:45.780119 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:55:45.780232 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:55:45.780326 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:55:45.791054 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:55:45.791218 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:55:45.791327 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:55:45.793950 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 07:55:45.794741 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:55:45.795631 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:55:45.802148 (MainThread): Using redshift connection "master".
2021-06-16 07:55:45.802285 (MainThread): On master: BEGIN
2021-06-16 07:55:45.802398 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:55:45.802495 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:55:45.814394 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:55:45.814545 (MainThread): Using redshift connection "master".
2021-06-16 07:55:45.814655 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:55:45.936875 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 07:55:45.938018 (MainThread): On master: ROLLBACK
2021-06-16 07:55:45.939059 (MainThread): Using redshift connection "master".
2021-06-16 07:55:45.939180 (MainThread): On master: BEGIN
2021-06-16 07:55:45.940927 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:55:45.941063 (MainThread): On master: COMMIT
2021-06-16 07:55:45.941176 (MainThread): Using redshift connection "master".
2021-06-16 07:55:45.941275 (MainThread): On master: COMMIT
2021-06-16 07:55:45.942223 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:55:45.942367 (MainThread): On master: Close
2021-06-16 07:55:45.942971 (MainThread): 07:55:45 | Concurrency: 1 threads (target='dev')
2021-06-16 07:55:45.943304 (MainThread): 07:55:45 | 
2021-06-16 07:55:45.944951 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 07:55:45.945325 (Thread-1): 07:55:45 | 1 of 1 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 07:55:45.945690 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:45.945857 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 07:55:45.950057 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 07:55:45.950444 (Thread-1): finished collecting timing info
2021-06-16 07:55:45.976516 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:45.976710 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:55:45.976828 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:55:45.976937 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:55:45.988605 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:55:45.995224 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:45.995377 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 07:55:45.996509 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:55:45.997646 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:45.997777 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:45.997885 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:45.998790 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:55:45.998955 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:45.999064 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:55:45.999976 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:55:46.000136 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.000237 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.000330 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.001219 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:55:46.001344 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.001438 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:55:46.002392 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:55:46.004182 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.004315 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:55:46.005408 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:55:46.006365 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.006509 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.006615 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.007572 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:55:46.007716 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.007829 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:55:46.008725 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:55:46.015624 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 07:55:46.016030 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.016155 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(m."CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:55:46.018591 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:55:46.026572 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.026712 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:55:46.027948 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:55:46.030525 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.030650 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:55:46.031702 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:55:46.042988 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.043174 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.043281 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.045258 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:55:46.047853 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.047989 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:55:46.048984 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:55:46.050960 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.051091 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:55:46.052513 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:55:46.053546 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.053677 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.053785 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:55:46.055405 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:55:46.055549 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:55:46.055664 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:55:46.056583 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:55:46.057186 (Thread-1): finished collecting timing info
2021-06-16 07:55:46.057373 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 07:55:46.058291 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 07:55:46.058854 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6200dc4-78dd-4998-b685-bd6549844c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa92ce710>]}
2021-06-16 07:55:46.059339 (Thread-1): 07:55:46 | 1 of 1 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 07:55:46.059629 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 07:55:46.145700 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:55:46.145961 (MainThread): Using redshift connection "master".
2021-06-16 07:55:46.146075 (MainThread): On master: BEGIN
2021-06-16 07:55:46.146186 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:55:46.146282 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:55:46.157920 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:55:46.158098 (MainThread): On master: COMMIT
2021-06-16 07:55:46.158214 (MainThread): Using redshift connection "master".
2021-06-16 07:55:46.158330 (MainThread): On master: COMMIT
2021-06-16 07:55:46.159195 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:55:46.159346 (MainThread): On master: Close
2021-06-16 07:55:46.159845 (MainThread): 07:55:46 | 
2021-06-16 07:55:46.160134 (MainThread): 07:55:46 | Finished running 1 view model in 0.47s.
2021-06-16 07:55:46.160409 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:55:46.160517 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:55:46.160610 (MainThread): Connection 'model.dbtintro_northwind.cls_customers' was properly closed.
2021-06-16 07:55:46.165710 (MainThread): 
2021-06-16 07:55:46.165967 (MainThread): Completed successfully
2021-06-16 07:55:46.166210 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-16 07:55:46.166576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa9423e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa93d3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaac319450>]}
2021-06-16 07:55:46.166865 (MainThread): Flushing usage events
2021-06-16 07:56:10.235974 (MainThread): Running with dbt=0.19.1
2021-06-16 07:56:10.479229 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 07:56:10.479719 (MainThread): Tracking: tracking
2021-06-16 07:56:10.485598 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2804df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2ac04710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a28034890>]}
2021-06-16 07:56:10.506232 (MainThread): Partial parsing not enabled
2021-06-16 07:56:10.507524 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:56:10.547989 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:56:10.567207 (MainThread): Parsing macros/relations.sql
2021-06-16 07:56:10.568211 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:56:10.569512 (MainThread): Parsing macros/adapters.sql
2021-06-16 07:56:10.599944 (MainThread): Parsing macros/catalog.sql
2021-06-16 07:56:10.603397 (MainThread): Parsing macros/relations.sql
2021-06-16 07:56:10.605410 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 07:56:10.609233 (MainThread): Parsing macros/core.sql
2021-06-16 07:56:10.615389 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 07:56:10.681264 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 07:56:10.695021 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 07:56:10.696576 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 07:56:10.699173 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 07:56:10.702126 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 07:56:10.704649 (MainThread): Parsing macros/etc/query.sql
2021-06-16 07:56:10.706306 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 07:56:10.720308 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 07:56:10.741859 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 07:56:10.744822 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 07:56:10.755070 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 07:56:10.787249 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 07:56:10.832331 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 07:56:10.835120 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 07:56:10.863008 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 07:56:10.873315 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 07:56:10.881129 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 07:56:10.890536 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 07:56:10.894729 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 07:56:10.897158 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 07:56:10.900171 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 07:56:10.910757 (MainThread): Partial parsing not enabled
2021-06-16 07:56:10.950423 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 07:56:10.965723 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 07:56:10.971623 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:10.976125 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:56:10.978319 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:10.982597 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 07:56:11.142564 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14d685b0-21bb-4531-aaff-b510e4f087c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27e53610>]}
2021-06-16 07:56:11.148688 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14d685b0-21bb-4531-aaff-b510e4f087c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27f75f90>]}
2021-06-16 07:56:11.148992 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 07:56:11.150253 (MainThread): 
2021-06-16 07:56:11.150738 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:56:11.151836 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:56:11.167348 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:56:11.167513 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:56:11.167633 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 07:56:11.167735 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.213120 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.05 seconds
2021-06-16 07:56:11.216527 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:56:11.217158 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 07:56:11.219250 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 07:56:11.219380 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 07:56:11.219495 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 07:56:11.219592 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.231644 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 07:56:11.232199 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 07:56:11.234453 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 07:56:11.244384 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:56:11.244527 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 07:56:11.244643 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 07:56:11.244741 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.256332 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:56:11.256492 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 07:56:11.256603 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 07:56:11.259216 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 07:56:11.259981 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 07:56:11.260930 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 07:56:11.261564 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 07:56:11.264829 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:56:11.264966 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 07:56:11.265078 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:56:11.265172 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.278955 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:56:11.279123 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 07:56:11.279236 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 07:56:11.281866 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:56:11.282556 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 07:56:11.283495 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 07:56:11.284148 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:56:11.286228 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:56:11.286354 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 07:56:11.286465 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 07:56:11.286560 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.298349 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:56:11.298503 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 07:56:11.298616 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 07:56:11.301259 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 07:56:11.301960 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 07:56:11.302915 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 07:56:11.309421 (MainThread): Using redshift connection "master".
2021-06-16 07:56:11.309595 (MainThread): On master: BEGIN
2021-06-16 07:56:11.309712 (MainThread): Opening a new connection, currently in state init
2021-06-16 07:56:11.309817 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.324302 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:56:11.324484 (MainThread): Using redshift connection "master".
2021-06-16 07:56:11.324596 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 07:56:11.447098 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 07:56:11.448186 (MainThread): On master: ROLLBACK
2021-06-16 07:56:11.449369 (MainThread): Using redshift connection "master".
2021-06-16 07:56:11.449490 (MainThread): On master: BEGIN
2021-06-16 07:56:11.451323 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.451462 (MainThread): On master: COMMIT
2021-06-16 07:56:11.451570 (MainThread): Using redshift connection "master".
2021-06-16 07:56:11.451667 (MainThread): On master: COMMIT
2021-06-16 07:56:11.452574 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.452719 (MainThread): On master: Close
2021-06-16 07:56:11.453270 (MainThread): 07:56:11 | Concurrency: 1 threads (target='dev')
2021-06-16 07:56:11.453616 (MainThread): 07:56:11 | 
2021-06-16 07:56:11.455626 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 07:56:11.455958 (Thread-1): 07:56:11 | 1 of 2 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 07:56:11.456305 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.456469 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 07:56:11.460568 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 07:56:11.460941 (Thread-1): finished collecting timing info
2021-06-16 07:56:11.487045 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.487257 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:56:11.487378 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:56:11.487478 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.499287 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:56:11.505892 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.506051 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 07:56:11.507127 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:56:11.508254 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.508382 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.508489 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.509405 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.509542 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.509644 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:56:11.510561 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.510731 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.510844 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.510978 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.511881 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.512016 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.512115 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:56:11.513009 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.514737 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.514861 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:56:11.515873 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:56:11.516750 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.516875 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.516980 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.518850 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.519012 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.519117 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:56:11.520494 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.527451 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 07:56:11.527846 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.527971 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    




select m.*
    , CAST(m."CustomerID" as varchar(12))                   as customer_id
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 07:56:11.530025 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 07:56:11.537799 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.537945 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 07:56:11.539099 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:56:11.541649 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.541776 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 07:56:11.542863 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:56:11.554059 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.554206 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.554316 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.556006 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.558511 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.558639 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:56:11.559608 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.561507 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.561641 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 07:56:11.563002 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 07:56:11.564021 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.564154 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.564265 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 07:56:11.565944 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.566082 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 07:56:11.566189 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 07:56:11.567137 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.567719 (Thread-1): finished collecting timing info
2021-06-16 07:56:11.567893 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 07:56:11.568814 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 07:56:11.569375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d685b0-21bb-4531-aaff-b510e4f087c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27c68e10>]}
2021-06-16 07:56:11.569831 (Thread-1): 07:56:11 | 1 of 2 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 07:56:11.570136 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 07:56:11.570517 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 07:56:11.570796 (Thread-1): 07:56:11 | 2 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 07:56:11.571270 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.571422 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 07:56:11.574826 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 07:56:11.575211 (Thread-1): finished collecting timing info
2021-06-16 07:56:11.595472 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.595663 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:56:11.595784 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 07:56:11.595884 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.607316 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 07:56:11.609194 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.609331 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 07:56:11.610384 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:56:11.611407 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.611539 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.611647 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.612567 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.612701 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.612802 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:56:11.613699 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.613868 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.613974 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.614080 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.614983 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.615114 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.615209 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:56:11.616121 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.617904 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.618033 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 07:56:11.619062 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:56:11.619955 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.620091 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.620196 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.621105 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.621238 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.621345 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:56:11.622228 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.643057 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 07:56:11.643557 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.643689 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 07:56:11.648860 (Thread-1): SQL status: SELECT 91 in 0.01 seconds
2021-06-16 07:56:11.651770 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.651902 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 07:56:11.653047 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:56:11.655801 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.655979 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 07:56:11.657040 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 07:56:11.658332 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.658459 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.658565 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.660287 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.660561 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.660674 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:56:11.661584 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.663485 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.663617 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 07:56:11.665095 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 07:56:11.666055 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.666189 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.666298 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 07:56:11.669220 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.669384 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 07:56:11.669494 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 07:56:11.670404 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 07:56:11.671010 (Thread-1): finished collecting timing info
2021-06-16 07:56:11.671187 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 07:56:11.672114 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 07:56:11.672676 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d685b0-21bb-4531-aaff-b510e4f087c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a24ccd250>]}
2021-06-16 07:56:11.673145 (Thread-1): 07:56:11 | 2 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.10s]
2021-06-16 07:56:11.673466 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 07:56:11.756857 (MainThread): Acquiring new redshift connection "master".
2021-06-16 07:56:11.757120 (MainThread): Using redshift connection "master".
2021-06-16 07:56:11.757238 (MainThread): On master: BEGIN
2021-06-16 07:56:11.757360 (MainThread): Opening a new connection, currently in state closed
2021-06-16 07:56:11.757459 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 07:56:11.776527 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 07:56:11.776716 (MainThread): On master: COMMIT
2021-06-16 07:56:11.776830 (MainThread): Using redshift connection "master".
2021-06-16 07:56:11.776936 (MainThread): On master: COMMIT
2021-06-16 07:56:11.777876 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 07:56:11.778021 (MainThread): On master: Close
2021-06-16 07:56:11.778530 (MainThread): 07:56:11 | 
2021-06-16 07:56:11.778811 (MainThread): 07:56:11 | Finished running 1 view model, 1 table model in 0.63s.
2021-06-16 07:56:11.779139 (MainThread): Connection 'master' was properly closed.
2021-06-16 07:56:11.779252 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 07:56:11.779346 (MainThread): Connection 'model.dbtintro_northwind.dim_customers' was properly closed.
2021-06-16 07:56:11.784495 (MainThread): 
2021-06-16 07:56:11.784761 (MainThread): Completed successfully
2021-06-16 07:56:11.785002 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 07:56:11.785380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27c5cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a27d08150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a24cc2d90>]}
2021-06-16 07:56:11.785629 (MainThread): Flushing usage events
2021-06-16 08:01:31.154681 (MainThread): Running with dbt=0.19.1
2021-06-16 08:01:31.393124 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:01:31.393629 (MainThread): Tracking: tracking
2021-06-16 08:01:31.399354 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4277b4ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427ddfef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4277adf590>]}
2021-06-16 08:01:31.419296 (MainThread): Partial parsing not enabled
2021-06-16 08:01:31.420471 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:01:31.459768 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:01:31.478128 (MainThread): Parsing macros/relations.sql
2021-06-16 08:01:31.479062 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:01:31.480358 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:01:31.510067 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:01:31.513406 (MainThread): Parsing macros/relations.sql
2021-06-16 08:01:31.515374 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:01:31.518985 (MainThread): Parsing macros/core.sql
2021-06-16 08:01:31.524843 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:01:31.589513 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:01:31.602921 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:01:31.604378 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:01:31.606972 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:01:31.609936 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:01:31.612375 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:01:31.613970 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:01:31.627894 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:01:31.648818 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:01:31.651703 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:01:31.661437 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:01:31.692999 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:01:31.740944 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:01:31.743655 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:01:31.770868 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:01:31.780941 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:01:31.788574 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:01:31.797916 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:01:31.801951 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:01:31.804287 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:01:31.807198 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:01:31.817822 (MainThread): Partial parsing not enabled
2021-06-16 08:01:31.855970 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:01:31.870981 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:01:31.876722 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:31.881262 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:01:31.883408 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:31.887618 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:01:32.041267 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec09b0d0-eea3-4019-8416-cd1a05bcd9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42776a3a50>]}
2021-06-16 08:01:32.047088 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec09b0d0-eea3-4019-8416-cd1a05bcd9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4277991550>]}
2021-06-16 08:01:32.047382 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:01:32.048651 (MainThread): 
2021-06-16 08:01:32.049120 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:01:32.050129 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:01:32.065364 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:01:32.065546 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:01:32.065659 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:01:32.065761 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.090434 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:01:32.093866 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:01:32.094611 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:01:32.096626 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:01:32.096768 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:01:32.096882 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:01:32.096976 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.108763 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:01:32.109391 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:01:32.111736 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:01:32.121678 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:01:32.121820 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:01:32.121930 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:01:32.122022 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.133409 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:01:32.133592 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:01:32.133715 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:01:32.136414 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:01:32.137182 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:01:32.138139 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:01:32.138793 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:01:32.141894 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:01:32.142018 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:01:32.142133 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:01:32.142226 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.153194 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:01:32.153351 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:01:32.153463 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:01:32.156071 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:01:32.156690 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:01:32.157678 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:01:32.158274 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:01:32.160190 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:01:32.160317 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:01:32.160424 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:01:32.160515 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.171214 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:01:32.171369 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:01:32.171477 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:01:32.173965 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:01:32.174666 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:01:32.175622 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:01:32.181819 (MainThread): Using redshift connection "master".
2021-06-16 08:01:32.181949 (MainThread): On master: BEGIN
2021-06-16 08:01:32.182055 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:01:32.182146 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.193654 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:01:32.193796 (MainThread): Using redshift connection "master".
2021-06-16 08:01:32.193905 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:01:32.318271 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:01:32.319385 (MainThread): On master: ROLLBACK
2021-06-16 08:01:32.320400 (MainThread): Using redshift connection "master".
2021-06-16 08:01:32.320523 (MainThread): On master: BEGIN
2021-06-16 08:01:32.322308 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.322439 (MainThread): On master: COMMIT
2021-06-16 08:01:32.322549 (MainThread): Using redshift connection "master".
2021-06-16 08:01:32.322643 (MainThread): On master: COMMIT
2021-06-16 08:01:32.323570 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.323712 (MainThread): On master: Close
2021-06-16 08:01:32.324256 (MainThread): 08:01:32 | Concurrency: 1 threads (target='dev')
2021-06-16 08:01:32.324538 (MainThread): 08:01:32 | 
2021-06-16 08:01:32.328532 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:01:32.328869 (Thread-1): 08:01:32 | 1 of 2 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:01:32.329214 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.329372 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:01:32.333425 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:01:32.333783 (Thread-1): finished collecting timing info
2021-06-16 08:01:32.359338 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.359519 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:01:32.359632 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:01:32.359724 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.371096 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:01:32.377259 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.377394 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:01:32.378556 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:01:32.379727 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.379868 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.379976 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.380912 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.381046 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.381151 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:01:32.382064 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.382225 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.382323 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.382413 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.383390 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.383520 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.383614 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:01:32.384550 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.386129 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.386249 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:01:32.387300 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:01:32.388160 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.388283 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.388385 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.389301 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.389433 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.389529 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:01:32.390425 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.397229 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:01:32.397617 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.397734 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    




select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:01:32.399986 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:01:32.407811 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.407960 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:01:32.409127 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:01:32.411747 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.411881 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:01:32.412965 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:01:32.424110 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.424260 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.424364 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.426715 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.429140 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.429305 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:01:32.430246 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.432206 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.432337 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:01:32.433721 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:01:32.434761 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.434918 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.435030 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:01:32.436588 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.436718 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:01:32.436816 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:01:32.437739 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.438274 (Thread-1): finished collecting timing info
2021-06-16 08:01:32.438439 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:01:32.439358 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:01:32.439909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec09b0d0-eea3-4019-8416-cd1a05bcd9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427766a510>]}
2021-06-16 08:01:32.440354 (Thread-1): 08:01:32 | 1 of 2 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 08:01:32.440639 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:01:32.441003 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:01:32.441268 (Thread-1): 08:01:32 | 2 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:01:32.441669 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.441811 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:01:32.445186 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:01:32.445522 (Thread-1): finished collecting timing info
2021-06-16 08:01:32.465144 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.465307 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:01:32.465416 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:01:32.465506 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.477262 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:01:32.479178 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.479308 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:01:32.480344 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:01:32.481332 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.481459 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.481563 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.482457 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.482592 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.482691 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:01:32.483582 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.483751 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.483862 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.483961 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.484892 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.485020 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.485123 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:01:32.486027 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.487837 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.487967 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:01:32.488965 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:01:32.489885 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.490010 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.490113 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.491026 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.491166 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.491266 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:01:32.492133 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.512302 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:01:32.512729 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.512849 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:01:32.515178 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:01:32.517993 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.518120 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:01:32.519223 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:01:32.521712 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.521842 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:01:32.522917 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:01:32.524137 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.524263 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.524366 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.526331 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.526591 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.526701 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:01:32.527649 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.529436 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.529597 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:01:32.531112 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:01:32.532090 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.532230 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.532335 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:01:32.535520 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.535697 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:01:32.535826 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:01:32.536763 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:01:32.537324 (Thread-1): finished collecting timing info
2021-06-16 08:01:32.537504 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:01:32.538380 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:01:32.538968 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec09b0d0-eea3-4019-8416-cd1a05bcd9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427cba4f50>]}
2021-06-16 08:01:32.539432 (Thread-1): 08:01:32 | 2 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.10s]
2021-06-16 08:01:32.539720 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:01:32.630437 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:01:32.630695 (MainThread): Using redshift connection "master".
2021-06-16 08:01:32.630807 (MainThread): On master: BEGIN
2021-06-16 08:01:32.630942 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:01:32.631046 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:01:32.642829 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:01:32.643024 (MainThread): On master: COMMIT
2021-06-16 08:01:32.643138 (MainThread): Using redshift connection "master".
2021-06-16 08:01:32.643239 (MainThread): On master: COMMIT
2021-06-16 08:01:32.644161 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:01:32.644307 (MainThread): On master: Close
2021-06-16 08:01:32.644779 (MainThread): 08:01:32 | 
2021-06-16 08:01:32.645054 (MainThread): 08:01:32 | Finished running 1 view model, 1 table model in 0.60s.
2021-06-16 08:01:32.645358 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:01:32.645481 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:01:32.645585 (MainThread): Connection 'model.dbtintro_northwind.dim_customers' was properly closed.
2021-06-16 08:01:32.650779 (MainThread): 
2021-06-16 08:01:32.651073 (MainThread): Completed successfully
2021-06-16 08:01:32.651310 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 08:01:32.651629 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4277675e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427cb933d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42777f8110>]}
2021-06-16 08:01:32.651955 (MainThread): Flushing usage events
2021-06-16 08:13:18.717846 (MainThread): Running with dbt=0.19.1
2021-06-16 08:13:18.959441 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:13:18.959928 (MainThread): Tracking: tracking
2021-06-16 08:13:18.965619 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24fa864750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f7c12c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f7c12f90>]}
2021-06-16 08:13:18.985818 (MainThread): Partial parsing not enabled
2021-06-16 08:13:18.987037 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:13:19.026998 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:13:19.045707 (MainThread): Parsing macros/relations.sql
2021-06-16 08:13:19.046677 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:13:19.048042 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:13:19.079915 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:13:19.083402 (MainThread): Parsing macros/relations.sql
2021-06-16 08:13:19.085393 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:13:19.089099 (MainThread): Parsing macros/core.sql
2021-06-16 08:13:19.095305 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:13:19.160970 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:13:19.174970 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:13:19.176506 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:13:19.179139 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:13:19.182092 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:13:19.184706 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:13:19.186377 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:13:19.200482 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:13:19.222105 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:13:19.225097 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:13:19.235047 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:13:19.267281 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:13:19.313004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:13:19.315951 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:13:19.344152 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:13:19.354482 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:13:19.362366 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:13:19.372081 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:13:19.376324 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:13:19.378697 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:13:19.381582 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:13:19.392332 (MainThread): Partial parsing not enabled
2021-06-16 08:13:19.431455 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:13:19.446767 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:13:19.452453 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:19.456929 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:13:19.459109 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:13:19.462816 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:13:19.464803 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:19.469202 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:13:19.471169 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:13:19.474959 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:13:19.633242 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550aeb47-8119-4357-bfe9-8f183d057285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f7c0aad0>]}
2021-06-16 08:13:19.639416 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550aeb47-8119-4357-bfe9-8f183d057285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f7bdf710>]}
2021-06-16 08:13:19.639719 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:13:19.641077 (MainThread): 
2021-06-16 08:13:19.641540 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:13:19.642574 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:13:19.658153 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:13:19.658352 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:13:19.658468 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:13:19.658569 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:19.830476 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.17 seconds
2021-06-16 08:13:19.834923 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:13:19.835620 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:13:19.837524 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:13:19.837652 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:13:19.837772 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:13:19.837864 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:20.097648 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.26 seconds
2021-06-16 08:13:20.098360 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:13:20.100829 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:13:20.110673 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:13:20.110836 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:13:20.111005 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:13:20.111103 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:20.218911 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.11 seconds
2021-06-16 08:13:20.219156 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:13:20.219276 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:13:20.235792 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.02 seconds
2021-06-16 08:13:20.236721 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:13:20.251896 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:13:20.252699 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:13:20.255093 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:13:20.255230 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:13:20.255354 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:13:20.255458 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:20.475063 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.22 seconds
2021-06-16 08:13:20.475300 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:13:20.475420 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:13:20.502855 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.03 seconds
2021-06-16 08:13:20.503705 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:13:20.533328 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:13:20.534169 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:13:20.536389 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:13:20.536517 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:13:20.536628 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:13:20.536731 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:20.608325 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.07 seconds
2021-06-16 08:13:20.608581 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:13:20.608705 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:13:20.615978 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.01 seconds
2021-06-16 08:13:20.616733 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:13:20.621610 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:13:20.628339 (MainThread): Using redshift connection "master".
2021-06-16 08:13:20.628474 (MainThread): On master: BEGIN
2021-06-16 08:13:20.628586 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:13:20.628691 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:20.696225 (MainThread): SQL status: BEGIN in 0.07 seconds
2021-06-16 08:13:20.696457 (MainThread): Using redshift connection "master".
2021-06-16 08:13:20.696588 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:13:20.849336 (MainThread): SQL status: SELECT 6 in 0.15 seconds
2021-06-16 08:13:20.850630 (MainThread): On master: ROLLBACK
2021-06-16 08:13:20.887706 (MainThread): Using redshift connection "master".
2021-06-16 08:13:20.887936 (MainThread): On master: BEGIN
2021-06-16 08:13:20.931659 (MainThread): SQL status: BEGIN in 0.04 seconds
2021-06-16 08:13:20.931923 (MainThread): On master: COMMIT
2021-06-16 08:13:20.932045 (MainThread): Using redshift connection "master".
2021-06-16 08:13:20.932165 (MainThread): On master: COMMIT
2021-06-16 08:13:20.954961 (MainThread): SQL status: COMMIT in 0.02 seconds
2021-06-16 08:13:20.955230 (MainThread): On master: Close
2021-06-16 08:13:20.955806 (MainThread): 08:13:20 | Concurrency: 1 threads (target='dev')
2021-06-16 08:13:20.956073 (MainThread): 08:13:20 | 
2021-06-16 08:13:20.957938 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:13:20.958285 (Thread-1): 08:13:20 | 1 of 2 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:13:20.958626 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:20.958792 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:13:20.962790 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:13:20.963184 (Thread-1): finished collecting timing info
2021-06-16 08:13:20.989597 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:20.989801 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:13:20.989917 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:13:20.990012 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:21.094956 (Thread-1): SQL status: BEGIN in 0.10 seconds
2021-06-16 08:13:21.101880 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.102074 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:13:21.106466 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:13:21.107703 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.107841 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.107948 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.113230 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 08:13:21.113420 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.113522 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:13:21.117456 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.117652 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.117753 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.117847 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.120533 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:13:21.120665 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.120760 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:13:21.123049 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.124968 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.125098 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:13:21.126099 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:13:21.127121 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.127252 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.127355 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.128336 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:13:21.128469 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.128568 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:13:21.129485 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.136523 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:13:21.136928 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.137050 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:13:21.142714 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-06-16 08:13:21.151075 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.151237 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:13:21.156033 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:13:21.158764 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.158947 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:13:21.163982 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:13:21.175627 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.175797 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.175913 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.183819 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 08:13:21.186329 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.186464 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:13:21.188997 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.190789 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.190933 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:13:21.193638 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:13:21.194631 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.194760 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.194866 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:13:21.201562 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 08:13:21.201702 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:13:21.201801 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:13:21.212301 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:13:21.212936 (Thread-1): finished collecting timing info
2021-06-16 08:13:21.213121 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:13:21.221693 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:13:21.222270 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550aeb47-8119-4357-bfe9-8f183d057285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f77243d0>]}
2021-06-16 08:13:21.222711 (Thread-1): 08:13:21 | 1 of 2 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.26s]
2021-06-16 08:13:21.223017 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:13:21.223425 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:13:21.223693 (Thread-1): 08:13:21 | 2 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:13:21.224094 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.224244 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:13:21.227964 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:13:21.228360 (Thread-1): finished collecting timing info
2021-06-16 08:13:21.249564 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.249763 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:13:21.249888 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:13:21.249985 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:21.417110 (Thread-1): SQL status: BEGIN in 0.17 seconds
2021-06-16 08:13:21.419185 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.419313 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:13:21.427578 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-06-16 08:13:21.428629 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.428758 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.428862 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.442547 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 08:13:21.442718 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.442821 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:13:21.457504 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:13:21.457755 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.457866 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.457967 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.467560 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 08:13:21.467742 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.467854 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:13:21.472908 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.474864 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.475018 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:13:21.477054 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:13:21.478104 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.478230 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.478352 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.479318 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:13:21.479461 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.479561 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:13:21.480471 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.499445 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:13:21.499918 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.500045 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:13:21.505183 (Thread-1): SQL status: SELECT 91 in 0.01 seconds
2021-06-16 08:13:21.508011 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.508140 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:13:21.512996 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:13:21.515661 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.515794 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:13:21.516813 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:13:21.518056 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.518181 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.518284 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.520381 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:13:21.520647 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.520756 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:13:21.523013 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.524859 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.524988 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:13:21.529478 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:13:21.530399 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.530529 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.530636 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:13:21.537083 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 08:13:21.537279 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:13:21.537398 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:13:21.541394 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:13:21.541978 (Thread-1): finished collecting timing info
2021-06-16 08:13:21.542147 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:13:21.549414 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:13:21.549967 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '550aeb47-8119-4357-bfe9-8f183d057285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f76f0b90>]}
2021-06-16 08:13:21.550390 (Thread-1): 08:13:21 | 2 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.33s]
2021-06-16 08:13:21.550670 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:13:21.560016 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:13:21.560218 (MainThread): Using redshift connection "master".
2021-06-16 08:13:21.560328 (MainThread): On master: BEGIN
2021-06-16 08:13:21.560431 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:13:21.560522 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:13:21.582475 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:13:21.582695 (MainThread): On master: COMMIT
2021-06-16 08:13:21.582809 (MainThread): Using redshift connection "master".
2021-06-16 08:13:21.582956 (MainThread): On master: COMMIT
2021-06-16 08:13:21.583992 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:13:21.584148 (MainThread): On master: Close
2021-06-16 08:13:21.584699 (MainThread): 08:13:21 | 
2021-06-16 08:13:21.584976 (MainThread): 08:13:21 | Finished running 1 view model, 1 table model in 1.94s.
2021-06-16 08:13:21.585251 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:13:21.585378 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:13:21.585496 (MainThread): Connection 'model.dbtintro_northwind.dim_customers' was properly closed.
2021-06-16 08:13:21.590962 (MainThread): 
2021-06-16 08:13:21.591205 (MainThread): Completed successfully
2021-06-16 08:13:21.591454 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 08:13:21.591849 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f76f5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24f76f5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24fb00a310>]}
2021-06-16 08:13:21.592116 (MainThread): Flushing usage events
2021-06-16 08:19:26.593405 (MainThread): Running with dbt=0.19.1
2021-06-16 08:19:26.836101 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-16 08:19:26.836605 (MainThread): Tracking: tracking
2021-06-16 08:19:26.842319 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25998b3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25998b3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25998b3dd0>]}
2021-06-16 08:19:26.862992 (MainThread): Partial parsing not enabled
2021-06-16 08:19:26.864224 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:19:26.904034 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:19:26.923082 (MainThread): Parsing macros/relations.sql
2021-06-16 08:19:26.924090 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:19:26.925435 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:19:26.956724 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:19:26.960220 (MainThread): Parsing macros/relations.sql
2021-06-16 08:19:26.962199 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:19:26.965931 (MainThread): Parsing macros/core.sql
2021-06-16 08:19:26.971991 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:19:27.036727 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:19:27.050288 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:19:27.051753 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:19:27.054260 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:19:27.057191 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:19:27.059681 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:19:27.061274 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:19:27.075099 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:19:27.095913 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:19:27.098687 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:19:27.108436 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:19:27.139677 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:19:27.184495 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:19:27.187277 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:19:27.214698 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:19:27.225116 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:19:27.232925 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:19:27.242504 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:19:27.246856 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:19:27.249299 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:19:27.252171 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:19:27.262848 (MainThread): Partial parsing not enabled
2021-06-16 08:19:27.301648 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:19:27.317295 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:19:27.323023 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:27.327577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:27.329700 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:19:27.333433 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:27.335471 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:27.340003 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:27.341928 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:19:27.345842 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:27.502855 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04137bce-9c7b-4201-9146-337d6720ca71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25996fcd10>]}
2021-06-16 08:19:27.509187 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04137bce-9c7b-4201-9146-337d6720ca71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2599831190>]}
2021-06-16 08:19:27.509495 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:19:27.511105 (MainThread): 
2021-06-16 08:19:27.511594 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:19:27.513617 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:19:27.530211 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:19:27.530370 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:19:27.530488 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:19:27.530587 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.555014 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:19:27.555196 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:19:27.555312 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:19:27.557993 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:19:27.561170 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:19:27.562079 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:19:27.562732 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:19:27.564841 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:19:27.564971 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:19:27.565081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:19:27.565174 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.575744 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.575892 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:19:27.576011 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:19:27.578573 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:19:27.579199 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:19:27.580070 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:19:27.580650 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:19:27.582614 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:19:27.582747 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:19:27.582859 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:19:27.582992 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.593508 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.593653 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:19:27.593767 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:19:27.596406 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:19:27.597060 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:19:27.597951 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:19:27.604471 (MainThread): Using redshift connection "master".
2021-06-16 08:19:27.604605 (MainThread): On master: BEGIN
2021-06-16 08:19:27.604716 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:19:27.604810 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.616054 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.616202 (MainThread): Using redshift connection "master".
2021-06-16 08:19:27.616319 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:19:27.740583 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:19:27.741669 (MainThread): On master: ROLLBACK
2021-06-16 08:19:27.742600 (MainThread): On master: Close
2021-06-16 08:19:27.743200 (MainThread): 08:19:27 | Concurrency: 1 threads (target='dev')
2021-06-16 08:19:27.743548 (MainThread): 08:19:27 | 
2021-06-16 08:19:27.745323 (Thread-1): Began running node test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 08:19:27.745534 (Thread-1): 08:19:27 | 1 of 6 START test not_null_cls_customers_CustomerID.................. [RUN]
2021-06-16 08:19:27.745880 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_cls_customers_CustomerID".
2021-06-16 08:19:27.746047 (Thread-1): Compiling test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 08:19:27.755754 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_cls_customers_CustomerID"
2021-06-16 08:19:27.756155 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.756364 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_cls_customers_CustomerID".
2021-06-16 08:19:27.756481 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: BEGIN
2021-06-16 08:19:27.756599 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:27.756690 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.768840 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.769001 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_cls_customers_CustomerID".
2021-06-16 08:19:27.769119 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_cls_customers_CustomerID"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa_cleansing"."cls_customers"
where CustomerID is null



2021-06-16 08:19:27.770326 (Thread-1): Postgres error: column "customerid" does not exist
LINE 10: where CustomerID is null
               ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".

2021-06-16 08:19:27.770457 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: ROLLBACK
2021-06-16 08:19:27.771421 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.771592 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: Close
2021-06-16 08:19:27.772052 (Thread-1): Database Error in test not_null_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 10: where CustomerID is null
                 ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/not_null_cls_customers_CustomerID.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "customerid" does not exist
LINE 10: where CustomerID is null
               ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 65, in execute_schema_test
    fetch=True,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 10: where CustomerID is null
                 ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/not_null_cls_customers_CustomerID.sql
2021-06-16 08:19:27.774064 (Thread-1): 08:19:27 | 1 of 6 ERROR not_null_cls_customers_CustomerID....................... [ERROR in 0.03s]
2021-06-16 08:19:27.774352 (Thread-1): Finished running node test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 08:19:27.774553 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 08:19:27.774907 (Thread-1): 08:19:27 | 2 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-06-16 08:19:27.775347 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 08:19:27.775514 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 08:19:27.780041 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_first_dbt_model_id"
2021-06-16 08:19:27.780392 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.780582 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 08:19:27.780700 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: BEGIN
2021-06-16 08:19:27.780808 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:27.780901 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.791810 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.791962 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 08:19:27.792075 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa"."my_first_dbt_model"
where id is null



2021-06-16 08:19:27.793324 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:19:27.793659 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.793822 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: ROLLBACK
2021-06-16 08:19:27.794807 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: Close
2021-06-16 08:19:27.795289 (Thread-1): 08:19:27 | 2 of 6 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 0.02s]
2021-06-16 08:19:27.795567 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 08:19:27.795799 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 08:19:27.796063 (Thread-1): 08:19:27 | 3 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-06-16 08:19:27.796480 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 08:19:27.796633 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 08:19:27.801008 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_second_dbt_model_id"
2021-06-16 08:19:27.801280 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.801476 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 08:19:27.801598 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: BEGIN
2021-06-16 08:19:27.801704 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:27.801797 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.812476 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.812628 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 08:19:27.812742 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa"."my_second_dbt_model"
where id is null



2021-06-16 08:19:27.814074 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:19:27.814362 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.814523 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: ROLLBACK
2021-06-16 08:19:27.815471 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: Close
2021-06-16 08:19:27.815992 (Thread-1): 08:19:27 | 3 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.02s]
2021-06-16 08:19:27.816263 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 08:19:27.816506 (Thread-1): Began running node test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 08:19:27.816780 (Thread-1): 08:19:27 | 4 of 6 START test unique_cls_customers_CustomerID.................... [RUN]
2021-06-16 08:19:27.817207 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_cls_customers_CustomerID".
2021-06-16 08:19:27.817366 (Thread-1): Compiling test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 08:19:27.826848 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_cls_customers_CustomerID"
2021-06-16 08:19:27.827187 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.827382 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_cls_customers_CustomerID".
2021-06-16 08:19:27.827512 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: BEGIN
2021-06-16 08:19:27.827624 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:27.827720 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.838468 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.838628 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_cls_customers_CustomerID".
2021-06-16 08:19:27.838748 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_cls_customers_CustomerID"} */

    
    



select count(*) as validation_errors
from (

    select
        CustomerID

    from "postgres"."sifa_cleansing"."cls_customers"
    where CustomerID is not null
    group by CustomerID
    having count(*) > 1

) validation_errors



2021-06-16 08:19:27.839951 (Thread-1): Postgres error: column "customerid" does not exist
LINE 12:         CustomerID
                 ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".

2021-06-16 08:19:27.840081 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: ROLLBACK
2021-06-16 08:19:27.841006 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.841169 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: Close
2021-06-16 08:19:27.841622 (Thread-1): Database Error in test unique_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 12:         CustomerID
                   ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/unique_cls_customers_CustomerID.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "customerid" does not exist
LINE 12:         CustomerID
                 ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 65, in execute_schema_test
    fetch=True,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 12:         CustomerID
                   ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/unique_cls_customers_CustomerID.sql
2021-06-16 08:19:27.842128 (Thread-1): 08:19:27 | 4 of 6 ERROR unique_cls_customers_CustomerID......................... [ERROR in 0.03s]
2021-06-16 08:19:27.842386 (Thread-1): Finished running node test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 08:19:27.842576 (Thread-1): Began running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 08:19:27.842926 (Thread-1): 08:19:27 | 5 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2021-06-16 08:19:27.843348 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 08:19:27.843502 (Thread-1): Compiling test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 08:19:27.848032 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_first_dbt_model_id"
2021-06-16 08:19:27.848383 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.848571 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 08:19:27.848688 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: BEGIN
2021-06-16 08:19:27.848796 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:27.848888 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.859531 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.859696 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 08:19:27.859818 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from "postgres"."sifa"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors



2021-06-16 08:19:27.861308 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:19:27.861612 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.861775 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: ROLLBACK
2021-06-16 08:19:27.862686 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: Close
2021-06-16 08:19:27.863206 (Thread-1): 08:19:27 | 5 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 0.02s]
2021-06-16 08:19:27.863487 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 08:19:27.863730 (Thread-1): Began running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 08:19:27.863999 (Thread-1): 08:19:27 | 6 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2021-06-16 08:19:27.864425 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 08:19:27.864578 (Thread-1): Compiling test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 08:19:27.869172 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_second_dbt_model_id"
2021-06-16 08:19:27.869471 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.869658 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 08:19:27.869773 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: BEGIN
2021-06-16 08:19:27.869879 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:27.869971 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:27.880625 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:27.880769 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 08:19:27.880882 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from "postgres"."sifa"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors



2021-06-16 08:19:27.882359 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:19:27.882633 (Thread-1): finished collecting timing info
2021-06-16 08:19:27.882788 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: ROLLBACK
2021-06-16 08:19:27.883696 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: Close
2021-06-16 08:19:27.884161 (Thread-1): 08:19:27 | 6 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 0.02s]
2021-06-16 08:19:27.884420 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 08:19:27.949043 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:19:27.949511 (MainThread): 08:19:27 | 
2021-06-16 08:19:27.949806 (MainThread): 08:19:27 | Finished running 6 tests in 0.44s.
2021-06-16 08:19:27.950037 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:19:27.950147 (MainThread): Connection 'test.dbtintro_northwind.unique_my_second_dbt_model_id' was properly closed.
2021-06-16 08:19:27.955657 (MainThread): 
2021-06-16 08:19:27.955919 (MainThread): Completed with 3 errors and 0 warnings:
2021-06-16 08:19:27.956208 (MainThread): 
2021-06-16 08:19:27.956467 (MainThread): Database Error in test not_null_cls_customers_CustomerID (models/northwind_cls/schema.yml)
2021-06-16 08:19:27.956692 (MainThread):   column "customerid" does not exist
2021-06-16 08:19:27.956911 (MainThread):   LINE 10: where CustomerID is null
2021-06-16 08:19:27.957120 (MainThread):                  ^
2021-06-16 08:19:27.957327 (MainThread):   HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
2021-06-16 08:19:27.957553 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/not_null_cls_customers_CustomerID.sql
2021-06-16 08:19:27.957783 (MainThread): 
2021-06-16 08:19:27.957982 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-06-16 08:19:27.958172 (MainThread):   Got 1 result, expected 0.
2021-06-16 08:19:27.958355 (MainThread): 
2021-06-16 08:19:27.958551 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-06-16 08:19:27.958754 (MainThread): 
2021-06-16 08:19:27.958974 (MainThread): Database Error in test unique_cls_customers_CustomerID (models/northwind_cls/schema.yml)
2021-06-16 08:19:27.959162 (MainThread):   column "customerid" does not exist
2021-06-16 08:19:27.959329 (MainThread):   LINE 12:         CustomerID
2021-06-16 08:19:27.959501 (MainThread):                    ^
2021-06-16 08:19:27.959666 (MainThread):   HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
2021-06-16 08:19:27.959829 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/unique_cls_customers_CustomerID.sql
2021-06-16 08:19:27.960029 (MainThread): 
Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
2021-06-16 08:19:27.960332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2599505a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25993a7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f259833af90>]}
2021-06-16 08:19:27.960585 (MainThread): Flushing usage events
2021-06-16 08:19:41.731550 (MainThread): Running with dbt=0.19.1
2021-06-16 08:19:41.980358 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:19:41.980838 (MainThread): Tracking: tracking
2021-06-16 08:19:41.986660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9900e95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9900e9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9900e9c50>]}
2021-06-16 08:19:42.007291 (MainThread): Partial parsing not enabled
2021-06-16 08:19:42.008490 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:19:42.048017 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:19:42.066638 (MainThread): Parsing macros/relations.sql
2021-06-16 08:19:42.067683 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:19:42.069015 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:19:42.099125 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:19:42.102495 (MainThread): Parsing macros/relations.sql
2021-06-16 08:19:42.104489 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:19:42.108129 (MainThread): Parsing macros/core.sql
2021-06-16 08:19:42.114142 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:19:42.178577 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:19:42.192098 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:19:42.193573 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:19:42.196208 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:19:42.199193 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:19:42.201629 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:19:42.203250 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:19:42.217357 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:19:42.238433 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:19:42.241282 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:19:42.251188 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:19:42.282924 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:19:42.328061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:19:42.330714 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:19:42.358376 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:19:42.368653 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:19:42.376377 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:19:42.385819 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:19:42.390004 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:19:42.392379 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:19:42.395354 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:19:42.406036 (MainThread): Partial parsing not enabled
2021-06-16 08:19:42.445100 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:19:42.460281 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:19:42.466030 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:42.470485 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:42.472612 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:19:42.476423 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:42.478365 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:42.482843 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:42.484862 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:19:42.488652 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:19:42.647220 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be80c83a-79fa-47aa-addb-22c9037732a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98ff35250>]}
2021-06-16 08:19:42.653277 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be80c83a-79fa-47aa-addb-22c9037732a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98fc2d690>]}
2021-06-16 08:19:42.653610 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:19:42.654930 (MainThread): 
2021-06-16 08:19:42.655412 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:19:42.656448 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:19:42.671874 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:19:42.672046 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:19:42.672160 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:19:42.672257 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:42.690059 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:19:42.694323 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:19:42.695028 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:19:42.697010 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:19:42.697136 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:19:42.697248 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:19:42.697340 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:42.746175 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.05 seconds
2021-06-16 08:19:42.746896 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:19:42.749442 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:19:42.759362 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:19:42.759503 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:19:42.759616 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:19:42.759708 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:42.771391 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:42.771551 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:19:42.771661 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:19:42.774284 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:19:42.775010 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:19:42.775975 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:19:42.776613 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:19:42.778855 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:19:42.779017 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:19:42.779133 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:19:42.779228 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:42.790753 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:19:42.790943 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:19:42.791060 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:19:42.797837 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.01 seconds
2021-06-16 08:19:42.798597 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:19:42.802277 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:19:42.802995 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:19:42.805173 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:19:42.805303 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:19:42.805417 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:19:42.805519 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:42.831442 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2021-06-16 08:19:42.831671 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:19:42.831790 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:19:42.834455 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:19:42.835344 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:19:42.836358 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:19:42.843196 (MainThread): Using redshift connection "master".
2021-06-16 08:19:42.843339 (MainThread): On master: BEGIN
2021-06-16 08:19:42.843467 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:19:42.843563 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:42.858730 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:19:42.858929 (MainThread): Using redshift connection "master".
2021-06-16 08:19:42.859053 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:19:42.981634 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:19:42.982711 (MainThread): On master: ROLLBACK
2021-06-16 08:19:42.983818 (MainThread): Using redshift connection "master".
2021-06-16 08:19:42.983944 (MainThread): On master: BEGIN
2021-06-16 08:19:42.985775 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:42.985918 (MainThread): On master: COMMIT
2021-06-16 08:19:42.986023 (MainThread): Using redshift connection "master".
2021-06-16 08:19:42.986116 (MainThread): On master: COMMIT
2021-06-16 08:19:42.987106 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:42.987254 (MainThread): On master: Close
2021-06-16 08:19:42.987818 (MainThread): 08:19:42 | Concurrency: 1 threads (target='dev')
2021-06-16 08:19:42.988119 (MainThread): 08:19:42 | 
2021-06-16 08:19:42.990070 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:19:42.990397 (Thread-1): 08:19:42 | 1 of 2 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:19:42.990727 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:42.990919 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:19:42.994720 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:19:42.995180 (Thread-1): finished collecting timing info
2021-06-16 08:19:43.021085 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.021273 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:19:43.021386 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:43.021478 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:43.041093 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:19:43.047688 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.047834 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:19:43.049040 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:19:43.050185 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.050315 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.050418 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.051486 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.051627 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.051728 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:19:43.052741 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.052961 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.053080 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.053191 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.054151 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.054286 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.054398 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:19:43.055320 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.057179 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.057309 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:19:43.058372 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:19:43.059371 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.059528 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.059635 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.060559 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.060692 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.060793 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:19:43.061725 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.068876 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:19:43.069300 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.069427 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:19:43.071708 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:19:43.080019 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.080168 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:19:43.081475 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:19:43.084005 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.084142 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:19:43.086178 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:19:43.097704 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.097887 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.097994 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.102741 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.105398 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.105534 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:19:43.108266 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.110274 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.110401 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:19:43.112155 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:19:43.113148 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.113272 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.113379 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:19:43.115128 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.115267 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:19:43.115368 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:19:43.116372 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.117007 (Thread-1): finished collecting timing info
2021-06-16 08:19:43.117175 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:19:43.118102 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:19:43.118660 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be80c83a-79fa-47aa-addb-22c9037732a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98fba2190>]}
2021-06-16 08:19:43.119171 (Thread-1): 08:19:43 | 1 of 2 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.13s]
2021-06-16 08:19:43.119467 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:19:43.119842 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:19:43.120109 (Thread-1): 08:19:43 | 2 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:19:43.120509 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.120654 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:19:43.124301 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:19:43.124646 (Thread-1): finished collecting timing info
2021-06-16 08:19:43.145818 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.146022 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:19:43.146142 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:19:43.146235 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:43.161371 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:19:43.163424 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.163560 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:19:43.164742 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:19:43.165753 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.165877 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.165978 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.166892 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.167057 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.167160 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:19:43.168129 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.168292 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.168393 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.168483 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.169402 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.169526 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.169621 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:19:43.170542 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.172295 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.172436 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:19:43.173490 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:19:43.174367 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.174491 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.174603 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.175542 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.175682 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.175799 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:19:43.176688 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.195474 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:19:43.195942 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.196064 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:19:43.202310 (Thread-1): SQL status: SELECT 91 in 0.01 seconds
2021-06-16 08:19:43.205202 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.205329 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:19:43.210376 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:19:43.212952 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.213081 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:19:43.217228 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:19:43.218503 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.218628 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.218749 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.221937 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.222199 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.222307 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:19:43.223304 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.225137 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.225260 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:19:43.228442 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:19:43.229338 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.229469 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.229570 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:19:43.232467 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.232645 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:19:43.232761 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:19:43.233701 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:19:43.234328 (Thread-1): finished collecting timing info
2021-06-16 08:19:43.234504 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:19:43.235483 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:19:43.236058 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be80c83a-79fa-47aa-addb-22c9037732a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98cd55a90>]}
2021-06-16 08:19:43.236512 (Thread-1): 08:19:43 | 2 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.12s]
2021-06-16 08:19:43.236811 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:19:43.296516 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:19:43.296786 (MainThread): Using redshift connection "master".
2021-06-16 08:19:43.296904 (MainThread): On master: BEGIN
2021-06-16 08:19:43.297013 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:19:43.297106 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:19:43.321643 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:19:43.321880 (MainThread): On master: COMMIT
2021-06-16 08:19:43.321993 (MainThread): Using redshift connection "master".
2021-06-16 08:19:43.322098 (MainThread): On master: COMMIT
2021-06-16 08:19:43.323048 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:19:43.323201 (MainThread): On master: Close
2021-06-16 08:19:43.323792 (MainThread): 08:19:43 | 
2021-06-16 08:19:43.324106 (MainThread): 08:19:43 | Finished running 1 view model, 1 table model in 0.67s.
2021-06-16 08:19:43.324340 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:19:43.324457 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:19:43.324554 (MainThread): Connection 'model.dbtintro_northwind.dim_customers' was properly closed.
2021-06-16 08:19:43.329946 (MainThread): 
2021-06-16 08:19:43.330211 (MainThread): Completed successfully
2021-06-16 08:19:43.330455 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 08:19:43.330827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98fc23e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98cd4ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98cd55590>]}
2021-06-16 08:19:43.331104 (MainThread): Flushing usage events
2021-06-16 08:20:12.502566 (MainThread): Running with dbt=0.19.1
2021-06-16 08:20:12.749667 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:20:12.750165 (MainThread): Tracking: tracking
2021-06-16 08:20:12.756086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd30344e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3034b6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd30344ead0>]}
2021-06-16 08:20:12.776545 (MainThread): Partial parsing not enabled
2021-06-16 08:20:12.777782 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:20:12.818257 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:20:12.837565 (MainThread): Parsing macros/relations.sql
2021-06-16 08:20:12.838584 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:20:12.839956 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:20:12.871788 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:20:12.875327 (MainThread): Parsing macros/relations.sql
2021-06-16 08:20:12.877373 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:20:12.881003 (MainThread): Parsing macros/core.sql
2021-06-16 08:20:12.887190 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:20:12.952930 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:20:12.966858 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:20:12.968386 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:20:12.971001 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:20:12.974045 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:20:12.976647 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:20:12.978300 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:20:12.992415 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:20:13.013847 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:20:13.016915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:20:13.027136 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:20:13.059848 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:20:13.105839 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:20:13.108730 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:20:13.136685 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:20:13.147157 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:20:13.155023 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:20:13.164664 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:20:13.169005 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:20:13.171402 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:20:13.174321 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:20:13.185185 (MainThread): Partial parsing not enabled
2021-06-16 08:20:13.223937 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:20:13.239629 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:20:13.245527 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.250195 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:13.252354 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:20:13.256182 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:13.258180 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.262585 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:13.264587 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:20:13.268466 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:13.426402 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20969b9d-dd38-410f-9b91-ba2aab3ea3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3032bca10>]}
2021-06-16 08:20:13.432550 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20969b9d-dd38-410f-9b91-ba2aab3ea3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd303240fd0>]}
2021-06-16 08:20:13.432854 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:20:13.434227 (MainThread): 
2021-06-16 08:20:13.434718 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:20:13.435829 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:20:13.451413 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:20:13.451602 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:20:13.451721 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:20:13.451818 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.478059 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.03 seconds
2021-06-16 08:20:13.482392 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:20:13.483097 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:20:13.485038 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:20:13.485165 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:20:13.485280 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:20:13.485396 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.497260 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:20:13.497816 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:20:13.500243 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:20:13.510173 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:20:13.510315 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:20:13.510429 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:20:13.510523 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.521927 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:13.522086 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:20:13.522205 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:20:13.524997 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:13.525707 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:20:13.526716 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:20:13.527379 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:20:13.529521 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:20:13.529647 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:20:13.529766 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:20:13.529858 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.540915 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:13.541069 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:20:13.541180 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:20:13.544058 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:13.544781 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:20:13.546178 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:20:13.546847 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:20:13.548944 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:20:13.549068 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:20:13.549179 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:20:13.549271 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.561855 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:13.562010 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:20:13.562124 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:20:13.564787 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:20:13.565536 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:20:13.566551 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:20:13.573179 (MainThread): Using redshift connection "master".
2021-06-16 08:20:13.573316 (MainThread): On master: BEGIN
2021-06-16 08:20:13.573458 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:20:13.573555 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.585181 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:13.585381 (MainThread): Using redshift connection "master".
2021-06-16 08:20:13.585504 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:20:13.708363 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:20:13.709431 (MainThread): On master: ROLLBACK
2021-06-16 08:20:13.710457 (MainThread): Using redshift connection "master".
2021-06-16 08:20:13.710579 (MainThread): On master: BEGIN
2021-06-16 08:20:13.712425 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.712566 (MainThread): On master: COMMIT
2021-06-16 08:20:13.712670 (MainThread): Using redshift connection "master".
2021-06-16 08:20:13.712765 (MainThread): On master: COMMIT
2021-06-16 08:20:13.713685 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.713832 (MainThread): On master: Close
2021-06-16 08:20:13.714408 (MainThread): 08:20:13 | Concurrency: 1 threads (target='dev')
2021-06-16 08:20:13.714705 (MainThread): 08:20:13 | 
2021-06-16 08:20:13.716730 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:20:13.717090 (Thread-1): 08:20:13 | 1 of 2 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:20:13.717443 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.717617 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:20:13.721616 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:20:13.721989 (Thread-1): finished collecting timing info
2021-06-16 08:20:13.748765 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.748974 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:20:13.749097 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:13.749206 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.760921 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:13.767760 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.767917 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:20:13.768989 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:20:13.770114 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.770241 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.770345 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.771271 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.771412 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.771512 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:20:13.772410 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.772571 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.772675 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.772768 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.773666 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.773798 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.773897 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:20:13.774823 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.776662 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.776789 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:20:13.777801 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:20:13.778718 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.778864 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.779006 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.779932 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.780078 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.780177 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:20:13.781085 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.788201 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:20:13.788633 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.788753 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:20:13.790964 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:20:13.799048 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.799185 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:20:13.800335 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:20:13.802754 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.802901 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:20:13.803995 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:20:13.815411 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.815561 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.815670 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.817507 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.819926 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.820056 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:20:13.821020 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.822795 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.822944 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:20:13.824331 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:20:13.825282 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.825420 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.825526 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:20:13.827129 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.827279 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:13.827381 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:20:13.828290 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.828862 (Thread-1): finished collecting timing info
2021-06-16 08:20:13.829030 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:20:13.829967 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:20:13.830521 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20969b9d-dd38-410f-9b91-ba2aab3ea3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd300098b90>]}
2021-06-16 08:20:13.831006 (Thread-1): 08:20:13 | 1 of 2 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 08:20:13.831315 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:20:13.831696 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:20:13.831977 (Thread-1): 08:20:13 | 2 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:20:13.832409 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.832556 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:20:13.836130 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:20:13.836512 (Thread-1): finished collecting timing info
2021-06-16 08:20:13.858033 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.858233 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:20:13.858350 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:13.858444 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:13.871044 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:13.872988 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.873117 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:20:13.874306 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:20:13.875371 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.875535 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.875644 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.876623 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.876761 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.876863 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:20:13.877778 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.877958 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.878064 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.878159 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.879087 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.879225 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.879323 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:20:13.880235 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.882047 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.882173 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:20:13.883199 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:20:13.884230 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.884362 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.884471 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.885380 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.885531 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.885641 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:20:13.886560 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.906057 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:20:13.906565 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.906688 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:20:13.909040 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:20:13.911841 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.911972 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:20:13.913104 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:20:13.915747 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.915881 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:20:13.916915 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:20:13.918190 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.918315 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.918417 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.920041 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.920318 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.920427 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:20:13.921493 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.923211 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.923351 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:20:13.924793 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:20:13.925710 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.925838 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.925946 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:20:13.928693 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:13.928834 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:13.928935 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:20:13.929876 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:20:13.930422 (Thread-1): finished collecting timing info
2021-06-16 08:20:13.930588 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:20:13.931510 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:20:13.932069 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20969b9d-dd38-410f-9b91-ba2aab3ea3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd302ff2b90>]}
2021-06-16 08:20:13.932524 (Thread-1): 08:20:13 | 2 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.10s]
2021-06-16 08:20:13.932809 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:20:14.017623 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:20:14.017897 (MainThread): Using redshift connection "master".
2021-06-16 08:20:14.018012 (MainThread): On master: BEGIN
2021-06-16 08:20:14.018145 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:20:14.018238 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:14.037865 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:20:14.038110 (MainThread): On master: COMMIT
2021-06-16 08:20:14.038229 (MainThread): Using redshift connection "master".
2021-06-16 08:20:14.038359 (MainThread): On master: COMMIT
2021-06-16 08:20:14.039255 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:20:14.039410 (MainThread): On master: Close
2021-06-16 08:20:14.039973 (MainThread): 08:20:14 | 
2021-06-16 08:20:14.040287 (MainThread): 08:20:14 | Finished running 1 view model, 1 table model in 0.61s.
2021-06-16 08:20:14.040519 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:20:14.040629 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:20:14.040732 (MainThread): Connection 'model.dbtintro_northwind.dim_customers' was properly closed.
2021-06-16 08:20:14.046123 (MainThread): 
2021-06-16 08:20:14.046392 (MainThread): Completed successfully
2021-06-16 08:20:14.046647 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 08:20:14.047053 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3060e4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3030a3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3068484d0>]}
2021-06-16 08:20:14.047313 (MainThread): Flushing usage events
2021-06-16 08:20:17.961542 (MainThread): Running with dbt=0.19.1
2021-06-16 08:20:18.206446 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-16 08:20:18.206993 (MainThread): Tracking: tracking
2021-06-16 08:20:18.212748 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd8d7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd8d7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd8d7f90>]}
2021-06-16 08:20:18.233750 (MainThread): Partial parsing not enabled
2021-06-16 08:20:18.235021 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:20:18.274843 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:20:18.293730 (MainThread): Parsing macros/relations.sql
2021-06-16 08:20:18.294721 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:20:18.296127 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:20:18.326456 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:20:18.329921 (MainThread): Parsing macros/relations.sql
2021-06-16 08:20:18.331935 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:20:18.335619 (MainThread): Parsing macros/core.sql
2021-06-16 08:20:18.341636 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:20:18.406927 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:20:18.420980 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:20:18.422505 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:20:18.425232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:20:18.428440 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:20:18.430997 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:20:18.432653 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:20:18.447031 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:20:18.468390 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:20:18.471330 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:20:18.481276 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:20:18.513066 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:20:18.558461 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:20:18.561165 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:20:18.588710 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:20:18.598811 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:20:18.606521 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:20:18.615956 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:20:18.620093 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:20:18.622398 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:20:18.625328 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:20:18.635982 (MainThread): Partial parsing not enabled
2021-06-16 08:20:18.674524 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:20:18.689866 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:20:18.695624 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:20:18.700185 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:18.702270 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:20:18.706037 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:18.708063 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:20:18.712378 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:18.714317 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:20:18.718181 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:20:18.875202 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c205cc32-936f-4cbb-b4a4-91e53d3bfdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd445290>]}
2021-06-16 08:20:18.881538 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c205cc32-936f-4cbb-b4a4-91e53d3bfdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd41eb90>]}
2021-06-16 08:20:18.881850 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:20:18.883449 (MainThread): 
2021-06-16 08:20:18.883955 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:20:18.885968 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:20:18.902699 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:20:18.902900 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:20:18.903026 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:20:18.903127 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:18.920890 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:20:18.921118 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:20:18.921246 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:20:18.923916 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:20:18.927440 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:20:18.928378 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:20:18.929069 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:20:18.931285 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:20:18.931423 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:20:18.931709 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:20:18.931813 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:18.943072 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:18.943254 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:20:18.943378 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:20:18.945955 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:18.946707 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:20:18.947635 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:20:18.948339 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:20:18.950408 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:20:18.950533 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:20:18.950644 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:20:18.950740 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:18.962147 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:18.962329 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:20:18.962447 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:20:18.965071 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:18.965811 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:20:18.966726 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:20:18.973661 (MainThread): Using redshift connection "master".
2021-06-16 08:20:18.973828 (MainThread): On master: BEGIN
2021-06-16 08:20:18.973946 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:20:18.974042 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:18.985389 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:18.985552 (MainThread): Using redshift connection "master".
2021-06-16 08:20:18.985671 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:20:19.108407 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:20:19.109478 (MainThread): On master: ROLLBACK
2021-06-16 08:20:19.110447 (MainThread): On master: Close
2021-06-16 08:20:19.111068 (MainThread): 08:20:19 | Concurrency: 1 threads (target='dev')
2021-06-16 08:20:19.111401 (MainThread): 08:20:19 | 
2021-06-16 08:20:19.113175 (Thread-1): Began running node test.dbtintro_northwind.not_null_cls_customers_customer_id
2021-06-16 08:20:19.113383 (Thread-1): 08:20:19 | 1 of 6 START test not_null_cls_customers_customer_id................. [RUN]
2021-06-16 08:20:19.113734 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_cls_customers_customer_id".
2021-06-16 08:20:19.113901 (Thread-1): Compiling test.dbtintro_northwind.not_null_cls_customers_customer_id
2021-06-16 08:20:19.123699 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_cls_customers_customer_id"
2021-06-16 08:20:19.124065 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.124276 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_cls_customers_customer_id".
2021-06-16 08:20:19.124400 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_customer_id: BEGIN
2021-06-16 08:20:19.124516 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:19.124616 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:19.136327 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:19.136540 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_cls_customers_customer_id".
2021-06-16 08:20:19.136667 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_cls_customers_customer_id"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa_cleansing"."cls_customers"
where customer_id is null



2021-06-16 08:20:19.138126 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:19.138464 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.138639 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_customer_id: ROLLBACK
2021-06-16 08:20:19.139637 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_customer_id: Close
2021-06-16 08:20:19.140193 (Thread-1): 08:20:19 | 1 of 6 PASS not_null_cls_customers_customer_id....................... [PASS in 0.03s]
2021-06-16 08:20:19.140477 (Thread-1): Finished running node test.dbtintro_northwind.not_null_cls_customers_customer_id
2021-06-16 08:20:19.140667 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 08:20:19.140992 (Thread-1): 08:20:19 | 2 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-06-16 08:20:19.141588 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 08:20:19.141740 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 08:20:19.146198 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_first_dbt_model_id"
2021-06-16 08:20:19.146580 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.146770 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 08:20:19.146910 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: BEGIN
2021-06-16 08:20:19.147052 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:19.147147 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:19.158654 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:19.158822 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 08:20:19.158982 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa"."my_first_dbt_model"
where id is null



2021-06-16 08:20:19.160245 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:19.160545 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.160708 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: ROLLBACK
2021-06-16 08:20:19.161627 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: Close
2021-06-16 08:20:19.162125 (Thread-1): 08:20:19 | 2 of 6 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 0.02s]
2021-06-16 08:20:19.162412 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 08:20:19.162647 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 08:20:19.162930 (Thread-1): 08:20:19 | 3 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-06-16 08:20:19.163359 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 08:20:19.163509 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 08:20:19.168251 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_second_dbt_model_id"
2021-06-16 08:20:19.168637 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.168829 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 08:20:19.168941 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: BEGIN
2021-06-16 08:20:19.169046 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:19.169136 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:19.180186 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:19.180361 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 08:20:19.180471 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa"."my_second_dbt_model"
where id is null



2021-06-16 08:20:19.181769 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:19.182067 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.182230 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: ROLLBACK
2021-06-16 08:20:19.183095 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: Close
2021-06-16 08:20:19.183626 (Thread-1): 08:20:19 | 3 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.02s]
2021-06-16 08:20:19.183914 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 08:20:19.184155 (Thread-1): Began running node test.dbtintro_northwind.unique_cls_customers_customer_id
2021-06-16 08:20:19.184420 (Thread-1): 08:20:19 | 4 of 6 START test unique_cls_customers_customer_id................... [RUN]
2021-06-16 08:20:19.184846 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_cls_customers_customer_id".
2021-06-16 08:20:19.184993 (Thread-1): Compiling test.dbtintro_northwind.unique_cls_customers_customer_id
2021-06-16 08:20:19.194552 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_cls_customers_customer_id"
2021-06-16 08:20:19.194940 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.195158 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_cls_customers_customer_id".
2021-06-16 08:20:19.195288 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_customer_id: BEGIN
2021-06-16 08:20:19.195406 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:19.195501 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:19.206831 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:19.207075 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_cls_customers_customer_id".
2021-06-16 08:20:19.207208 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_cls_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from "postgres"."sifa_cleansing"."cls_customers"
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-16 08:20:19.209017 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:19.209329 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.209501 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_customer_id: ROLLBACK
2021-06-16 08:20:19.210397 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_customer_id: Close
2021-06-16 08:20:19.210982 (Thread-1): 08:20:19 | 4 of 6 PASS unique_cls_customers_customer_id......................... [PASS in 0.03s]
2021-06-16 08:20:19.211323 (Thread-1): Finished running node test.dbtintro_northwind.unique_cls_customers_customer_id
2021-06-16 08:20:19.211517 (Thread-1): Began running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 08:20:19.211776 (Thread-1): 08:20:19 | 5 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2021-06-16 08:20:19.212176 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 08:20:19.212331 (Thread-1): Compiling test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 08:20:19.217214 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_first_dbt_model_id"
2021-06-16 08:20:19.217646 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.217844 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 08:20:19.217962 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: BEGIN
2021-06-16 08:20:19.218074 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:19.218433 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:19.230016 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:19.230206 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 08:20:19.230323 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from "postgres"."sifa"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors



2021-06-16 08:20:19.231813 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:19.232133 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.232311 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: ROLLBACK
2021-06-16 08:20:19.233250 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: Close
2021-06-16 08:20:19.233829 (Thread-1): 08:20:19 | 5 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 0.02s]
2021-06-16 08:20:19.234125 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 08:20:19.234371 (Thread-1): Began running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 08:20:19.234638 (Thread-1): 08:20:19 | 6 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2021-06-16 08:20:19.235142 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 08:20:19.235303 (Thread-1): Compiling test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 08:20:19.240164 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_second_dbt_model_id"
2021-06-16 08:20:19.240536 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.240731 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 08:20:19.240846 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: BEGIN
2021-06-16 08:20:19.240953 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:20:19.241093 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:20:19.252600 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:20:19.252816 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 08:20:19.252939 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from "postgres"."sifa"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors



2021-06-16 08:20:19.254518 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:20:19.254846 (Thread-1): finished collecting timing info
2021-06-16 08:20:19.255063 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: ROLLBACK
2021-06-16 08:20:19.255971 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: Close
2021-06-16 08:20:19.256551 (Thread-1): 08:20:19 | 6 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 0.02s]
2021-06-16 08:20:19.256882 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 08:20:19.318293 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:20:19.318769 (MainThread): 08:20:19 | 
2021-06-16 08:20:19.319098 (MainThread): 08:20:19 | Finished running 6 tests in 0.43s.
2021-06-16 08:20:19.319333 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:20:19.319443 (MainThread): Connection 'test.dbtintro_northwind.unique_my_second_dbt_model_id' was properly closed.
2021-06-16 08:20:19.324900 (MainThread): 
2021-06-16 08:20:19.325194 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:20:19.325475 (MainThread): 
2021-06-16 08:20:19.325767 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-06-16 08:20:19.325994 (MainThread):   Got 1 result, expected 0.
2021-06-16 08:20:19.326209 (MainThread): 
2021-06-16 08:20:19.326444 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-06-16 08:20:19.326697 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-06-16 08:20:19.327040 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd739110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd537a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfd47ef90>]}
2021-06-16 08:20:19.327297 (MainThread): Flushing usage events
2021-06-16 08:21:09.020483 (MainThread): Running with dbt=0.19.1
2021-06-16 08:21:09.261249 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['northwind_core'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:21:09.261761 (MainThread): Tracking: tracking
2021-06-16 08:21:09.267663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e148a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e148ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e148af90>]}
2021-06-16 08:21:09.288301 (MainThread): Partial parsing not enabled
2021-06-16 08:21:09.289500 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:21:09.329589 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:21:09.348771 (MainThread): Parsing macros/relations.sql
2021-06-16 08:21:09.349749 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:21:09.351098 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:21:09.381582 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:21:09.385129 (MainThread): Parsing macros/relations.sql
2021-06-16 08:21:09.387226 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:21:09.390807 (MainThread): Parsing macros/core.sql
2021-06-16 08:21:09.397003 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:21:09.462309 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:21:09.476146 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:21:09.477595 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:21:09.480123 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:21:09.483108 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:21:09.485635 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:21:09.487308 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:21:09.501154 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:21:09.522323 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:21:09.525185 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:21:09.535085 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:21:09.566537 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:21:09.611526 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:21:09.614216 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:21:09.641909 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:21:09.652086 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:21:09.659832 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:21:09.669391 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:21:09.673492 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:21:09.675853 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:21:09.678687 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:21:09.689326 (MainThread): Partial parsing not enabled
2021-06-16 08:21:09.728078 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:09.743588 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:09.749586 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:09.754141 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:09.756384 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:09.760255 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:09.762190 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:09.766811 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:09.768841 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:09.772782 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:09.940612 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0985be7a-bf4c-4a1d-967c-fba77800f79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e12d2910>]}
2021-06-16 08:21:09.947027 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0985be7a-bf4c-4a1d-967c-fba77800f79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e12e9150>]}
2021-06-16 08:21:09.947334 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:21:09.948628 (MainThread): 
2021-06-16 08:21:09.949109 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:21:09.950129 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:21:09.965487 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:21:09.965647 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:21:09.965761 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:21:09.965858 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:09.991130 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.03 seconds
2021-06-16 08:21:09.995574 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:21:09.997998 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:21:10.007806 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:21:10.007965 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:21:10.008081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:21:10.008188 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:10.029612 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:21:10.029836 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:21:10.029949 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:21:10.033682 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:21:10.034420 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:21:10.035458 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:21:10.036141 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:21:10.038166 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:21:10.038290 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:21:10.038410 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:21:10.038504 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:10.050081 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:10.050540 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:21:10.050654 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:21:10.053215 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:21:10.053899 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:21:10.054846 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:21:10.055544 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:21:10.057591 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:21:10.057729 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:21:10.057843 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:21:10.057937 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:10.069150 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:10.069336 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:21:10.069450 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:21:10.072077 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:21:10.072846 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:21:10.074102 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:21:10.080969 (MainThread): Using redshift connection "master".
2021-06-16 08:21:10.081118 (MainThread): On master: BEGIN
2021-06-16 08:21:10.081229 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:21:10.081324 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:10.093549 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:10.093744 (MainThread): Using redshift connection "master".
2021-06-16 08:21:10.093858 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:21:10.216590 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:21:10.217706 (MainThread): On master: ROLLBACK
2021-06-16 08:21:10.218716 (MainThread): Using redshift connection "master".
2021-06-16 08:21:10.218838 (MainThread): On master: BEGIN
2021-06-16 08:21:10.220636 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.220773 (MainThread): On master: COMMIT
2021-06-16 08:21:10.220884 (MainThread): Using redshift connection "master".
2021-06-16 08:21:10.220985 (MainThread): On master: COMMIT
2021-06-16 08:21:10.221929 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.222068 (MainThread): On master: Close
2021-06-16 08:21:10.222618 (MainThread): 08:21:10 | Concurrency: 1 threads (target='dev')
2021-06-16 08:21:10.222972 (MainThread): 08:21:10 | 
2021-06-16 08:21:10.224655 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:21:10.224984 (Thread-1): 08:21:10 | 1 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:21:10.225322 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.225496 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:21:10.229410 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:21:10.229769 (Thread-1): finished collecting timing info
2021-06-16 08:21:10.250113 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.250304 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:10.250419 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:10.250514 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:10.262373 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:10.270868 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.271049 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:21:10.272160 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:10.273300 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.273445 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.273554 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.274489 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.274633 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.274737 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:10.275649 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.275830 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.275935 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.276031 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.277010 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.277145 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.277246 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:10.278190 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.280266 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.280397 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:21:10.281521 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:10.282467 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.282593 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.282697 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.283612 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.283758 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.283861 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:10.284785 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.311251 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:21:10.311742 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.311865 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:21:10.314245 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:21:10.322405 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.322540 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:21:10.323807 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:10.326415 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.326583 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:21:10.327598 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:10.339253 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.339409 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.339520 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.341242 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.343727 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.343861 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:10.344868 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.346737 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.346859 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:21:10.348221 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:10.349207 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.349332 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.349437 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:10.352468 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.352614 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:10.352715 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:10.353710 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.354355 (Thread-1): finished collecting timing info
2021-06-16 08:21:10.354534 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:21:10.355458 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:21:10.356041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0985be7a-bf4c-4a1d-967c-fba77800f79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e0fe2a90>]}
2021-06-16 08:21:10.356519 (Thread-1): 08:21:10 | 1 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.13s]
2021-06-16 08:21:10.356824 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:21:10.357055 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:21:10.357449 (Thread-1): 08:21:10 | 2 of 2 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:21:10.357875 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.358027 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:21:10.361088 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:21:10.361383 (Thread-1): finished collecting timing info
2021-06-16 08:21:10.364495 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.364644 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:10.364757 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:10.364852 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:10.376887 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:10.378669 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.378794 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:21:10.379842 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:10.380832 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:10.380959 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.381063 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:10.381962 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.382097 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.382197 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:10.383081 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.383255 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:10.383358 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.383469 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:10.384363 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.384494 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.384598 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:10.385496 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.387250 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.387392 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:21:10.388363 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:10.389262 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:10.389396 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.389500 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:10.390419 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.390551 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.390653 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:10.391551 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:10.392505 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:21:10.392830 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:10.392946 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


...
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:21:10.393943 (Thread-1): Postgres error: syntax error at or near ".."
LINE 12: ...
         ^

2021-06-16 08:21:10.394077 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:21:10.395016 (Thread-1): finished collecting timing info
2021-06-16 08:21:10.395189 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:21:10.395680 (Thread-1): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ".."
  LINE 12: ...
           ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ".."
LINE 12: ...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ".."
  LINE 12: ...
           ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:21:10.397821 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0985be7a-bf4c-4a1d-967c-fba77800f79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e6561050>]}
2021-06-16 08:21:10.398214 (Thread-1): 08:21:10 | 2 of 2 ERROR creating table model sifa_core.fact_orders.............. [ERROR in 0.04s]
2021-06-16 08:21:10.398511 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:21:10.427353 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:21:10.427592 (MainThread): Using redshift connection "master".
2021-06-16 08:21:10.427704 (MainThread): On master: BEGIN
2021-06-16 08:21:10.427822 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:21:10.427916 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:10.439505 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:10.439667 (MainThread): On master: COMMIT
2021-06-16 08:21:10.439777 (MainThread): Using redshift connection "master".
2021-06-16 08:21:10.439877 (MainThread): On master: COMMIT
2021-06-16 08:21:10.440740 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:10.440881 (MainThread): On master: Close
2021-06-16 08:21:10.441383 (MainThread): 08:21:10 | 
2021-06-16 08:21:10.441658 (MainThread): 08:21:10 | Finished running 2 table models in 0.49s.
2021-06-16 08:21:10.441936 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:21:10.442043 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:21:10.442135 (MainThread): Connection 'model.dbtintro_northwind.fact_orders' was properly closed.
2021-06-16 08:21:10.447661 (MainThread): 
2021-06-16 08:21:10.447939 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:21:10.448230 (MainThread): 
2021-06-16 08:21:10.448473 (MainThread): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
2021-06-16 08:21:10.448759 (MainThread):   syntax error at or near ".."
2021-06-16 08:21:10.448979 (MainThread):   LINE 12: ...
2021-06-16 08:21:10.449200 (MainThread):            ^
2021-06-16 08:21:10.449396 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:21:10.449597 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-06-16 08:21:10.449880 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e12e1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e653d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e10ebad0>]}
2021-06-16 08:21:10.450130 (MainThread): Flushing usage events
2021-06-16 08:21:46.519047 (MainThread): Running with dbt=0.19.1
2021-06-16 08:21:46.763131 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:21:46.763647 (MainThread): Tracking: tracking
2021-06-16 08:21:46.769512 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431fbe3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cf7f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cf1cf90>]}
2021-06-16 08:21:46.790356 (MainThread): Partial parsing not enabled
2021-06-16 08:21:46.791630 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:21:46.831695 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:21:46.850894 (MainThread): Parsing macros/relations.sql
2021-06-16 08:21:46.851913 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:21:46.853220 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:21:46.883756 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:21:46.887317 (MainThread): Parsing macros/relations.sql
2021-06-16 08:21:46.889325 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:21:46.892915 (MainThread): Parsing macros/core.sql
2021-06-16 08:21:46.899161 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:21:46.964133 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:21:46.977826 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:21:46.979346 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:21:46.981830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:21:46.984872 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:21:46.987382 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:21:46.988963 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:21:47.002835 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:21:47.023745 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:21:47.026580 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:21:47.036394 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:21:47.067845 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:21:47.112441 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:21:47.115170 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:21:47.142585 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:21:47.152570 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:21:47.160194 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:21:47.169790 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:21:47.174046 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:21:47.176466 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:21:47.179348 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:21:47.189796 (MainThread): Partial parsing not enabled
2021-06-16 08:21:47.228631 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:47.244154 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:47.250065 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.254536 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:47.256724 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:47.260396 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:47.262319 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:47.266930 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:47.268845 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:47.272639 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:21:47.431620 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431ca7f490>]}
2021-06-16 08:21:47.437904 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cd0cc10>]}
2021-06-16 08:21:47.438271 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-06-16 08:21:47.439770 (MainThread): 
2021-06-16 08:21:47.440252 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:21:47.441678 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:21:47.458100 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:21:47.458256 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:21:47.458369 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:21:47.458467 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.481540 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:21:47.484864 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:21:47.485601 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:21:47.487661 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:21:47.487789 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:21:47.487902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:21:47.487997 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.506610 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:21:47.507330 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:21:47.508014 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:21:47.510194 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:21:47.510318 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:21:47.510437 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:21:47.510541 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.523943 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:21:47.524596 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:21:47.527112 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:21:47.536712 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:21:47.536859 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:21:47.536973 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:21:47.537069 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.678505 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.14 seconds
2021-06-16 08:21:47.678734 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:21:47.678846 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:21:47.681602 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:21:47.682326 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:21:47.683271 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:21:47.683950 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:21:47.686156 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:21:47.686280 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:21:47.686390 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:21:47.686484 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.698472 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:47.698642 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:21:47.698752 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:21:47.701295 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:21:47.701935 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:21:47.702910 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:21:47.703574 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:21:47.705668 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:21:47.705801 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:21:47.705914 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:21:47.706008 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.718489 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:47.718662 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:21:47.718776 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:21:47.721415 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:21:47.722212 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:21:47.723158 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:21:47.730029 (MainThread): Using redshift connection "master".
2021-06-16 08:21:47.730165 (MainThread): On master: BEGIN
2021-06-16 08:21:47.730277 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:21:47.730370 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.742164 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:47.742323 (MainThread): Using redshift connection "master".
2021-06-16 08:21:47.742433 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:21:47.865331 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:21:47.866451 (MainThread): On master: ROLLBACK
2021-06-16 08:21:47.867514 (MainThread): Using redshift connection "master".
2021-06-16 08:21:47.867643 (MainThread): On master: BEGIN
2021-06-16 08:21:47.869400 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:47.869534 (MainThread): On master: COMMIT
2021-06-16 08:21:47.869640 (MainThread): Using redshift connection "master".
2021-06-16 08:21:47.869742 (MainThread): On master: COMMIT
2021-06-16 08:21:47.870708 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:47.870847 (MainThread): On master: Close
2021-06-16 08:21:47.871448 (MainThread): 08:21:47 | Concurrency: 1 threads (target='dev')
2021-06-16 08:21:47.871775 (MainThread): 08:21:47 | 
2021-06-16 08:21:47.873732 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:21:47.874066 (Thread-1): 08:21:47 | 1 of 6 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:21:47.874407 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.874576 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:21:47.878668 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:21:47.879075 (Thread-1): finished collecting timing info
2021-06-16 08:21:47.905205 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.905411 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:21:47.905533 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:47.905633 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:47.917883 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:47.924531 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.924682 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:21:47.925752 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:47.926925 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.927070 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.927182 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.928153 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:47.928290 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.928399 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:21:47.929321 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:47.929488 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.929592 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.929693 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.930604 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:47.930734 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.930829 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:21:47.931799 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:47.933500 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.933626 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:21:47.934670 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:47.935620 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.935756 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.935874 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.936820 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:47.936958 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.937059 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:21:47.938000 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:47.944962 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:21:47.945382 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.945506 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:21:47.947737 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:21:47.955596 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.955740 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:21:47.956933 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:47.959584 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.959716 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:21:47.960906 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:47.971957 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.972103 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.972206 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.973986 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:47.976488 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.976620 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:21:47.977635 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:47.979571 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.979700 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:21:47.981088 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:47.982067 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.982194 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.982298 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:21:47.983892 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:47.984042 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:21:47.984147 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:21:47.985052 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:47.985616 (Thread-1): finished collecting timing info
2021-06-16 08:21:47.985794 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:21:47.986799 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:21:47.987372 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4319b86050>]}
2021-06-16 08:21:47.987829 (Thread-1): 08:21:47 | 1 of 6 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 08:21:47.988114 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:21:47.988304 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:21:47.988857 (Thread-1): 08:21:47 | 2 of 6 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:21:47.989282 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:47.989429 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:21:47.993954 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:21:47.994320 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.014440 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.014654 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:21:48.014779 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:48.014906 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:48.057821 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-06-16 08:21:48.059905 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.060048 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:21:48.061277 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.062294 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.062422 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.062527 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.063471 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.063627 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.063732 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:21:48.064650 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.064820 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.064926 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.065022 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.065957 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.066096 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.066190 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:21:48.067130 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.069136 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.069260 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:21:48.070271 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.071267 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.071399 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.071506 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.072527 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.072705 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.072824 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:21:48.073764 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.092747 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:21:48.093240 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.093359 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:21:48.095147 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:21:48.097918 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.098042 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:21:48.099144 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:48.101602 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.101733 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:21:48.102755 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:48.103999 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.104125 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.104227 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.105962 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.106213 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.106319 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:21:48.107245 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.108968 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.109089 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:21:48.110519 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.111403 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.111531 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.111633 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:21:48.115043 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.115181 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:21:48.115292 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:21:48.116370 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.116875 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.117037 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:21:48.118001 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:21:48.118545 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4319b6dc50>]}
2021-06-16 08:21:48.119011 (Thread-1): 08:21:48 | 2 of 6 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.13s]
2021-06-16 08:21:48.119299 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:21:48.119486 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:21:48.119955 (Thread-1): 08:21:48 | 3 of 6 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:21:48.120374 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.120524 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:21:48.123581 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:21:48.123874 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.125855 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.125988 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:21:48.126096 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:48.126190 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:48.137940 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:48.139800 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.139930 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:21:48.141054 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:48.142016 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:21:48.142141 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.142244 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:21:48.143148 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.143285 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.143383 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:21:48.144315 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.144480 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:21:48.144583 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.144677 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:21:48.145552 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.145694 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.145800 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:21:48.146697 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.148390 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.148519 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:21:48.149504 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:48.150400 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:21:48.150523 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.150623 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:21:48.151586 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.151735 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.151835 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:21:48.152757 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.153470 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:21:48.153801 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:21:48.153918 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


...
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:21:48.154965 (Thread-1): Postgres error: syntax error at or near ".."
LINE 8: ...
        ^

2021-06-16 08:21:48.155088 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:21:48.156015 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.156174 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:21:48.156829 (Thread-1): Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
  syntax error at or near ".."
  LINE 8: ...
          ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ".."
LINE 8: ...
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
  syntax error at or near ".."
  LINE 8: ...
          ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
2021-06-16 08:21:48.158743 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431ca59990>]}
2021-06-16 08:21:48.159171 (Thread-1): 08:21:48 | 3 of 6 ERROR creating view model sifa_cleansing.cls_orders........... [ERROR in 0.04s]
2021-06-16 08:21:48.159452 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:21:48.159655 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:21:48.160064 (Thread-1): 08:21:48 | 4 of 6 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:21:48.160482 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.160632 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:21:48.163964 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:21:48.164283 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.166198 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.166325 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:48.166433 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:48.166526 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:48.187596 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:21:48.189596 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.189725 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:21:48.190797 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.191854 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.191981 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.192083 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.193026 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.193158 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.193256 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:48.194292 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.194450 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.194550 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.194640 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.195553 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.195692 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.195790 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:48.196685 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.198305 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.198430 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:21:48.199587 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.200509 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.200637 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.200741 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.201683 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.201813 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.201910 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:48.202829 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.204044 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:21:48.204429 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.204550 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:21:48.206649 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:21:48.209246 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.209370 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:21:48.210450 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:48.214216 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.214340 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:21:48.215433 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:48.216685 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.216813 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.216928 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.218883 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.219168 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.219282 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:48.220215 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.269795 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.269989 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:21:48.271475 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.272453 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.272577 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.272680 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:21:48.275498 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.275640 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:21:48.275743 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:21:48.276662 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.277202 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.277371 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:21:48.278284 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:21:48.278854 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cfb8850>]}
2021-06-16 08:21:48.279351 (Thread-1): 08:21:48 | 4 of 6 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.12s]
2021-06-16 08:21:48.279641 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:21:48.279836 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:21:48.280186 (Thread-1): 08:21:48 | 5 of 6 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:21:48.280603 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.280752 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:21:48.283807 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:21:48.284157 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.285955 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.286085 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:48.286197 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:48.286303 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:48.308314 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:21:48.310447 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.310577 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:21:48.311686 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.312697 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:48.312824 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.312928 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:48.313866 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.314003 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.314106 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:48.315146 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.315317 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:48.315430 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.315525 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:48.316547 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.316673 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.316767 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:48.317714 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.319565 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.319694 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:21:48.320746 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:21:48.321683 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:48.321810 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.321914 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:21:48.322839 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.323005 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.323117 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:21:48.324052 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.325059 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:21:48.325459 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:21:48.325585 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


...
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:21:48.326633 (Thread-1): Postgres error: syntax error at or near ".."
LINE 12: ...
         ^

2021-06-16 08:21:48.326760 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:21:48.328151 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.328325 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:21:48.328799 (Thread-1): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ".."
  LINE 12: ...
           ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ".."
LINE 12: ...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ".."
  LINE 12: ...
           ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:21:48.329444 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cf59b50>]}
2021-06-16 08:21:48.329844 (Thread-1): 08:21:48 | 5 of 6 ERROR creating table model sifa_core.fact_orders.............. [ERROR in 0.05s]
2021-06-16 08:21:48.330145 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:21:48.330333 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:21:48.330735 (Thread-1): 08:21:48 | 6 of 6 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:21:48.331186 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.331342 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:21:48.334456 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:21:48.334779 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.336782 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.336917 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:21:48.337030 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:21:48.337127 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:48.357386 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:21:48.359492 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.359634 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:21:48.360699 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:48.361734 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.361867 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.361975 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.362922 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.363094 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.363196 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:21:48.364103 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.364280 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.364396 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.364499 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.365410 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.365541 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.365649 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:21:48.366587 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.368407 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.368535 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:21:48.369522 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:48.370440 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.370569 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.370674 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.371584 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.371724 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.371825 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:21:48.372900 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.373594 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:21:48.373979 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.374102 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:21:48.376051 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:21:48.378651 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.378776 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:21:48.379866 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:21:48.381117 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.381244 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.381349 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.382979 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.383238 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.383358 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:21:48.384311 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.386077 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.386204 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:21:48.387242 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:21:48.388169 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.388302 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.388408 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:21:48.389334 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.389466 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:21:48.389573 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:21:48.390461 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:21:48.390988 (Thread-1): finished collecting timing info
2021-06-16 08:21:48.391161 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:21:48.392068 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:21:48.392631 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658840fa-7a04-4bc6-92b8-6e357ca225b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cb3c610>]}
2021-06-16 08:21:48.393077 (Thread-1): 08:21:48 | 6 of 6 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.06s]
2021-06-16 08:21:48.393371 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:21:48.475239 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:21:48.475493 (MainThread): Using redshift connection "master".
2021-06-16 08:21:48.475603 (MainThread): On master: BEGIN
2021-06-16 08:21:48.475711 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:21:48.475804 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:21:48.487706 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:21:48.487879 (MainThread): On master: COMMIT
2021-06-16 08:21:48.488001 (MainThread): Using redshift connection "master".
2021-06-16 08:21:48.488104 (MainThread): On master: COMMIT
2021-06-16 08:21:48.488997 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:21:48.489140 (MainThread): On master: Close
2021-06-16 08:21:48.489670 (MainThread): 08:21:48 | 
2021-06-16 08:21:48.489943 (MainThread): 08:21:48 | Finished running 3 view models, 3 table models in 1.05s.
2021-06-16 08:21:48.490209 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:21:48.490323 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:21:48.490413 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:21:48.495770 (MainThread): 
2021-06-16 08:21:48.496013 (MainThread): Completed with 2 errors and 0 warnings:
2021-06-16 08:21:48.496257 (MainThread): 
2021-06-16 08:21:48.496484 (MainThread): Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
2021-06-16 08:21:48.496763 (MainThread):   syntax error at or near ".."
2021-06-16 08:21:48.496974 (MainThread):   LINE 8: ...
2021-06-16 08:21:48.497170 (MainThread):           ^
2021-06-16 08:21:48.497374 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
2021-06-16 08:21:48.497598 (MainThread): 
2021-06-16 08:21:48.497787 (MainThread): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
2021-06-16 08:21:48.497958 (MainThread):   syntax error at or near ".."
2021-06-16 08:21:48.498117 (MainThread):   LINE 12: ...
2021-06-16 08:21:48.498276 (MainThread):            ^
2021-06-16 08:21:48.498432 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:21:48.498616 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-06-16 08:21:48.498903 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cb724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4319acfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431cf2a950>]}
2021-06-16 08:21:48.499152 (MainThread): Flushing usage events
2021-06-16 08:34:19.084715 (MainThread): Running with dbt=0.19.1
2021-06-16 08:34:19.318438 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:34:19.318980 (MainThread): Tracking: tracking
2021-06-16 08:34:19.324581 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44e1af350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44e1afc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44e1aff90>]}
2021-06-16 08:34:19.344818 (MainThread): Partial parsing not enabled
2021-06-16 08:34:19.346036 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:34:19.385945 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:34:19.404884 (MainThread): Parsing macros/relations.sql
2021-06-16 08:34:19.405860 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:34:19.407257 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:34:19.437706 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:34:19.441135 (MainThread): Parsing macros/relations.sql
2021-06-16 08:34:19.443161 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:34:19.446851 (MainThread): Parsing macros/core.sql
2021-06-16 08:34:19.452910 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:34:19.518100 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:34:19.531755 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:34:19.533190 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:34:19.535830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:34:19.538777 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:34:19.541209 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:34:19.542799 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:34:19.557017 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:34:19.577942 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:34:19.580760 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:34:19.590546 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:34:19.622311 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:34:19.667044 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:34:19.669823 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:34:19.697359 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:34:19.707551 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:34:19.715270 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:34:19.724756 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:34:19.728943 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:34:19.731372 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:34:19.734253 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:34:19.744701 (MainThread): Partial parsing not enabled
2021-06-16 08:34:19.782966 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:34:19.798312 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:34:19.804106 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:34:19.808687 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:34:19.810777 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:34:19.814492 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:34:19.816430 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:34:19.821027 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:34:19.822981 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:34:19.827461 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:34:19.829401 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:34:19.832534 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:34:19.894316 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44dfcf410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44dfcfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44dfc79d0>]}
2021-06-16 08:34:19.894639 (MainThread): Flushing usage events
2021-06-16 08:34:20.278312 (MainThread): Connection 'model.dbtintro_northwind.fact_orders' was properly closed.
2021-06-16 08:34:20.278849 (MainThread): Encountered an error:
2021-06-16 08:34:20.279176 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customers. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customers in one of these files:
   - models/northwind_reporting/schema.yml
  models/northwind_core/schema.yml
2021-06-16 08:34:20.282297 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 654, in parse_file
    for test_block in parser.parse():
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 865, in parse
    self.parse_patch(node_block, refs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 911, in parse_patch
    self.results.add_patch(self.yaml.file, result)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/results.py", line 158, in add_patch
    raise_duplicate_patch_name(patch, self.patches[patch.name])
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 857, in raise_duplicate_patch_name
    f'dbt found two schema.yml entries for the same resource named '
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customers. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customers in one of these files:
   - models/northwind_reporting/schema.yml
  models/northwind_core/schema.yml

2021-06-16 08:35:06.193462 (MainThread): Running with dbt=0.19.1
2021-06-16 08:35:06.435717 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:35:06.436212 (MainThread): Tracking: tracking
2021-06-16 08:35:06.441886 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961e823490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961e823b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961e823e10>]}
2021-06-16 08:35:06.462268 (MainThread): Partial parsing not enabled
2021-06-16 08:35:06.463510 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:35:06.505035 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:35:06.524020 (MainThread): Parsing macros/relations.sql
2021-06-16 08:35:06.524981 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:35:06.526322 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:35:06.556575 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:35:06.560082 (MainThread): Parsing macros/relations.sql
2021-06-16 08:35:06.562003 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:35:06.565670 (MainThread): Parsing macros/core.sql
2021-06-16 08:35:06.571752 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:35:06.636966 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:35:06.650748 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:35:06.652241 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:35:06.654768 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:35:06.657876 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:35:06.660342 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:35:06.661977 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:35:06.675954 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:35:06.696997 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:35:06.699894 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:35:06.709662 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:35:06.741614 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:35:06.787577 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:35:06.790301 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:35:06.818200 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:35:06.828860 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:35:06.836682 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:35:06.846263 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:35:06.850410 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:35:06.852782 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:35:06.855759 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:35:06.866544 (MainThread): Partial parsing not enabled
2021-06-16 08:35:06.905209 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:35:06.920655 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:35:06.926305 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:35:06.930709 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:35:06.932797 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:35:06.935855 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:35:06.937726 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:35:06.942545 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:35:06.944634 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:35:06.949268 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:35:06.951231 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:35:06.954474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:35:07.017721 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961e63a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961e6431d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f961e643b90>]}
2021-06-16 08:35:07.018056 (MainThread): Flushing usage events
2021-06-16 08:35:07.397396 (MainThread): Connection 'model.dbtintro_northwind.fact_orders' was properly closed.
2021-06-16 08:35:07.397946 (MainThread): Encountered an error:
2021-06-16 08:35:07.398223 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customers. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customers in one of these files:
   - models/northwind_reporting/schema.yml
  models/northwind_core/schema.yml
2021-06-16 08:35:07.400011 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 654, in parse_file
    for test_block in parser.parse():
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 865, in parse
    self.parse_patch(node_block, refs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 911, in parse_patch
    self.results.add_patch(self.yaml.file, result)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/results.py", line 158, in add_patch
    raise_duplicate_patch_name(patch, self.patches[patch.name])
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 857, in raise_duplicate_patch_name
    f'dbt found two schema.yml entries for the same resource named '
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named dim_customers. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_customers in one of these files:
   - models/northwind_reporting/schema.yml
  models/northwind_core/schema.yml

2021-06-16 08:36:22.846174 (MainThread): Running with dbt=0.19.1
2021-06-16 08:36:23.098040 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:36:23.098546 (MainThread): Tracking: tracking
2021-06-16 08:36:23.104311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa671d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa671dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa671ded0>]}
2021-06-16 08:36:23.125214 (MainThread): Partial parsing not enabled
2021-06-16 08:36:23.126442 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:36:23.166809 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:36:23.185914 (MainThread): Parsing macros/relations.sql
2021-06-16 08:36:23.186987 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:36:23.188382 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:36:23.219195 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:36:23.222656 (MainThread): Parsing macros/relations.sql
2021-06-16 08:36:23.224700 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:36:23.228464 (MainThread): Parsing macros/core.sql
2021-06-16 08:36:23.234607 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:36:23.300623 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:36:23.314771 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:36:23.316368 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:36:23.319061 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:36:23.322076 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:36:23.324645 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:36:23.326316 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:36:23.340516 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:36:23.362383 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:36:23.365452 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:36:23.375735 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:36:23.408569 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:36:23.455050 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:36:23.457974 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:36:23.486497 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:36:23.497110 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:36:23.505237 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:36:23.515499 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:36:23.519890 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:36:23.522310 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:36:23.525341 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:36:23.536287 (MainThread): Partial parsing not enabled
2021-06-16 08:36:23.575003 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:23.590646 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:23.596569 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:23.601028 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:23.603146 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:23.606244 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:23.608199 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:23.612930 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:23.614958 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:23.619477 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:23.621449 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:23.624886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:23.687064 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa6535a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa6535a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa6535690>]}
2021-06-16 08:36:23.687395 (MainThread): Flushing usage events
2021-06-16 08:36:24.075979 (MainThread): Connection 'model.dbtintro_northwind.fact_orders' was properly closed.
2021-06-16 08:36:24.076500 (MainThread): Encountered an error:
2021-06-16 08:36:24.076782 (MainThread): Compilation Error
  Invalid models config given in models/northwind_reporting/schema.yml @ models: {'name': None, 'original_file_path': 'models/northwind_reporting/schema.yml', 'yaml_key': 'models', 'package_name': 'dbtintro_northwind'} - at path ['name']: None is not of type 'string'
2021-06-16 08:36:24.079722 (MainThread): jsonschema.exceptions.ValidationError: None is not of type 'string'

Failed validating 'type' in schema['properties']['name']:
    {'type': 'string'}

On instance['name']:
    None

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 885, in get_unparsed_target
    self._target_type().validate(data)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/hologram/__init__.py", line 989, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: None is not of type 'string'

Failed validating 'type' in schema['properties']['name']:
    {'type': 'string'}

On instance['name']:
    None

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 654, in parse_file
    for test_block in parser.parse():
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 851, in parse
    for node in self.get_unparsed_target():
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/schemas.py", line 889, in get_unparsed_target
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid models config given in models/northwind_reporting/schema.yml @ models: {'name': None, 'original_file_path': 'models/northwind_reporting/schema.yml', 'yaml_key': 'models', 'package_name': 'dbtintro_northwind'} - at path ['name']: None is not of type 'string'

2021-06-16 08:36:47.967124 (MainThread): Running with dbt=0.19.1
2021-06-16 08:36:48.209873 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:36:48.210370 (MainThread): Tracking: tracking
2021-06-16 08:36:48.216015 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daaec850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daaecbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daaeced0>]}
2021-06-16 08:36:48.236181 (MainThread): Partial parsing not enabled
2021-06-16 08:36:48.237397 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:36:48.277128 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:36:48.296183 (MainThread): Parsing macros/relations.sql
2021-06-16 08:36:48.297185 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:36:48.298514 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:36:48.329565 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:36:48.333077 (MainThread): Parsing macros/relations.sql
2021-06-16 08:36:48.335095 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:36:48.338776 (MainThread): Parsing macros/core.sql
2021-06-16 08:36:48.345007 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:36:48.411869 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:36:48.426013 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:36:48.427636 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:36:48.430205 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:36:48.433253 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:36:48.435903 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:36:48.437600 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:36:48.452013 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:36:48.473500 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:36:48.476521 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:36:48.486524 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:36:48.519208 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:36:48.564985 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:36:48.567904 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:36:48.595916 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:36:48.606374 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:36:48.614274 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:36:48.623916 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:36:48.628199 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:36:48.630694 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:36:48.633691 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:36:48.644495 (MainThread): Partial parsing not enabled
2021-06-16 08:36:48.683076 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:48.698512 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:48.704285 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:48.709127 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:48.711349 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:48.714444 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:48.716378 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:48.720898 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:48.722798 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:48.727173 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:48.729111 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:48.732386 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:36:48.881746 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:36:48.893011 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29da9208d0>]}
2021-06-16 08:36:48.899482 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29da90de90>]}
2021-06-16 08:36:48.899799 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:36:48.901304 (MainThread): 
2021-06-16 08:36:48.901783 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:36:48.903337 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:36:48.920115 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:36:48.920282 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:36:48.920398 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:36:48.920499 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:48.940530 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:36:48.944014 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:36:48.944731 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:36:48.946739 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:36:48.946865 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:36:48.947028 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:36:48.947128 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:48.958756 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:36:48.959374 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:36:48.960030 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:36:48.962075 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:36:48.962211 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:36:48.962323 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:36:48.962418 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:48.973830 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:36:48.974375 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:36:48.976973 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:36:48.986789 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:36:48.986970 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:36:48.987089 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:36:48.987187 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:48.998131 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:48.998301 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:36:48.998414 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:36:49.001000 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:36:49.001692 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:36:49.002646 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:36:49.003269 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:36:49.005449 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:36:49.005580 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:36:49.005695 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:36:49.005793 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.016571 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.016720 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:36:49.016838 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:36:49.019370 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:36:49.020013 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:36:49.020939 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:36:49.021549 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:36:49.023504 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:36:49.023638 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:36:49.023751 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:36:49.023848 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.034698 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.034874 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:36:49.035035 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:36:49.037633 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:36:49.038423 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:36:49.039333 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:36:49.046315 (MainThread): Using redshift connection "master".
2021-06-16 08:36:49.046472 (MainThread): On master: BEGIN
2021-06-16 08:36:49.046597 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:36:49.046692 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.058106 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.058304 (MainThread): Using redshift connection "master".
2021-06-16 08:36:49.058434 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:36:49.181603 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:36:49.182714 (MainThread): On master: ROLLBACK
2021-06-16 08:36:49.183679 (MainThread): Using redshift connection "master".
2021-06-16 08:36:49.183808 (MainThread): On master: BEGIN
2021-06-16 08:36:49.185568 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.185709 (MainThread): On master: COMMIT
2021-06-16 08:36:49.185821 (MainThread): Using redshift connection "master".
2021-06-16 08:36:49.185922 (MainThread): On master: COMMIT
2021-06-16 08:36:49.186847 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.187023 (MainThread): On master: Close
2021-06-16 08:36:49.187624 (MainThread): 08:36:49 | Concurrency: 1 threads (target='dev')
2021-06-16 08:36:49.187968 (MainThread): 08:36:49 | 
2021-06-16 08:36:49.189741 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:36:49.190088 (Thread-1): 08:36:49 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:36:49.190651 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.190828 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:36:49.194779 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:36:49.195201 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.221458 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.221670 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:36:49.221792 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:36:49.221892 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.233414 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.240191 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.240349 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:36:49.241500 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.242639 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.242767 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.242874 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.244020 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.244159 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.244261 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:36:49.245181 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.245350 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.245453 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.245549 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.246440 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.246570 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.246667 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:36:49.247555 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.249408 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.249534 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:36:49.250547 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.251516 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.251649 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.251754 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.252692 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.252833 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.252933 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:36:49.253815 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.261193 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:36:49.261650 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.261781 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:36:49.264154 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:36:49.272293 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.272444 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:36:49.273643 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:36:49.276538 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.276682 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:36:49.277820 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:36:49.289214 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.289424 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.289574 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.291755 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.294275 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.294401 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:36:49.295368 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.298590 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.298717 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:36:49.300072 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.301058 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.301188 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.301294 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:36:49.303007 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.303150 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:36:49.303255 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:36:49.304186 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.304789 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.304961 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:36:49.305856 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:36:49.306455 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daa63cd0>]}
2021-06-16 08:36:49.306973 (Thread-1): 08:36:49 | 1 of 7 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.12s]
2021-06-16 08:36:49.307305 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:36:49.307510 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:36:49.307996 (Thread-1): 08:36:49 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:36:49.308439 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.308587 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:36:49.311860 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:36:49.312217 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.332472 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.332665 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:36:49.332787 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:36:49.332885 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.344281 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.346241 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.346372 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:36:49.347433 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.348466 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.348594 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.348707 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.349603 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.349737 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.349837 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:36:49.350722 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.350907 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.351019 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.351115 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.351998 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.352126 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.352222 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:36:49.353104 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.355037 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.355182 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:36:49.356165 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.357103 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.357233 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.357342 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.358249 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.358389 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.358493 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:36:49.359459 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.378950 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:36:49.379400 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.379530 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:36:49.381210 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:36:49.384126 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.384263 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:36:49.385323 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:36:49.388008 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.388143 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:36:49.389118 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:36:49.390411 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.390577 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.390686 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.392360 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.392633 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.392753 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:36:49.393696 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.395597 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.395730 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:36:49.397108 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.398024 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.398151 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.398257 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:36:49.401015 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.401154 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:36:49.401256 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:36:49.402153 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.402670 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.402840 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:36:49.403771 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:36:49.404357 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d81775d0>]}
2021-06-16 08:36:49.404825 (Thread-1): 08:36:49 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.10s]
2021-06-16 08:36:49.405122 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:36:49.405324 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:36:49.405802 (Thread-1): 08:36:49 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:36:49.406240 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.406392 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:36:49.410001 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:36:49.410323 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.412456 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.412590 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:36:49.412711 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:36:49.412809 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.424043 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.426035 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.426167 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:36:49.427268 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.428324 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:36:49.428453 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.428557 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:36:49.429465 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.429600 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.429700 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:36:49.430571 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.430736 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:36:49.430840 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.430961 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:36:49.431837 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.431965 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.432061 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:36:49.432937 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.434657 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.434790 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:36:49.435766 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.436710 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:36:49.436841 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.436960 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:36:49.437888 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.438033 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.438138 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:36:49.439019 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.439713 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:36:49.440041 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:36:49.440158 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:36:49.441237 (Thread-1): Postgres error: column "OrderID" does not exist
LINE 9:     , "OrderID" as order_id
              ^

2021-06-16 08:36:49.441371 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:36:49.442324 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.442495 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:36:49.443202 (Thread-1): Database Error in model cls_order_details (models/northwind_cls/cls_order_details.sql)
  column "OrderID" does not exist
  LINE 9:     , "OrderID" as order_id
                ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_order_details.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "OrderID" does not exist
LINE 9:     , "OrderID" as order_id
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_order_details (models/northwind_cls/cls_order_details.sql)
  column "OrderID" does not exist
  LINE 9:     , "OrderID" as order_id
                ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_order_details.sql
2021-06-16 08:36:49.445312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29da736290>]}
2021-06-16 08:36:49.445734 (Thread-1): 08:36:49 | 3 of 7 ERROR creating view model sifa_cleansing.cls_order_details.... [ERROR in 0.04s]
2021-06-16 08:36:49.446032 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:36:49.446237 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:36:49.446673 (Thread-1): 08:36:49 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:36:49.447121 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.447278 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:36:49.449528 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:36:49.449668 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.451710 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.451846 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:36:49.451959 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:36:49.452055 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.463190 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.465176 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.465312 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:36:49.466346 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.467447 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:36:49.467585 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.467695 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:36:49.468596 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.468753 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.468860 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:36:49.469738 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.469904 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:36:49.470013 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.470107 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:36:49.470966 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.471099 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.471196 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:36:49.472075 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.473853 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.473993 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:36:49.475008 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.475987 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:36:49.476140 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.476247 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:36:49.477127 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.477273 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.477376 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:36:49.478260 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.478994 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:36:49.479384 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:36:49.479502 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    
  ) ;

2021-06-16 08:36:49.480494 (Thread-1): Postgres error: syntax error at or near ")"
LINE 6:   ) ;
          ^

2021-06-16 08:36:49.480617 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:36:49.481561 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.481727 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:36:49.482208 (Thread-1): Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
  syntax error at or near ")"
  LINE 6:   ) ;
            ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 6:   ) ;
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
  syntax error at or near ")"
  LINE 6:   ) ;
            ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
2021-06-16 08:36:49.484652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d80d0fd0>]}
2021-06-16 08:36:49.485075 (Thread-1): 08:36:49 | 4 of 7 ERROR creating view model sifa_cleansing.cls_orders........... [ERROR in 0.04s]
2021-06-16 08:36:49.485363 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:36:49.485573 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:36:49.485983 (Thread-1): 08:36:49 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:36:49.486412 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.486573 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:36:49.488819 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:36:49.488962 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.541081 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.541279 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:36:49.541402 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:36:49.541506 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.552783 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.554725 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.554856 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:36:49.556004 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.557031 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:36:49.557173 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.557280 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:36:49.558269 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.558410 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.558510 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:36:49.559419 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.559589 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:36:49.559693 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.559787 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:36:49.560680 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.560808 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.560906 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:36:49.561773 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.563564 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.563697 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:36:49.564667 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.565620 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:36:49.565746 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.565851 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:36:49.566785 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.566938 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.567045 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:36:49.567933 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.568931 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:36:49.569315 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:36:49.569434 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    
  );
2021-06-16 08:36:49.570406 (Thread-1): Postgres error: syntax error at or near ")"
LINE 10:   );
           ^

2021-06-16 08:36:49.570529 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:36:49.571467 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.571637 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:36:49.572123 (Thread-1): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 10:   );
           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:36:49.572775 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29dab86890>]}
2021-06-16 08:36:49.573170 (Thread-1): 08:36:49 | 5 of 7 ERROR creating table model sifa_core.fact_orders.............. [ERROR in 0.09s]
2021-06-16 08:36:49.573472 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:36:49.573669 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:36:49.574080 (Thread-1): 08:36:49 | 6 of 7 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:36:49.574507 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.574665 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:36:49.578253 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:36:49.578595 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.580439 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.580580 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:36:49.580700 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:36:49.580794 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.592283 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.594304 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.594432 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:36:49.595500 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.596484 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.596616 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.596722 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.597657 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.597791 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.597891 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:36:49.598788 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.598973 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.599094 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.599188 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.600092 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.600218 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.600313 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:36:49.601322 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.603058 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.603187 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:36:49.604221 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.605144 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.605270 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.605376 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.606287 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.606430 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.606533 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:36:49.607383 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.608347 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:36:49.608730 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.608849 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:36:49.610963 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:36:49.613618 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.613748 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:36:49.614807 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:36:49.617264 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.617389 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:36:49.618401 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:36:49.619778 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.619911 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.620016 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.621878 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.622195 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.622330 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:36:49.623319 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.625064 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.625193 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:36:49.626462 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:36:49.627403 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.627543 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.627651 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:36:49.630532 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.630669 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:36:49.630771 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:36:49.631702 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.632237 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.632405 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:36:49.633301 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:36:49.633887 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29dab86910>]}
2021-06-16 08:36:49.634318 (Thread-1): 08:36:49 | 6 of 7 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.06s]
2021-06-16 08:36:49.634661 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:36:49.634866 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:36:49.635257 (Thread-1): 08:36:49 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:36:49.635677 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.635825 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:36:49.638950 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:36:49.639313 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.641367 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.641535 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:36:49.641650 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:36:49.641747 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.653686 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.655626 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.655754 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:36:49.656808 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.657921 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.658055 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.658159 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.659069 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.659208 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.659316 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:36:49.660250 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.660434 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.660537 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.660638 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.661533 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.661658 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.661753 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:36:49.662629 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.664221 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.664346 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:36:49.665277 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.666170 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.666307 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.666414 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.667326 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.667471 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.667572 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:36:49.668454 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.669091 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:36:49.669461 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.669577 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:36:49.671356 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:36:49.673961 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.674096 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:36:49.675127 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:36:49.676363 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.676488 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.676596 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.678471 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.678723 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.678831 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:36:49.679781 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.682930 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.683062 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:36:49.684044 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:36:49.684936 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.685061 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.685165 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:36:49.686048 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.686183 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:36:49.686284 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:36:49.687173 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:36:49.687687 (Thread-1): finished collecting timing info
2021-06-16 08:36:49.687851 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:36:49.688746 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:36:49.689290 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f1add3-a5dd-4b3d-acc9-779cc5a3439c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daad3a10>]}
2021-06-16 08:36:49.689734 (Thread-1): 08:36:49 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:36:49.690039 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:36:49.742385 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:36:49.742641 (MainThread): Using redshift connection "master".
2021-06-16 08:36:49.742752 (MainThread): On master: BEGIN
2021-06-16 08:36:49.742861 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:36:49.742992 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:36:49.754936 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:36:49.755122 (MainThread): On master: COMMIT
2021-06-16 08:36:49.755243 (MainThread): Using redshift connection "master".
2021-06-16 08:36:49.755350 (MainThread): On master: COMMIT
2021-06-16 08:36:49.756320 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:36:49.756461 (MainThread): On master: Close
2021-06-16 08:36:49.756989 (MainThread): 08:36:49 | 
2021-06-16 08:36:49.757295 (MainThread): 08:36:49 | Finished running 4 view models, 3 table models in 0.86s.
2021-06-16 08:36:49.757526 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:36:49.757640 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:36:49.757732 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:36:49.763293 (MainThread): 
2021-06-16 08:36:49.763542 (MainThread): Completed with 3 errors and 0 warnings:
2021-06-16 08:36:49.763773 (MainThread): 
2021-06-16 08:36:49.764051 (MainThread): Database Error in model cls_order_details (models/northwind_cls/cls_order_details.sql)
2021-06-16 08:36:49.764294 (MainThread):   column "OrderID" does not exist
2021-06-16 08:36:49.764489 (MainThread):   LINE 9:     , "OrderID" as order_id
2021-06-16 08:36:49.764718 (MainThread):                 ^
2021-06-16 08:36:49.764913 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_order_details.sql
2021-06-16 08:36:49.765102 (MainThread): 
2021-06-16 08:36:49.765286 (MainThread): Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
2021-06-16 08:36:49.765459 (MainThread):   syntax error at or near ")"
2021-06-16 08:36:49.765626 (MainThread):   LINE 6:   ) ;
2021-06-16 08:36:49.765791 (MainThread):             ^
2021-06-16 08:36:49.765962 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
2021-06-16 08:36:49.766134 (MainThread): 
2021-06-16 08:36:49.766314 (MainThread): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
2021-06-16 08:36:49.766496 (MainThread):   syntax error at or near ")"
2021-06-16 08:36:49.766660 (MainThread):   LINE 10:   );
2021-06-16 08:36:49.766826 (MainThread):              ^
2021-06-16 08:36:49.767027 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:36:49.767223 (MainThread): 
Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
2021-06-16 08:36:49.767513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daadd510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daac3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29daaf5ed0>]}
2021-06-16 08:36:49.767758 (MainThread): Flushing usage events
2021-06-16 08:37:26.192741 (MainThread): Running with dbt=0.19.1
2021-06-16 08:37:26.433195 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:37:26.433712 (MainThread): Tracking: tracking
2021-06-16 08:37:26.439501 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5da046110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5da046b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5da046e90>]}
2021-06-16 08:37:26.460012 (MainThread): Partial parsing not enabled
2021-06-16 08:37:26.461369 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:37:26.501684 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:37:26.520941 (MainThread): Parsing macros/relations.sql
2021-06-16 08:37:26.521942 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:37:26.523311 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:37:26.553826 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:37:26.557318 (MainThread): Parsing macros/relations.sql
2021-06-16 08:37:26.559297 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:37:26.562800 (MainThread): Parsing macros/core.sql
2021-06-16 08:37:26.568874 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:37:26.633231 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:37:26.646677 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:37:26.648120 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:37:26.650589 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:37:26.653591 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:37:26.656125 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:37:26.657754 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:37:26.671484 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:37:26.693013 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:37:26.695958 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:37:26.705854 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:37:26.737585 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:37:26.782533 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:37:26.785312 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:37:26.812919 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:37:26.823248 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:37:26.831042 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:37:26.840487 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:37:26.844752 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:37:26.847230 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:37:26.850119 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:37:26.861055 (MainThread): Partial parsing not enabled
2021-06-16 08:37:26.900770 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:26.916771 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:26.922622 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:26.927210 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:37:26.929367 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:26.932354 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:37:26.934249 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:26.938864 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:37:26.940850 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:26.945510 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:37:26.947657 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:26.951006 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:37:27.101512 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:37:27.112848 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d9e96dd0>]}
2021-06-16 08:37:27.119285 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d9e40c10>]}
2021-06-16 08:37:27.119642 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:37:27.121185 (MainThread): 
2021-06-16 08:37:27.121675 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:37:27.123233 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:37:27.139983 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:37:27.140175 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:37:27.140292 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:37:27.140390 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.165136 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:37:27.168633 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:37:27.169343 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:37:27.171364 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:37:27.171495 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:37:27.171607 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:37:27.171701 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.207904 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.04 seconds
2021-06-16 08:37:27.208616 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:37:27.209299 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:37:27.211424 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:37:27.211557 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:37:27.211670 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:37:27.211773 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.258379 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.05 seconds
2021-06-16 08:37:27.259105 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:37:27.261686 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:37:27.271445 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:37:27.271609 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:37:27.271723 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:37:27.271817 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.346113 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.07 seconds
2021-06-16 08:37:27.346347 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:37:27.346464 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:37:27.349256 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:37:27.350109 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:37:27.351303 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:37:27.351959 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:37:27.354290 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:37:27.354421 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:37:27.354535 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:37:27.354632 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.438969 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.08 seconds
2021-06-16 08:37:27.439209 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:37:27.439325 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:37:27.441997 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:37:27.442759 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:37:27.443702 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:37:27.444411 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:37:27.446497 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:37:27.446631 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:37:27.446742 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:37:27.446835 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.512211 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.07 seconds
2021-06-16 08:37:27.512459 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:37:27.512584 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:37:27.515300 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:37:27.516265 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:37:27.517214 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:37:27.524044 (MainThread): Using redshift connection "master".
2021-06-16 08:37:27.524220 (MainThread): On master: BEGIN
2021-06-16 08:37:27.524342 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:37:27.524446 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.620760 (MainThread): SQL status: BEGIN in 0.10 seconds
2021-06-16 08:37:27.620989 (MainThread): Using redshift connection "master".
2021-06-16 08:37:27.621103 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:37:27.744703 (MainThread): SQL status: SELECT 6 in 0.12 seconds
2021-06-16 08:37:27.745832 (MainThread): On master: ROLLBACK
2021-06-16 08:37:27.746883 (MainThread): Using redshift connection "master".
2021-06-16 08:37:27.747053 (MainThread): On master: BEGIN
2021-06-16 08:37:27.748864 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.749014 (MainThread): On master: COMMIT
2021-06-16 08:37:27.749126 (MainThread): Using redshift connection "master".
2021-06-16 08:37:27.749227 (MainThread): On master: COMMIT
2021-06-16 08:37:27.750169 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.750311 (MainThread): On master: Close
2021-06-16 08:37:27.750920 (MainThread): 08:37:27 | Concurrency: 1 threads (target='dev')
2021-06-16 08:37:27.751282 (MainThread): 08:37:27 | 
2021-06-16 08:37:27.753291 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:37:27.753645 (Thread-1): 08:37:27 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:37:27.753984 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.754160 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:37:27.758151 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:37:27.758515 (Thread-1): finished collecting timing info
2021-06-16 08:37:27.784820 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.785023 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:37:27.785142 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:37:27.785241 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.802681 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:37:27.809497 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.809660 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:37:27.810768 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:27.811929 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.812063 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.812170 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.813078 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.813217 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.813318 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:37:27.814204 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.814390 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.814498 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.814597 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.815548 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.815692 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.815796 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:37:27.817191 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.819065 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.819196 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:37:27.821233 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:27.822191 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.822323 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.822432 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.825163 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.825304 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.825420 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:37:27.830155 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.837232 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:37:27.837656 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.837778 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:37:27.841319 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:37:27.849513 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.849662 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:37:27.850881 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:27.853680 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.853849 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:37:27.854997 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:27.866557 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.866764 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.866904 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.869620 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.872414 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.872560 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:37:27.873537 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.877044 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.877192 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:37:27.878674 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:27.879754 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.879890 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.879998 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:37:27.881742 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.881881 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:37:27.881981 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:37:27.882930 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.883594 (Thread-1): finished collecting timing info
2021-06-16 08:37:27.883764 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:37:27.884666 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:37:27.885246 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dcce7a10>]}
2021-06-16 08:37:27.885753 (Thread-1): 08:37:27 | 1 of 7 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.13s]
2021-06-16 08:37:27.886050 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:37:27.886249 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:37:27.886741 (Thread-1): 08:37:27 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:37:27.887212 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.887386 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:37:27.890687 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:37:27.891085 (Thread-1): finished collecting timing info
2021-06-16 08:37:27.911632 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.911841 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:37:27.911957 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:37:27.912053 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:27.952742 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-06-16 08:37:27.954912 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.955121 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:37:27.958343 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:27.959400 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:27.959534 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.959640 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:27.962424 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.962560 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.962658 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:37:27.965482 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.965672 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:27.965777 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.965876 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:27.967521 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.967656 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.967755 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:37:27.968836 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.970826 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.970979 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:37:27.972175 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:27.973168 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:27.973295 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.973421 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:27.974744 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:27.974897 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.975024 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:37:27.975912 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:27.995825 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:37:27.996344 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:27.996471 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:37:27.998312 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:37:28.001216 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:28.001362 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:37:28.002742 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:28.005650 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:28.005789 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:37:28.006946 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:28.008290 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:28.008417 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:28.008519 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:28.010329 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.010642 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:28.010764 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:37:28.011728 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.013785 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:28.013917 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:37:28.015400 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:28.016439 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:28.016581 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:28.016687 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:37:28.019960 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.020149 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:37:28.020263 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:37:28.021989 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.022626 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.022804 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:37:28.024962 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:37:28.025602 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d9b83c50>]}
2021-06-16 08:37:28.026053 (Thread-1): 08:37:28 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.14s]
2021-06-16 08:37:28.026338 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:37:28.026558 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:37:28.027091 (Thread-1): 08:37:28 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:37:28.027539 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.027697 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:37:28.031544 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:37:28.031932 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.034236 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.034372 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:37:28.034487 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:37:28.034585 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:28.051202 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:37:28.053403 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.053554 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:37:28.054709 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.055957 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.056135 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.056254 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.057182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.057321 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.057423 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:37:28.058466 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.058648 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.058755 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.058861 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.059818 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.059949 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.060049 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:37:28.060938 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.062681 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.062810 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:37:28.063875 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.064845 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.064976 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.065083 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.066148 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.066283 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.066394 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:37:28.067389 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.068100 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:37:28.068490 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.068610 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:37:28.070526 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:37:28.073250 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.073394 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:37:28.074513 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:28.075866 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.075997 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.076104 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.077843 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.078118 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.078231 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:37:28.079134 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.080970 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.081097 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:37:28.082079 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.083027 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.083161 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.083268 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:37:28.084177 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.084318 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:37:28.084423 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:37:28.085350 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.085888 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.086057 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:37:28.086944 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:37:28.087501 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d9bed510>]}
2021-06-16 08:37:28.087951 (Thread-1): 08:37:28 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:37:28.088253 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:37:28.088443 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:37:28.088853 (Thread-1): 08:37:28 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:37:28.089261 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.089410 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:37:28.091829 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:37:28.091974 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.093863 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.093998 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:37:28.094113 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:37:28.094211 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:28.113217 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:37:28.116876 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.117052 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:37:28.119791 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.120897 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:37:28.121029 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.121136 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:37:28.123322 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.123482 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.123588 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:37:28.124545 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.124726 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:37:28.124835 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.124931 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:37:28.125878 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.126022 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.126121 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:37:28.130011 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.183961 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.184165 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:37:28.185266 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.186286 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:37:28.186425 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.186531 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:37:28.187492 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.187637 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.187739 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:37:28.188810 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.189489 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:37:28.189877 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:37:28.189997 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    
  ) ;

2021-06-16 08:37:28.191035 (Thread-1): Postgres error: syntax error at or near ")"
LINE 6:   ) ;
          ^

2021-06-16 08:37:28.191163 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:37:28.192103 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.192277 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:37:28.192763 (Thread-1): Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
  syntax error at or near ")"
  LINE 6:   ) ;
            ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 6:   ) ;
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
  syntax error at or near ")"
  LINE 6:   ) ;
            ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
2021-06-16 08:37:28.194775 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5da0dccd0>]}
2021-06-16 08:37:28.195249 (Thread-1): 08:37:28 | 4 of 7 ERROR creating view model sifa_cleansing.cls_orders........... [ERROR in 0.11s]
2021-06-16 08:37:28.195551 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:37:28.195749 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:37:28.196182 (Thread-1): 08:37:28 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:37:28.196613 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.196768 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:37:28.199320 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:37:28.199470 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.201209 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.201338 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:37:28.201448 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:37:28.201551 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:28.232337 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-06-16 08:37:28.234508 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.234640 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:37:28.235718 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:28.236740 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:37:28.236867 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.236970 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:37:28.237926 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.238064 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.238163 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:37:28.239103 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.239275 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:37:28.239386 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.239480 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:37:28.240382 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.240509 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.240605 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:37:28.241513 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.243408 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.243539 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:37:28.244608 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:28.245564 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:37:28.245689 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.245792 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:37:28.246754 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.246918 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.247043 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:37:28.247982 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.249013 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:37:28.249417 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:37:28.249544 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    
  );
2021-06-16 08:37:28.250633 (Thread-1): Postgres error: syntax error at or near ")"
LINE 10:   );
           ^

2021-06-16 08:37:28.250757 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:37:28.251675 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.251842 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:37:28.252319 (Thread-1): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 10:   );
           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:37:28.252947 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dcd08290>]}
2021-06-16 08:37:28.253339 (Thread-1): 08:37:28 | 5 of 7 ERROR creating table model sifa_core.fact_orders.............. [ERROR in 0.06s]
2021-06-16 08:37:28.253626 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:37:28.253813 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:37:28.254201 (Thread-1): 08:37:28 | 6 of 7 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:37:28.254607 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.254757 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:37:28.258267 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:37:28.258593 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.260487 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.260621 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:37:28.260731 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:37:28.260824 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:28.272543 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:37:28.274652 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.274780 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:37:28.275802 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:28.276811 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.276937 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.277039 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.277953 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.278085 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.278183 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:37:28.279235 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.279462 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.279586 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.279695 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.280634 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.280771 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.280873 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:37:28.281902 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.283761 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.283934 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:37:28.285037 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:28.285994 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.286122 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.286227 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.287141 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.287289 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.287395 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:37:28.288306 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.289294 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:37:28.289698 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.289819 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:37:28.292419 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:37:28.295216 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.295348 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:37:28.297298 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:28.300032 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.300185 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:37:28.305184 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:28.306614 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.306752 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.306864 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.311196 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.311479 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.311592 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:37:28.315324 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.317304 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.317446 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:37:28.319776 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:37:28.320804 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.320934 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.321041 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:37:28.325052 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.325193 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:37:28.325295 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:37:28.326260 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.326917 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.327101 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:37:28.328119 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:37:28.328709 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d9c06090>]}
2021-06-16 08:37:28.329173 (Thread-1): 08:37:28 | 6 of 7 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.07s]
2021-06-16 08:37:28.329472 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:37:28.329662 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:37:28.330017 (Thread-1): 08:37:28 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:37:28.330427 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.330579 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:37:28.333625 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:37:28.333980 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.336104 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.336246 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:37:28.336361 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:37:28.336458 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:28.348212 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:37:28.350397 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.350529 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:37:28.351551 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.352580 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.352709 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.352815 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.353703 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.353840 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.353941 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:37:28.354910 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.355126 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.355234 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.355331 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.356288 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.356424 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.356533 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:37:28.357474 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.359343 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.359474 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:37:28.360449 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.361401 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.361546 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.361653 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.362615 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.362750 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.362860 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:37:28.363843 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.366635 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:37:28.367072 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.367199 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:37:28.369064 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:37:28.371746 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.371883 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:37:28.373016 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:37:28.374365 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.374495 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.374601 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.376331 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.376623 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.376739 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:37:28.377761 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.379613 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.379745 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:37:28.380748 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:37:28.381656 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.381782 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.381886 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:37:28.382840 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.383003 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:37:28.383105 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:37:28.384471 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:37:28.385035 (Thread-1): finished collecting timing info
2021-06-16 08:37:28.385207 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:37:28.387557 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:37:28.388126 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be991f06-cc8e-47a2-8936-555c5f9a5787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5da550150>]}
2021-06-16 08:37:28.388544 (Thread-1): 08:37:28 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.06s]
2021-06-16 08:37:28.388810 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:37:28.485017 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:37:28.485292 (MainThread): Using redshift connection "master".
2021-06-16 08:37:28.485412 (MainThread): On master: BEGIN
2021-06-16 08:37:28.485539 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:37:28.485636 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:37:28.506515 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 08:37:28.506769 (MainThread): On master: COMMIT
2021-06-16 08:37:28.506910 (MainThread): Using redshift connection "master".
2021-06-16 08:37:28.507028 (MainThread): On master: COMMIT
2021-06-16 08:37:28.508153 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:37:28.508319 (MainThread): On master: Close
2021-06-16 08:37:28.508954 (MainThread): 08:37:28 | 
2021-06-16 08:37:28.509270 (MainThread): 08:37:28 | Finished running 4 view models, 3 table models in 1.39s.
2021-06-16 08:37:28.509511 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:37:28.509630 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:37:28.509732 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:37:28.515383 (MainThread): 
2021-06-16 08:37:28.515676 (MainThread): Completed with 2 errors and 0 warnings:
2021-06-16 08:37:28.515928 (MainThread): 
2021-06-16 08:37:28.516241 (MainThread): Database Error in model cls_orders (models/northwind_cls/cls_orders.sql)
2021-06-16 08:37:28.516461 (MainThread):   syntax error at or near ")"
2021-06-16 08:37:28.516699 (MainThread):   LINE 6:   ) ;
2021-06-16 08:37:28.516901 (MainThread):             ^
2021-06-16 08:37:28.517087 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_orders.sql
2021-06-16 08:37:28.517329 (MainThread): 
2021-06-16 08:37:28.517531 (MainThread): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
2021-06-16 08:37:28.517741 (MainThread):   syntax error at or near ")"
2021-06-16 08:37:28.517908 (MainThread):   LINE 10:   );
2021-06-16 08:37:28.518073 (MainThread):              ^
2021-06-16 08:37:28.518236 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:37:28.518428 (MainThread): 
Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
2021-06-16 08:37:28.518704 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dcd039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d9bfb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d9c79ad0>]}
2021-06-16 08:37:28.518992 (MainThread): Flushing usage events
2021-06-16 08:38:27.643159 (MainThread): Running with dbt=0.19.1
2021-06-16 08:38:27.884169 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:38:27.884657 (MainThread): Tracking: tracking
2021-06-16 08:38:27.890471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b85963c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8adc3f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b85972e10>]}
2021-06-16 08:38:27.910915 (MainThread): Partial parsing not enabled
2021-06-16 08:38:27.912164 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:38:27.952540 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:38:27.971589 (MainThread): Parsing macros/relations.sql
2021-06-16 08:38:27.972558 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:38:27.973894 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:38:28.004455 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:38:28.008072 (MainThread): Parsing macros/relations.sql
2021-06-16 08:38:28.010041 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:38:28.013654 (MainThread): Parsing macros/core.sql
2021-06-16 08:38:28.019779 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:38:28.085328 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:38:28.099133 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:38:28.100629 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:38:28.103156 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:38:28.106246 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:38:28.108802 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:38:28.110385 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:38:28.124253 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:38:28.145296 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:38:28.148133 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:38:28.157945 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:38:28.189653 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:38:28.235406 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:38:28.238175 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:38:28.265610 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:38:28.275744 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:38:28.283497 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:38:28.293090 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:38:28.297218 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:38:28.299592 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:38:28.302436 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:38:28.313012 (MainThread): Partial parsing not enabled
2021-06-16 08:38:28.351238 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:28.366717 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:28.372368 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.376768 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:28.378872 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:28.381957 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:28.383870 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:28.388374 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:28.390231 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:28.394474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:28.396411 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:28.399712 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:28.547956 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:38:28.559187 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8576d410>]}
2021-06-16 08:38:28.565386 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b85768450>]}
2021-06-16 08:38:28.565723 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:38:28.567217 (MainThread): 
2021-06-16 08:38:28.567690 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:38:28.569177 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:38:28.585500 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:38:28.585690 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:38:28.585812 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:38:28.585909 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.605659 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:38:28.609136 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:38:28.609820 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:38:28.611781 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:38:28.611910 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:38:28.612023 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:38:28.612117 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.623670 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:38:28.624189 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:38:28.624813 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:38:28.626746 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:38:28.626869 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:38:28.627020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:38:28.627115 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.638198 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:38:28.638708 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:38:28.641156 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:38:28.650748 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:38:28.650916 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:38:28.651041 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:38:28.651138 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.662181 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:28.662354 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:38:28.662464 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:38:28.665127 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:38:28.665857 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:38:28.666772 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:38:28.667396 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:38:28.669580 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:38:28.669707 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:38:28.669821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:38:28.669927 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.680746 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:28.680893 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:38:28.681004 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:38:28.683596 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:38:28.684213 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:38:28.685129 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:38:28.685721 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:38:28.687557 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:38:28.687686 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:38:28.687797 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:38:28.687890 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.701065 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:28.701219 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:38:28.701338 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:38:28.704050 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:38:28.704805 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:38:28.705713 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:38:28.712546 (MainThread): Using redshift connection "master".
2021-06-16 08:38:28.712679 (MainThread): On master: BEGIN
2021-06-16 08:38:28.712792 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:38:28.712896 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.724373 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:28.724545 (MainThread): Using redshift connection "master".
2021-06-16 08:38:28.724665 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:38:28.866118 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-06-16 08:38:28.867296 (MainThread): On master: ROLLBACK
2021-06-16 08:38:28.868297 (MainThread): Using redshift connection "master".
2021-06-16 08:38:28.868428 (MainThread): On master: BEGIN
2021-06-16 08:38:28.870159 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:28.870296 (MainThread): On master: COMMIT
2021-06-16 08:38:28.870408 (MainThread): Using redshift connection "master".
2021-06-16 08:38:28.870519 (MainThread): On master: COMMIT
2021-06-16 08:38:28.871414 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:28.871556 (MainThread): On master: Close
2021-06-16 08:38:28.872113 (MainThread): 08:38:28 | Concurrency: 1 threads (target='dev')
2021-06-16 08:38:28.872447 (MainThread): 08:38:28 | 
2021-06-16 08:38:28.874421 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:38:28.874737 (Thread-1): 08:38:28 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:38:28.875096 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.875264 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:38:28.879284 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:38:28.879664 (Thread-1): finished collecting timing info
2021-06-16 08:38:28.905915 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.906096 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:28.906224 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:28.906324 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:28.917756 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:28.924445 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.924592 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:38:28.925855 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:28.927036 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.927178 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.927287 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.928227 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:28.928372 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.928474 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:28.929344 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:28.929504 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.929606 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.929700 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.930592 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:28.930718 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.930814 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:28.931732 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:28.933378 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.933510 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:38:28.934488 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:28.935447 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.935580 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.935690 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.936571 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:28.936725 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.936826 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:28.937838 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:28.945030 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:38:28.945472 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.945602 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:38:28.947922 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:28.956266 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.956427 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:38:28.957613 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:28.960326 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.960458 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:38:28.961532 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:28.974333 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.974523 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.974641 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.976631 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:28.979091 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.979221 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:28.980128 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:28.981885 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.982009 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:38:28.983474 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:28.984432 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.984561 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.984670 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:28.986260 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:28.986399 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:28.986504 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:28.987522 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:28.988127 (Thread-1): finished collecting timing info
2021-06-16 08:38:28.988298 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:38:28.989300 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:38:28.989807 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b84415e10>]}
2021-06-16 08:38:28.990215 (Thread-1): 08:38:28 | 1 of 7 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 08:38:28.990490 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:38:28.990706 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:38:28.991186 (Thread-1): 08:38:28 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:38:28.991640 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:28.991785 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:38:28.994676 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:38:28.995069 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.015002 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.015188 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:29.015307 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:29.015434 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:29.026680 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:29.028607 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.028745 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:38:29.029778 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.030757 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.030909 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.031029 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.031926 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.032063 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.032164 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:29.033062 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.033223 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.033338 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.033438 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.035066 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.035200 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.035298 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:29.036220 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.037817 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.037947 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:38:29.038962 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.039865 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.039991 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.040096 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.041006 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.041142 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.041244 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:29.042152 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.061155 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:38:29.061576 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.061699 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:38:29.063441 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:38:29.066331 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.066456 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:38:29.067582 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.070019 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.070150 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:38:29.071102 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.072366 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.072491 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.072596 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.074321 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.074624 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.074774 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:29.075711 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.077453 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.077590 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:38:29.078970 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.079849 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.079974 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.080078 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:29.082903 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.083061 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:29.083164 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:29.084094 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.084596 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.084775 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:38:29.085657 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:38:29.086203 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b854e8ad0>]}
2021-06-16 08:38:29.086640 (Thread-1): 08:38:29 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.09s]
2021-06-16 08:38:29.086953 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:38:29.087144 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:38:29.087600 (Thread-1): 08:38:29 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:38:29.088003 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.088149 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:38:29.091750 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:38:29.092107 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.094005 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.094148 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:29.094265 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:29.094369 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:29.105483 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:29.107359 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.107490 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:38:29.108533 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.109521 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.109648 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.109765 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.110638 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.110772 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.110874 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:29.111793 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.111956 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.112060 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.112156 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.113053 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.113181 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.113279 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:29.114167 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.115955 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.116086 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:38:29.117117 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.118036 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.118165 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.118272 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.119181 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.119316 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.119424 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:29.120328 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.120987 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:38:29.121337 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.121454 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:38:29.123224 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:29.125939 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.126076 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:38:29.127156 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.129532 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.129660 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:38:29.130659 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.131966 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.132103 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.132208 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.133899 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.134175 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.134289 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:29.135230 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.136947 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.137071 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:38:29.138359 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.139279 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.139414 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.139520 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:29.140983 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.141114 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:29.141213 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:29.142106 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.142604 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.142773 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:38:29.143650 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:38:29.144192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b84435090>]}
2021-06-16 08:38:29.144632 (Thread-1): 08:38:29 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:38:29.144923 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:38:29.145109 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:38:29.145472 (Thread-1): 08:38:29 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:38:29.145891 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.146047 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:38:29.149864 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:38:29.150214 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.152095 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.152228 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:29.152339 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:29.152434 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:29.163931 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:29.213724 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.213924 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:38:29.215062 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.216066 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.216191 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.216295 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.217172 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.217305 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.217405 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:29.218282 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.218442 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.218544 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.218635 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.219484 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.219611 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.219708 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:29.220563 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.222275 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.222399 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:38:29.223336 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.224220 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.224345 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.224450 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.225355 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.225487 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.225587 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:29.226482 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.227159 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:38:29.227561 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.227679 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 1
  ) ;

2021-06-16 08:38:29.229238 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:29.231741 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.231880 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:38:29.232897 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.234129 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.234251 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.234354 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.236095 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.236351 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.236460 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:29.237323 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.239077 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.239215 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:38:29.240208 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.241103 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.241227 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.241332 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:29.242244 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.242382 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:29.242485 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:29.243352 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.243874 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.244051 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:38:29.244921 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:38:29.245475 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b859d4e90>]}
2021-06-16 08:38:29.245927 (Thread-1): 08:38:29 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.10s]
2021-06-16 08:38:29.246228 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:38:29.246414 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:38:29.246763 (Thread-1): 08:38:29 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:38:29.247182 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.247338 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:38:29.251699 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:38:29.251845 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.253549 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.253680 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:29.253794 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:29.253890 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:29.264847 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:29.266661 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.266784 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:38:29.267833 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.268831 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:29.268956 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.269059 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:29.269964 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.270101 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.270208 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:29.271139 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.271313 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:29.271418 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.271513 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:29.272445 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.272576 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.272683 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:29.273626 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.275387 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.275513 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:38:29.276492 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.277375 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:29.277497 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.277599 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:29.278460 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.278596 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.278698 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:29.279566 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.280545 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:38:29.280929 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:29.281046 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    
  );
2021-06-16 08:38:29.282016 (Thread-1): Postgres error: syntax error at or near ")"
LINE 10:   );
           ^

2021-06-16 08:38:29.282148 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:38:29.283131 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.283310 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:38:29.283785 (Thread-1): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 10:   );
           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:38:29.285825 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b89780790>]}
2021-06-16 08:38:29.286211 (Thread-1): 08:38:29 | 5 of 7 ERROR creating table model sifa_core.fact_orders.............. [ERROR in 0.04s]
2021-06-16 08:38:29.286494 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:38:29.286679 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:38:29.287112 (Thread-1): 08:38:29 | 6 of 7 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:38:29.287517 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.287667 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:38:29.291152 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:38:29.291455 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.293188 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.293316 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:29.293425 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:29.293516 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:29.304724 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:29.306733 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.306861 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:38:29.307959 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.309007 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.309133 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.309240 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.310134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.310287 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.310388 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:29.311251 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.311420 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.311520 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.311612 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.312491 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.312621 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.312717 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:29.313566 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.315321 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.315462 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:38:29.316428 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.317353 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.317480 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.317586 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.318484 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.318620 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.318722 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:29.319617 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.320570 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:38:29.320953 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.321069 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:38:29.323131 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:38:29.325900 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.326032 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:38:29.327097 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.329511 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.329634 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:38:29.330681 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.332057 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.332184 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.332287 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.333964 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.334223 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.334331 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:29.335232 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.336909 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.337032 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:38:29.338253 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:29.339166 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.339304 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.339432 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:29.342318 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.342447 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:29.342545 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:29.344336 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.344835 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.345000 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:38:29.345875 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:38:29.346432 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b856d6650>]}
2021-06-16 08:38:29.346875 (Thread-1): 08:38:29 | 6 of 7 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.06s]
2021-06-16 08:38:29.347197 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:38:29.347398 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:38:29.347751 (Thread-1): 08:38:29 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:38:29.348162 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.348317 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:38:29.352991 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:38:29.353315 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.355264 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.355413 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:29.355526 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:29.355623 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:29.366891 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:29.368724 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.368853 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:38:29.369995 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.371121 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.371252 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.371368 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.372247 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.372380 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.372482 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:29.373378 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.373541 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.373644 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.373738 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.374610 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.374736 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.374834 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:29.375726 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.377463 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.377592 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:38:29.378550 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.379481 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.379615 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.379725 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.380631 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.380766 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.380868 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:29.381761 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.382391 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:38:29.382751 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.382870 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:38:29.384655 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:29.387219 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.387359 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:38:29.389312 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:29.390550 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.390674 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.390778 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.392399 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.392664 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.392774 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:29.393676 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.395445 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.395577 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:38:29.396574 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:29.397468 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.397596 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.397706 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:29.398607 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.398743 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:29.398847 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:29.399762 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:29.400258 (Thread-1): finished collecting timing info
2021-06-16 08:38:29.400423 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:38:29.401315 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:38:29.401843 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c58860-96f6-452f-87a8-2de3beabf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b85933d50>]}
2021-06-16 08:38:29.402320 (Thread-1): 08:38:29 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:38:29.402608 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:38:29.413118 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:38:29.413302 (MainThread): Using redshift connection "master".
2021-06-16 08:38:29.413411 (MainThread): On master: BEGIN
2021-06-16 08:38:29.413516 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:38:29.413609 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:29.424999 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:29.425162 (MainThread): On master: COMMIT
2021-06-16 08:38:29.425278 (MainThread): Using redshift connection "master".
2021-06-16 08:38:29.425418 (MainThread): On master: COMMIT
2021-06-16 08:38:29.426298 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:29.426438 (MainThread): On master: Close
2021-06-16 08:38:29.426969 (MainThread): 08:38:29 | 
2021-06-16 08:38:29.427281 (MainThread): 08:38:29 | Finished running 4 view models, 3 table models in 0.86s.
2021-06-16 08:38:29.427526 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:38:29.427638 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:38:29.427735 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:38:29.433076 (MainThread): 
2021-06-16 08:38:29.433324 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:38:29.433590 (MainThread): 
2021-06-16 08:38:29.433846 (MainThread): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
2021-06-16 08:38:29.434117 (MainThread):   syntax error at or near ")"
2021-06-16 08:38:29.434331 (MainThread):   LINE 10:   );
2021-06-16 08:38:29.434547 (MainThread):              ^
2021-06-16 08:38:29.434742 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:38:29.434967 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-06-16 08:38:29.435239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b84406cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e2e6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8862f410>]}
2021-06-16 08:38:29.435498 (MainThread): Flushing usage events
2021-06-16 08:38:46.948566 (MainThread): Running with dbt=0.19.1
2021-06-16 08:38:47.192388 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:38:47.192874 (MainThread): Tracking: tracking
2021-06-16 08:38:47.198512 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc271b4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc271b4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc271b4fd0>]}
2021-06-16 08:38:47.218378 (MainThread): Partial parsing not enabled
2021-06-16 08:38:47.219520 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:38:47.258867 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:38:47.277648 (MainThread): Parsing macros/relations.sql
2021-06-16 08:38:47.278614 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:38:47.279981 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:38:47.309702 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:38:47.313119 (MainThread): Parsing macros/relations.sql
2021-06-16 08:38:47.315083 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:38:47.318696 (MainThread): Parsing macros/core.sql
2021-06-16 08:38:47.324771 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:38:47.389506 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:38:47.403024 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:38:47.404516 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:38:47.407109 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:38:47.410075 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:38:47.412561 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:38:47.414172 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:38:47.428065 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:38:47.448944 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:38:47.451759 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:38:47.461455 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:38:47.492905 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:38:47.537849 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:38:47.540582 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:38:47.567944 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:38:47.578030 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:38:47.585710 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:38:47.595063 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:38:47.599191 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:38:47.601517 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:38:47.604405 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:38:47.615089 (MainThread): Partial parsing not enabled
2021-06-16 08:38:47.653140 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:47.668438 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:47.674170 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:47.678638 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:47.680766 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:47.683867 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:47.685742 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:47.690302 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:47.692235 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:47.696518 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:47.698416 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:47.701591 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:38:47.848580 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:38:47.860101 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc26ff9310>]}
2021-06-16 08:38:47.866447 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc26ff9310>]}
2021-06-16 08:38:47.866820 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:38:47.868388 (MainThread): 
2021-06-16 08:38:47.868862 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:38:47.870385 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:38:47.886605 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:38:47.886781 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:38:47.886917 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:38:47.887023 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:47.905107 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:38:47.908458 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:38:47.909139 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:38:47.911082 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:38:47.911222 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:38:47.911333 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:38:47.911427 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:47.922940 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:38:47.923470 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:38:47.924071 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:38:47.926029 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:38:47.926155 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:38:47.926266 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:38:47.926360 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:47.937858 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:38:47.938452 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:38:47.940996 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:38:47.950785 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:38:47.950957 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:38:47.951079 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:38:47.951175 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:47.962760 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:47.962949 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:38:47.963068 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:38:47.965715 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:38:47.966507 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:38:47.967485 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:38:47.968143 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:38:47.970354 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:38:47.970487 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:38:47.970605 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:38:47.970700 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:47.981704 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:47.981857 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:38:47.981971 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:38:47.984585 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 08:38:47.985290 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:38:47.986206 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:38:47.986826 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:38:47.988934 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:38:47.989066 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:38:47.989175 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:38:47.989279 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.002836 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.003027 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:38:48.003140 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:38:48.005811 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:38:48.006452 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:38:48.007404 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:38:48.013809 (MainThread): Using redshift connection "master".
2021-06-16 08:38:48.013947 (MainThread): On master: BEGIN
2021-06-16 08:38:48.014064 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:38:48.014163 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.026973 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.027132 (MainThread): Using redshift connection "master".
2021-06-16 08:38:48.027248 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:38:48.166973 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-06-16 08:38:48.168085 (MainThread): On master: ROLLBACK
2021-06-16 08:38:48.169143 (MainThread): Using redshift connection "master".
2021-06-16 08:38:48.169273 (MainThread): On master: BEGIN
2021-06-16 08:38:48.171071 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.171215 (MainThread): On master: COMMIT
2021-06-16 08:38:48.171326 (MainThread): Using redshift connection "master".
2021-06-16 08:38:48.171427 (MainThread): On master: COMMIT
2021-06-16 08:38:48.172349 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.172500 (MainThread): On master: Close
2021-06-16 08:38:48.173058 (MainThread): 08:38:48 | Concurrency: 1 threads (target='dev')
2021-06-16 08:38:48.173361 (MainThread): 08:38:48 | 
2021-06-16 08:38:48.175437 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:38:48.175762 (Thread-1): 08:38:48 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:38:48.176103 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.176272 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:38:48.180215 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:38:48.180574 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.206510 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.206710 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:48.206833 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:48.206981 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.218498 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.224878 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.225019 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:38:48.226116 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.227312 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.227458 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.227570 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.228488 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.228626 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.228729 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:48.229621 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.229787 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.229891 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.229986 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.230946 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.231099 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.231199 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:48.232116 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.233704 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.233828 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:38:48.234840 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.235732 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.235866 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.235971 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.236963 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.237098 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.237206 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:48.238212 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.245029 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:38:48.245423 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.245544 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:38:48.247777 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:48.255471 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.255607 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:38:48.256781 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.259256 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.259399 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:38:48.261125 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.273843 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.274002 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.274109 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.275788 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.278202 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.278333 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:48.279347 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.281074 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.281206 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:38:48.282567 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.283530 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.283662 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.283769 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:38:48.285452 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.285586 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:38:48.285687 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:38:48.286625 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.287233 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.287427 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:38:48.288381 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:38:48.288948 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc26ca6f50>]}
2021-06-16 08:38:48.289406 (Thread-1): 08:38:48 | 1 of 7 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 08:38:48.289696 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:38:48.289885 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:38:48.290324 (Thread-1): 08:38:48 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:38:48.290735 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.290906 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:38:48.293852 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:38:48.294197 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.314120 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.314320 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:48.314441 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:48.314548 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.328832 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.330940 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.331084 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:38:48.332109 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.333095 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.333230 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.333337 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.334223 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.334361 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.334474 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:48.335337 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.335505 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.335610 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.335706 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.336577 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.336704 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.336800 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:48.337655 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.339332 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.339466 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:38:48.340455 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.341353 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.341480 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.341585 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.342479 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.342613 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.342715 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:48.343569 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.362947 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:38:48.363396 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.363524 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:38:48.365459 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:38:48.368481 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.368633 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:38:48.369717 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.372179 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.372311 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:38:48.373333 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.374630 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.374768 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.374908 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.377390 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.377667 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.377792 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:48.378731 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.380531 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.380661 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:38:48.382116 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.383028 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.383160 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.383268 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:38:48.386334 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.386487 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:38:48.386604 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:38:48.387515 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.388078 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.388246 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:38:48.389178 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:38:48.389735 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc26cde450>]}
2021-06-16 08:38:48.390184 (Thread-1): 08:38:48 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.10s]
2021-06-16 08:38:48.390473 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:38:48.390668 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:38:48.391153 (Thread-1): 08:38:48 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:38:48.391570 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.391718 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:38:48.395535 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:38:48.395898 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.397911 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.398053 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:48.398164 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:48.398259 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.409770 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.411819 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.411957 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:38:48.413016 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.414072 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.414205 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.414314 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.415240 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.415380 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.415496 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:48.416454 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.416635 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.416736 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.416830 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.417730 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.417862 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.417962 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:48.418867 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.420579 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.420704 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:38:48.421724 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.422634 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.422759 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.422864 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.423861 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.423999 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.424125 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:48.425113 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.425806 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:38:48.426200 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.426323 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:38:48.428229 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:48.430965 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.431096 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:38:48.432299 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.434722 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.434859 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:38:48.435961 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.437306 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.437437 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.437545 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.439667 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.439944 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.440055 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:48.441003 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.442720 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.442844 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:38:48.444179 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.445076 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.445214 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.445323 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:38:48.446820 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.446991 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:38:48.447099 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:38:48.448059 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.448559 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.448725 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:38:48.449735 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:38:48.450279 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc24840450>]}
2021-06-16 08:38:48.450728 (Thread-1): 08:38:48 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:38:48.451031 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:38:48.451226 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:38:48.451571 (Thread-1): 08:38:48 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:38:48.451982 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.452135 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:38:48.456106 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:38:48.456469 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.458362 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.458497 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:48.458610 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:48.458705 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.469980 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.520674 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.520866 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:38:48.522043 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.523051 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.523186 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.523293 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.524213 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.524353 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.524457 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:48.525341 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.525523 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.525628 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.525725 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.526877 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.527047 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.527149 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:48.530515 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.532290 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.532419 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:38:48.533444 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.534380 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.534518 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.534628 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.535537 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.535680 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.535793 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:48.536701 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.537363 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:38:48.537753 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.537882 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 1
  ) ;

2021-06-16 08:38:48.539507 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:48.542149 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.542273 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 08:38:48.543396 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.545910 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.546037 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:38:48.547053 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.548356 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.548486 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.548594 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.550420 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.550675 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.550784 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:48.551690 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.553429 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.553563 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:38:48.554849 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.555757 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.555883 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.555989 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:38:48.557430 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.557563 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:38:48.557664 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:38:48.558646 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.559178 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.559362 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:38:48.560243 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:38:48.560782 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc27252c90>]}
2021-06-16 08:38:48.561233 (Thread-1): 08:38:48 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.11s]
2021-06-16 08:38:48.561518 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:38:48.561706 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:38:48.562045 (Thread-1): 08:38:48 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:38:48.562468 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.562618 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:38:48.564819 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:38:48.564963 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.566847 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.567020 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:48.567135 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:48.567230 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.579889 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.581610 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.581745 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:38:48.582770 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.583741 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:48.583878 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.583987 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:48.584921 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.585068 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.585175 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:48.586061 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.586226 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:48.586330 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.586441 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:48.587404 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.587542 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.587643 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:48.588554 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.590210 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.590331 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:38:48.591366 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.592268 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:48.592394 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.592499 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:38:48.593398 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.593536 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.593639 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:38:48.594522 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.595734 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:38:48.596120 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:38:48.596239 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    
  );
2021-06-16 08:38:48.597232 (Thread-1): Postgres error: syntax error at or near ")"
LINE 10:   );
           ^

2021-06-16 08:38:48.597353 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:38:48.598291 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.598464 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:38:48.598979 (Thread-1): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 10:   );
           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
  syntax error at or near ")"
  LINE 10:   );
             ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:38:48.600895 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc26d50ad0>]}
2021-06-16 08:38:48.601293 (Thread-1): 08:38:48 | 5 of 7 ERROR creating table model sifa_core.fact_orders.............. [ERROR in 0.04s]
2021-06-16 08:38:48.601574 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:38:48.601763 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:38:48.602164 (Thread-1): 08:38:48 | 6 of 7 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:38:48.602571 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.602717 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:38:48.606066 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:38:48.606379 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.608355 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.608489 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:48.608600 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:48.608695 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.619751 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.621447 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.621572 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:38:48.622625 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.623635 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.623778 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.623890 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.626234 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.626379 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.626486 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:48.627409 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.627578 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.627682 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.627786 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.628669 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.628801 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.628900 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:48.629785 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.631393 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.631523 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:38:48.632515 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.633421 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.633552 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.633661 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.634584 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.634718 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.634818 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:48.635743 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.636904 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:38:48.637273 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.637393 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:38:48.639560 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:38:48.642032 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.642157 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:38:48.643235 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.645695 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.645819 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:38:48.646817 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.648110 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.648240 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.648347 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.650090 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.650355 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.650492 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:48.651407 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.654583 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.654711 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:38:48.656016 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:38:48.656883 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.657011 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.657126 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:38:48.660127 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.660264 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:38:48.660366 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:38:48.661271 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.661758 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.661922 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:38:48.662792 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:38:48.663362 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc271dbbd0>]}
2021-06-16 08:38:48.663822 (Thread-1): 08:38:48 | 6 of 7 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.06s]
2021-06-16 08:38:48.664112 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:38:48.664298 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:38:48.664641 (Thread-1): 08:38:48 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:38:48.665048 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.665194 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:38:48.667992 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:38:48.668327 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.670343 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.670481 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:48.670594 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:38:48.670689 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.684373 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.686262 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.686395 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:38:48.687457 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.688437 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.688586 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.688697 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.689649 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.689783 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.689886 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:48.690756 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.690946 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.691059 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.691157 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.692122 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.692258 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.692367 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:48.693263 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.694925 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.695070 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:38:48.696049 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.696948 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.697084 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.697190 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.698103 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.698237 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.698338 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:48.699299 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.699960 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:38:48.700331 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.700449 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:38:48.702242 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:38:48.704858 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.704988 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:38:48.706043 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:38:48.707308 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.707439 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.707544 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.709571 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.709825 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.709934 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:48.710845 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.712577 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.712702 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:38:48.713675 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:38:48.714557 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.714694 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.714804 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:38:48.715741 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.715890 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:38:48.715996 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:38:48.716920 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:38:48.717455 (Thread-1): finished collecting timing info
2021-06-16 08:38:48.717633 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:38:48.718539 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:38:48.719157 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0316ac2-1a0a-49b3-8db5-e064eaa3e91e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc271b4dd0>]}
2021-06-16 08:38:48.719653 (Thread-1): 08:38:48 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:38:48.720002 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:38:48.820697 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:38:48.820949 (MainThread): Using redshift connection "master".
2021-06-16 08:38:48.821069 (MainThread): On master: BEGIN
2021-06-16 08:38:48.821178 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:38:48.821272 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:38:48.832965 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:38:48.833151 (MainThread): On master: COMMIT
2021-06-16 08:38:48.833266 (MainThread): Using redshift connection "master".
2021-06-16 08:38:48.833368 (MainThread): On master: COMMIT
2021-06-16 08:38:48.834291 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:38:48.834443 (MainThread): On master: Close
2021-06-16 08:38:48.835022 (MainThread): 08:38:48 | 
2021-06-16 08:38:48.835328 (MainThread): 08:38:48 | Finished running 4 view models, 3 table models in 0.97s.
2021-06-16 08:38:48.835572 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:38:48.835686 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:38:48.835780 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:38:48.841388 (MainThread): 
2021-06-16 08:38:48.841684 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:38:48.841919 (MainThread): 
2021-06-16 08:38:48.842226 (MainThread): Database Error in model fact_orders (models/northwind_core/fact_orders.sql)
2021-06-16 08:38:48.842444 (MainThread):   syntax error at or near ")"
2021-06-16 08:38:48.842652 (MainThread):   LINE 10:   );
2021-06-16 08:38:48.842865 (MainThread):              ^
2021-06-16 08:38:48.843094 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_core/fact_orders.sql
2021-06-16 08:38:48.843332 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-06-16 08:38:48.843606 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc27177990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc29e29850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc26fb3310>]}
2021-06-16 08:38:48.843859 (MainThread): Flushing usage events
2021-06-16 08:39:21.520212 (MainThread): Running with dbt=0.19.1
2021-06-16 08:39:21.766730 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:39:21.767266 (MainThread): Tracking: tracking
2021-06-16 08:39:21.773022 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba35ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba36db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba36de10>]}
2021-06-16 08:39:21.793366 (MainThread): Partial parsing not enabled
2021-06-16 08:39:21.794619 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:39:21.834848 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:39:21.853924 (MainThread): Parsing macros/relations.sql
2021-06-16 08:39:21.854983 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:39:21.856359 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:39:21.887358 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:39:21.890961 (MainThread): Parsing macros/relations.sql
2021-06-16 08:39:21.893010 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:39:21.896775 (MainThread): Parsing macros/core.sql
2021-06-16 08:39:21.902934 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:39:21.969539 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:39:21.983389 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:39:21.984908 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:39:21.987619 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:39:21.990625 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:39:21.993120 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:39:21.994808 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:39:22.009072 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:39:22.030431 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:39:22.033334 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:39:22.043255 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:39:22.075655 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:39:22.120971 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:39:22.123759 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:39:22.151845 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:39:22.162141 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:39:22.170350 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:39:22.180013 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:39:22.184267 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:39:22.186663 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:39:22.189589 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:39:22.200416 (MainThread): Partial parsing not enabled
2021-06-16 08:39:22.239334 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.255014 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:22.260825 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.265434 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:22.267676 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:22.270911 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:22.272829 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:22.277439 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:22.279508 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:22.284012 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:22.285942 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:22.289333 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:22.440953 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:39:22.452603 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b9ea9250>]}
2021-06-16 08:39:22.459248 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba164650>]}
2021-06-16 08:39:22.459561 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:39:22.461039 (MainThread): 
2021-06-16 08:39:22.461537 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:39:22.463080 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:39:22.479914 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:39:22.480104 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:39:22.480221 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:39:22.480319 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.499090 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:39:22.502455 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:39:22.503168 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:39:22.505162 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:39:22.505304 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:39:22.505431 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:39:22.505531 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.517281 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:39:22.517867 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:39:22.518490 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:39:22.520513 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:39:22.520643 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:39:22.520756 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:39:22.520849 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.532456 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:39:22.533032 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:39:22.535668 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:39:22.545464 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:39:22.545608 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:39:22.545721 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:39:22.545822 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.557010 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:22.557191 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:39:22.557312 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:39:22.559967 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:39:22.560701 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:39:22.561652 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:39:22.562315 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:39:22.564545 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:39:22.564680 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:39:22.564797 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:39:22.564895 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.575810 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:22.575996 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:39:22.576108 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:39:22.578580 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 08:39:22.579380 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:39:22.580286 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:39:22.580947 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:39:22.583042 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:39:22.583188 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:39:22.583302 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:39:22.583403 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.594176 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:22.594336 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:39:22.594450 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:39:22.596966 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:39:22.597717 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:39:22.598634 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:39:22.605632 (MainThread): Using redshift connection "master".
2021-06-16 08:39:22.605772 (MainThread): On master: BEGIN
2021-06-16 08:39:22.605884 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:39:22.605976 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.617950 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:22.618106 (MainThread): Using redshift connection "master".
2021-06-16 08:39:22.618214 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:39:22.758508 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-06-16 08:39:22.759669 (MainThread): On master: ROLLBACK
2021-06-16 08:39:22.760656 (MainThread): Using redshift connection "master".
2021-06-16 08:39:22.760779 (MainThread): On master: BEGIN
2021-06-16 08:39:22.762499 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.762635 (MainThread): On master: COMMIT
2021-06-16 08:39:22.762743 (MainThread): Using redshift connection "master".
2021-06-16 08:39:22.762840 (MainThread): On master: COMMIT
2021-06-16 08:39:22.763755 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.763900 (MainThread): On master: Close
2021-06-16 08:39:22.764479 (MainThread): 08:39:22 | Concurrency: 1 threads (target='dev')
2021-06-16 08:39:22.764770 (MainThread): 08:39:22 | 
2021-06-16 08:39:22.766844 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:39:22.767240 (Thread-1): 08:39:22 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:39:22.767596 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.767772 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:39:22.771869 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:39:22.772248 (Thread-1): finished collecting timing info
2021-06-16 08:39:22.798660 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.798862 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:22.799030 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:22.799145 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.810816 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:22.817462 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.817615 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:39:22.818701 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:22.819859 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.819991 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.820099 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.821044 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.821182 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.821285 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:22.822258 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.822486 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.822604 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.822708 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.823623 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.823764 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.823865 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:22.824773 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.826577 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.826704 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:39:22.827739 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:22.828668 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.828800 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.828903 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.829802 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.829935 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.830033 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:22.830929 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.837879 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:39:22.838296 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.838415 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:39:22.840616 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:22.848749 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.848887 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:39:22.850044 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:22.852478 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.852604 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:39:22.853687 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:22.866620 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.866853 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.866993 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.869124 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.871701 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.871838 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:22.872753 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.874605 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.874730 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:39:22.876082 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:22.877097 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.877226 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.877334 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:22.878976 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.879118 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:22.879218 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:22.880090 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.880646 (Thread-1): finished collecting timing info
2021-06-16 08:39:22.880813 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:39:22.881685 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:39:22.882236 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b8415210>]}
2021-06-16 08:39:22.882682 (Thread-1): 08:39:22 | 1 of 7 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 08:39:22.882982 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:39:22.883179 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:39:22.883655 (Thread-1): 08:39:22 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:39:22.884069 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.884216 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:39:22.887502 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:39:22.887852 (Thread-1): finished collecting timing info
2021-06-16 08:39:22.907953 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.908134 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:22.908253 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:22.908351 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.919618 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:22.921636 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.921767 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:39:22.922795 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:22.923841 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.923976 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.924087 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.924975 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.925111 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.925212 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:22.926099 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.926266 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.926372 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.926468 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.927367 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.927501 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.927602 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:22.928526 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.930150 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.930272 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:39:22.931282 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:22.932174 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.932299 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.932412 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.933320 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.933471 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.933573 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:22.934458 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.953576 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:39:22.954062 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.954187 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:39:22.955925 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:39:22.958980 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.959115 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:39:22.960188 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:22.962639 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.962776 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:39:22.963800 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:22.965205 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.965334 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.965444 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.967074 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.967353 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.967466 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:22.968363 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.970284 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.970406 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:39:22.971817 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:22.972727 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.972849 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.972952 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:22.975949 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:22.976091 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:22.976194 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:22.977079 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:22.977639 (Thread-1): finished collecting timing info
2021-06-16 08:39:22.977827 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:39:22.978711 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:39:22.979279 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b9ea9c50>]}
2021-06-16 08:39:22.979728 (Thread-1): 08:39:22 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.10s]
2021-06-16 08:39:22.980013 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:39:22.980209 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:39:22.980670 (Thread-1): 08:39:22 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:39:22.981072 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:22.981217 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:39:22.984912 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:39:22.985266 (Thread-1): finished collecting timing info
2021-06-16 08:39:22.987270 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:22.987407 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:22.987521 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:22.987617 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:22.998747 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:23.000669 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.000802 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:39:23.001860 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.002850 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.003009 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.003117 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.004045 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.004182 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.004289 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:23.005179 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.005343 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.005450 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.005545 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.006395 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.006532 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.006627 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:23.007477 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.009204 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.009326 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:39:23.010323 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.011228 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.011358 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.011462 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.012360 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.012493 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.012592 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:23.013479 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.014167 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:39:23.014550 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.014671 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:39:23.016428 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:23.019168 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.019296 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:39:23.020379 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.022716 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.022838 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:39:23.023931 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.025257 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.025393 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.025509 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.027372 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.027657 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.027781 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:23.028667 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.030395 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.030518 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:39:23.031763 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.032629 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.032753 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.032856 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:23.034373 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.034510 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:23.034611 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:23.035542 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.036041 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.036206 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:39:23.037112 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:39:23.037665 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b9ef2890>]}
2021-06-16 08:39:23.038114 (Thread-1): 08:39:23 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:39:23.038401 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:39:23.038587 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:39:23.038967 (Thread-1): 08:39:23 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:39:23.039399 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.039547 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:39:23.043444 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:39:23.043791 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.045687 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.045813 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:23.045922 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:23.046015 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:23.057311 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:23.105935 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.106127 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:39:23.107286 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.108302 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.108427 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.108531 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.109487 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.109627 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.109727 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:23.110748 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.110928 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.111043 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.111138 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.112006 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.112132 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.112228 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:23.113114 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.114843 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.114997 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:39:23.115978 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.116835 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.116959 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.117061 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.117996 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.118128 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.118234 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:23.119112 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.119739 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:39:23.120110 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.120229 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 1
  ) ;

2021-06-16 08:39:23.121799 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:23.124528 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.124659 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 08:39:23.125734 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.128250 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.128388 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:39:23.129402 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.130636 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.130759 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.130862 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.132509 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.132760 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.132867 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:23.133750 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.135555 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.135687 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:39:23.136945 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.137809 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.137934 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.138036 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:23.139496 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.139633 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:23.139732 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:23.140685 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.141185 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.141350 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:39:23.142205 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:39:23.142743 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b83cb8d0>]}
2021-06-16 08:39:23.143218 (Thread-1): 08:39:23 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.10s]
2021-06-16 08:39:23.143521 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:39:23.143712 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:39:23.144075 (Thread-1): 08:39:23 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:39:23.144487 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.144635 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:39:23.146997 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:39:23.147344 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.149263 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.149391 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:23.149500 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:23.149594 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:23.160615 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:23.162421 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.162544 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:39:23.163574 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:23.164569 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.164706 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.164809 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.165689 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.165822 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.165920 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:23.166795 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.166981 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.167089 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.167184 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.168046 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.168177 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.168281 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:23.169162 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.170727 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.170847 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:39:23.171832 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:23.172711 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.172834 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.172937 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.173828 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.173960 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.174059 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:23.174926 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.176144 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:39:23.176544 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.176666 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 08:39:23.181800 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-06-16 08:39:23.184361 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.184489 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 08:39:23.185526 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.186737 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.186860 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.187007 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.188651 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.188903 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.189011 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:23.189970 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.191705 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.191842 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:39:23.192844 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:23.193723 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.193850 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.193956 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:23.194891 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.195054 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:23.195159 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:23.196079 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.196595 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.196765 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:39:23.197703 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:39:23.198243 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b9f20290>]}
2021-06-16 08:39:23.198682 (Thread-1): 08:39:23 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.05s]
2021-06-16 08:39:23.198996 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:39:23.199189 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:39:23.199537 (Thread-1): 08:39:23 | 6 of 7 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:39:23.199938 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.200082 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:39:23.203467 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:39:23.203800 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.205574 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.205750 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:23.205863 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:23.205955 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:23.217872 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:23.219772 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.219899 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:39:23.221027 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:23.221985 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.222110 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.222213 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.223404 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.223539 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.223638 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:23.224668 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.224827 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.224928 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.225020 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.226102 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.226270 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.226383 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:23.227301 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.229059 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.229183 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:39:23.230206 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:23.231116 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.231249 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.231356 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.232290 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.232429 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.232533 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:23.233458 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.234511 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:39:23.234928 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.235065 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:39:23.237183 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:39:23.241329 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.241472 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:39:23.242609 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.244984 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.245113 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:39:23.246166 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.247434 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.247567 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.247687 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.249678 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.250170 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.250296 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:23.251234 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.252865 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.252990 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:39:23.254356 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:23.255310 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.255444 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.255551 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:23.258555 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.258689 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:23.258791 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:23.259721 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.260253 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.260448 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:39:23.261366 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:39:23.261926 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cfc0f190>]}
2021-06-16 08:39:23.262378 (Thread-1): 08:39:23 | 6 of 7 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.06s]
2021-06-16 08:39:23.262662 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:39:23.262917 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:39:23.263288 (Thread-1): 08:39:23 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:39:23.263698 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.263846 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:39:23.266867 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:39:23.267253 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.269178 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.269319 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:23.269432 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:23.269527 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:23.280995 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:23.283188 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.283321 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:39:23.284387 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.285422 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.285554 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.285670 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.286588 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.286724 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.286826 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:23.287779 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.287953 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.288060 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.288159 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.289102 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.289231 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.289329 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:23.290225 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.292096 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.292230 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:39:23.293216 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.294219 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.294350 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.294459 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.295342 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.295482 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.295585 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:23.296495 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.297143 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:39:23.297530 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.297658 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:39:23.299458 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:23.302109 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.302234 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:39:23.303294 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:23.304540 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.304668 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.304772 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.306330 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.306601 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.306711 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:23.307632 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.309383 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.309505 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:39:23.310469 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:23.311364 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.311495 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.311602 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:23.312518 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.312662 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:23.312766 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:23.313652 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:23.314182 (Thread-1): finished collecting timing info
2021-06-16 08:39:23.314357 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:39:23.315265 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:39:23.315848 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5a8c8c-5090-4818-b95e-33d36391b95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba1fec50>]}
2021-06-16 08:39:23.316316 (Thread-1): 08:39:23 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:39:23.316611 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:39:23.406811 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:39:23.407121 (MainThread): Using redshift connection "master".
2021-06-16 08:39:23.407242 (MainThread): On master: BEGIN
2021-06-16 08:39:23.407356 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:39:23.407465 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:23.419745 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:23.419976 (MainThread): On master: COMMIT
2021-06-16 08:39:23.420096 (MainThread): Using redshift connection "master".
2021-06-16 08:39:23.420209 (MainThread): On master: COMMIT
2021-06-16 08:39:23.421156 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:23.421306 (MainThread): On master: Close
2021-06-16 08:39:23.421927 (MainThread): 08:39:23 | 
2021-06-16 08:39:23.422250 (MainThread): 08:39:23 | Finished running 4 view models, 3 table models in 0.96s.
2021-06-16 08:39:23.422482 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:39:23.422601 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:39:23.422695 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:39:23.428431 (MainThread): 
2021-06-16 08:39:23.428752 (MainThread): Completed successfully
2021-06-16 08:39:23.429054 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-06-16 08:39:23.429439 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba2e0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba1fec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba35e7d0>]}
2021-06-16 08:39:23.429698 (MainThread): Flushing usage events
2021-06-16 08:39:38.264209 (MainThread): Running with dbt=0.19.1
2021-06-16 08:39:38.512463 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:39:38.512972 (MainThread): Tracking: tracking
2021-06-16 08:39:38.518848 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7188dcd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7188ebb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7188ebe50>]}
2021-06-16 08:39:38.539316 (MainThread): Partial parsing not enabled
2021-06-16 08:39:38.540510 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:39:38.580775 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:39:38.599859 (MainThread): Parsing macros/relations.sql
2021-06-16 08:39:38.600833 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:39:38.602157 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:39:38.632867 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:39:38.636488 (MainThread): Parsing macros/relations.sql
2021-06-16 08:39:38.638544 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:39:38.642147 (MainThread): Parsing macros/core.sql
2021-06-16 08:39:38.648276 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:39:38.713169 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:39:38.727007 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:39:38.728541 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:39:38.731088 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:39:38.734048 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:39:38.736552 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:39:38.738174 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:39:38.751955 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:39:38.773690 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:39:38.776649 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:39:38.786446 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:39:38.818238 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:39:38.863556 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:39:38.866308 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:39:38.894188 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:39:38.904760 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:39:38.912669 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:39:38.922174 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:39:38.926543 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:39:38.928969 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:39:38.931875 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:39:38.942680 (MainThread): Partial parsing not enabled
2021-06-16 08:39:38.981981 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:38.997807 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:39.003636 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.008256 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:39.010364 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.013461 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:39.015439 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.020029 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:39.021954 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.026500 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:39.028509 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.031850 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:39:39.182358 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:39:39.193658 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7186d6c50>]}
2021-06-16 08:39:39.200233 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc718720cd0>]}
2021-06-16 08:39:39.200571 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:39:39.202070 (MainThread): 
2021-06-16 08:39:39.202563 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:39:39.204124 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:39:39.220513 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:39:39.220683 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:39:39.220799 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:39:39.220896 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.240681 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:39:39.243966 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:39:39.244646 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:39:39.246567 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:39:39.246700 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:39:39.246813 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:39:39.246937 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.258469 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:39:39.259068 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:39:39.259699 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:39:39.261750 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:39:39.261875 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:39:39.261986 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:39:39.262080 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.273560 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:39:39.274151 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:39:39.276760 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:39:39.286430 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:39:39.286568 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:39:39.286681 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:39:39.286775 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.297868 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.298037 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:39:39.298161 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:39:39.300770 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:39:39.301624 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:39:39.302586 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:39:39.303247 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:39:39.305560 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:39:39.305684 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:39:39.305794 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:39:39.305887 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.318283 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.318495 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:39:39.318614 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:39:39.321202 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 08:39:39.321989 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:39:39.322935 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:39:39.323632 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:39:39.325881 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:39:39.326016 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:39:39.326132 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:39:39.326231 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.336768 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.336920 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:39:39.337046 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:39:39.339572 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:39:39.340270 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:39:39.341181 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:39:39.348070 (MainThread): Using redshift connection "master".
2021-06-16 08:39:39.348225 (MainThread): On master: BEGIN
2021-06-16 08:39:39.348338 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:39:39.348432 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.359499 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.359647 (MainThread): Using redshift connection "master".
2021-06-16 08:39:39.359756 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:39:39.508278 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 08:39:39.509420 (MainThread): On master: ROLLBACK
2021-06-16 08:39:39.510403 (MainThread): Using redshift connection "master".
2021-06-16 08:39:39.510531 (MainThread): On master: BEGIN
2021-06-16 08:39:39.512319 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.512458 (MainThread): On master: COMMIT
2021-06-16 08:39:39.512566 (MainThread): Using redshift connection "master".
2021-06-16 08:39:39.512664 (MainThread): On master: COMMIT
2021-06-16 08:39:39.513562 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.513712 (MainThread): On master: Close
2021-06-16 08:39:39.514284 (MainThread): 08:39:39 | Concurrency: 1 threads (target='dev')
2021-06-16 08:39:39.514620 (MainThread): 08:39:39 | 
2021-06-16 08:39:39.516728 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:39:39.517071 (Thread-1): 08:39:39 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:39:39.517418 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.517609 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:39:39.521567 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:39:39.521922 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.548032 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.548203 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:39.548332 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:39.548431 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.560098 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.566458 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.566605 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:39:39.567685 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.568831 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.568956 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.569062 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.569976 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.570111 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.570215 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:39.571117 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.571285 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.571391 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.571487 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.572390 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.572518 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.572616 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:39.573513 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.575232 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.575361 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:39:39.576348 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.577234 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.577363 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.577478 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.578396 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.578545 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.578646 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:39.579557 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.586308 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:39:39.586692 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.586821 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:39:39.589038 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:39.596851 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.596992 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 08:39:39.598240 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.600798 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.600929 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 08:39:39.602033 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.614940 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.615098 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.615207 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.616873 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.619345 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.619485 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:39.620429 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.622174 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.622321 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:39:39.623711 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.624694 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.624826 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.624934 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:39:39.626539 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.626673 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:39:39.626783 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:39:39.627685 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.628238 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.628410 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:39:39.629296 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:39:39.629874 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc715580a90>]}
2021-06-16 08:39:39.630342 (Thread-1): 08:39:39 | 1 of 7 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.11s]
2021-06-16 08:39:39.630642 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:39:39.630842 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:39:39.631353 (Thread-1): 08:39:39 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:39:39.631757 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.631904 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:39:39.634991 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:39:39.635355 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.655080 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.655247 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:39.655362 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:39.655473 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.666677 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.668721 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.668852 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:39:39.669933 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.670952 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.671086 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.671193 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.672160 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.672304 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.672417 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:39.673328 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.673506 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.673614 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.673713 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.674592 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.674722 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.674829 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:39.675767 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.677437 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.677562 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:39:39.678554 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.679509 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.679641 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.679749 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.680654 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.680789 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.680891 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:39.681765 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.701221 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:39:39.701714 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.701838 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:39:39.703700 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:39:39.706750 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.706911 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:39:39.707988 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.710520 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.710654 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:39:39.711687 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.713002 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.713129 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.713235 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.714914 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.715203 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.715315 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:39.716227 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.718231 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.718402 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:39:39.719818 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.720789 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.720918 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.721026 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:39:39.723940 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.724085 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:39:39.724190 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:39:39.725080 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.725619 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.725790 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:39:39.726660 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:39:39.727255 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71bcdba90>]}
2021-06-16 08:39:39.727710 (Thread-1): 08:39:39 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.10s]
2021-06-16 08:39:39.728004 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:39:39.728201 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:39:39.728659 (Thread-1): 08:39:39 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:39:39.729067 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.729214 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:39:39.732908 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:39:39.733252 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.735301 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.735448 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:39.735565 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:39.735665 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.746697 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.748614 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.748743 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:39:39.749780 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.750777 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.750925 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.751040 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.751908 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.752041 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.752151 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:39.753069 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.753234 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.753338 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.753440 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.754348 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.754480 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.754580 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:39.755461 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.757191 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.757316 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:39:39.758339 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.759282 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.759412 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.759518 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.761013 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.761146 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.761246 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:39.762125 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.762819 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:39:39.763210 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.763329 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:39:39.765107 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:39.767851 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.767981 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:39:39.769078 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.771596 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.771730 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:39:39.772761 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.774104 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.774234 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.774342 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.776246 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.776519 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.776631 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:39.777523 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.779376 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.779509 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:39:39.781076 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.781975 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.782102 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.782207 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:39:39.783715 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.783854 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:39:39.783958 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:39:39.784832 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.785339 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.785516 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:39:39.786447 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:39:39.787066 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71848e090>]}
2021-06-16 08:39:39.787537 (Thread-1): 08:39:39 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:39:39.787827 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:39:39.788032 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:39:39.788468 (Thread-1): 08:39:39 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:39:39.788873 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.789018 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:39:39.792903 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:39:39.793253 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.795227 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.795361 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:39.795487 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:39.795586 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.806803 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.857277 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.857479 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:39:39.858646 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.859652 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.859783 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.859889 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.860782 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.860918 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.861019 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:39.861888 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.862051 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.862153 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.862247 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.863116 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.863250 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.863350 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:39.864247 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.866003 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.866132 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:39:39.867104 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.868045 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.868177 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.868286 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.869168 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.869300 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.869408 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:39.870279 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.870961 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:39:39.871338 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.871457 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 'dummy'
  ) ;

2021-06-16 08:39:39.873025 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:39.875717 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.875850 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 08:39:39.876925 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.879532 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.879662 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:39:39.880682 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.881934 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.882059 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.882164 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.883820 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.884095 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.884210 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:39.885086 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.886906 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.887047 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:39:39.888279 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:39.889143 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.889269 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.889381 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:39:39.891000 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.891140 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:39:39.891246 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:39:39.892113 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.892615 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.892784 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:39:39.893629 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:39:39.894188 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71848f2d0>]}
2021-06-16 08:39:39.894647 (Thread-1): 08:39:39 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.11s]
2021-06-16 08:39:39.894972 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:39:39.895163 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:39:39.895526 (Thread-1): 08:39:39 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:39:39.895939 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.896097 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:39:39.898429 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:39:39.898782 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.900742 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.900877 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:39.900990 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:39.901088 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.912059 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.913878 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.914007 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:39:39.915018 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.916057 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.916190 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.916299 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.917179 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.917315 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.917428 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:39.918465 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.918626 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.918762 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.918861 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.919734 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.919860 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.919956 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:39.920814 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.922408 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.922544 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:39:39.923564 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.924477 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.924606 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.924716 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.925600 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.925736 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.925841 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:39.926703 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.927895 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:39:39.928267 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.928386 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 08:39:39.932555 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:39:39.935112 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.935245 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders" rename to "fact_orders__dbt_backup"
2021-06-16 08:39:39.936305 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.938915 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.939059 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 08:39:39.940045 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:39.941270 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.941408 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.941514 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.943559 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.943836 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.943950 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:39.944865 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.946661 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.946795 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:39:39.948181 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.949053 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.949178 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.949282 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:39:39.952082 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.952219 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:39:39.952321 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:39:39.953263 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.953793 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.953966 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:39:39.954866 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:39:39.955465 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc718483b90>]}
2021-06-16 08:39:39.955956 (Thread-1): 08:39:39 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.06s]
2021-06-16 08:39:39.956290 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:39:39.956492 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:39:39.956843 (Thread-1): 08:39:39 | 6 of 7 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 08:39:39.957259 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.957419 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 08:39:39.960746 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:39:39.961089 (Thread-1): finished collecting timing info
2021-06-16 08:39:39.963121 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.963257 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:39.963370 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:39.963485 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:39.974800 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:39.976842 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.976971 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 08:39:39.977970 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.979021 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:39.979158 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.979273 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:39.980150 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.980311 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.980413 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:39.981298 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.981466 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:39.981569 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.981662 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:39.982533 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.982669 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.982772 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:39.983675 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.985406 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.985532 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:39:39.986514 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:39.988985 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:39.989116 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.989220 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:39.990180 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:39.990311 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.990411 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:39.991312 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:39.992271 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 08:39:39.992651 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.992768 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 08:39:39.994850 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 08:39:39.997642 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:39.997771 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 08:39:39.998869 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:40.001482 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:40.001609 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 08:39:40.005285 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:40.006650 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:40.006781 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:40.006905 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:40.011695 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.011958 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:40.012075 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:40.013438 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:40.015385 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:40.015524 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 08:39:40.017059 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:39:40.018033 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:40.018173 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:40.018281 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 08:39:40.022726 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.022874 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:39:40.023012 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 08:39:40.024795 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:40.025419 (Thread-1): finished collecting timing info
2021-06-16 08:39:40.025596 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 08:39:40.026778 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 08:39:40.027392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7186de610>]}
2021-06-16 08:39:40.027875 (Thread-1): 08:39:40 | 6 of 7 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.07s]
2021-06-16 08:39:40.028167 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:39:40.028354 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:39:40.028699 (Thread-1): 08:39:40 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:39:40.029103 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.029248 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:39:40.032256 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:39:40.032603 (Thread-1): finished collecting timing info
2021-06-16 08:39:40.034792 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.034963 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:40.035091 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:39:40.035186 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:40.046460 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:40.048261 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.048389 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:39:40.049431 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:40.050393 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.050518 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.050621 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.051529 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.051665 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.051766 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:40.052651 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:40.052815 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.052928 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.053023 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.053872 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.054003 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.054108 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:40.054982 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:40.056734 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.056894 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:39:40.057895 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:40.058795 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.058941 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.059054 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.059929 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.060073 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.060176 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:40.061095 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:40.061792 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:39:40.062179 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.062303 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:39:40.064186 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:39:40.066656 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.066783 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:39:40.067863 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:39:40.069106 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.069231 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.069415 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.071215 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.071508 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.071627 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:40.072548 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:40.074330 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.074460 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:39:40.075463 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:39:40.076357 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.076485 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.076593 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:39:40.077481 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.077615 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:39:40.077717 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:39:40.078593 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:39:40.079133 (Thread-1): finished collecting timing info
2021-06-16 08:39:40.079308 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:39:40.080252 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:39:40.080841 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3be7a05-4e9f-4c05-8b65-c61000246e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7187119d0>]}
2021-06-16 08:39:40.081301 (Thread-1): 08:39:40 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:39:40.081597 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:39:40.157781 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:39:40.158085 (MainThread): Using redshift connection "master".
2021-06-16 08:39:40.158203 (MainThread): On master: BEGIN
2021-06-16 08:39:40.158314 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:39:40.158410 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:39:40.170081 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:39:40.170245 (MainThread): On master: COMMIT
2021-06-16 08:39:40.170360 (MainThread): Using redshift connection "master".
2021-06-16 08:39:40.170475 (MainThread): On master: COMMIT
2021-06-16 08:39:40.171367 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:39:40.171522 (MainThread): On master: Close
2021-06-16 08:39:40.172098 (MainThread): 08:39:40 | 
2021-06-16 08:39:40.172421 (MainThread): 08:39:40 | Finished running 4 view models, 3 table models in 0.97s.
2021-06-16 08:39:40.172641 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:39:40.172759 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:39:40.172852 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:39:40.178462 (MainThread): 
2021-06-16 08:39:40.178718 (MainThread): Completed successfully
2021-06-16 08:39:40.178996 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-06-16 08:39:40.179372 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71b704850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc718699c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7155596d0>]}
2021-06-16 08:39:40.179620 (MainThread): Flushing usage events
2021-06-16 08:46:11.238982 (MainThread): Running with dbt=0.19.1
2021-06-16 08:46:11.481617 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:46:11.482113 (MainThread): Tracking: tracking
2021-06-16 08:46:11.487907 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7545ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74f0dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74f1ce90>]}
2021-06-16 08:46:11.508225 (MainThread): Partial parsing not enabled
2021-06-16 08:46:11.509411 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:46:11.549312 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:46:11.568202 (MainThread): Parsing macros/relations.sql
2021-06-16 08:46:11.569142 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:46:11.570454 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:46:11.600554 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:46:11.604011 (MainThread): Parsing macros/relations.sql
2021-06-16 08:46:11.605998 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:46:11.609596 (MainThread): Parsing macros/core.sql
2021-06-16 08:46:11.615621 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:46:11.679905 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:46:11.693393 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:46:11.694906 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:46:11.697422 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:46:11.700385 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:46:11.702789 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:46:11.704404 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:46:11.718076 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:46:11.738974 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:46:11.741779 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:46:11.751444 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:46:11.783109 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:46:11.827690 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:46:11.830350 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:46:11.857744 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:46:11.867941 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:46:11.875589 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:46:11.885061 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:46:11.889304 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:46:11.891704 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:46:11.894538 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:46:11.905192 (MainThread): Partial parsing not enabled
2021-06-16 08:46:11.944409 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:11.959799 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:11.965520 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:46:11.970568 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:46:11.972685 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:11.975891 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:46:11.977815 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:11.982294 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:46:11.984261 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:46:11.988760 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:46:11.990695 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:11.993999 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:46:12.144784 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:46:12.156139 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74db9e90>]}
2021-06-16 08:46:12.162409 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74a4afd0>]}
2021-06-16 08:46:12.162702 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 163 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:46:12.164217 (MainThread): 
2021-06-16 08:46:12.164712 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:46:12.166284 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:46:12.182498 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:46:12.182653 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:46:12.182767 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:46:12.182862 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.201524 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:46:12.207014 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:46:12.207736 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:46:12.209683 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:46:12.209813 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:46:12.209922 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:46:12.210013 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.221572 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:46:12.222091 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:46:12.222684 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:46:12.224713 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:46:12.224840 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:46:12.224953 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:46:12.225044 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.236210 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:46:12.236693 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:46:12.239194 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:46:12.248804 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:46:12.248933 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:46:12.249042 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:46:12.249134 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.259926 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.260079 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:46:12.260189 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:46:12.262835 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 08:46:12.263547 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:46:12.264478 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:46:12.265049 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:46:12.267092 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:46:12.267219 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:46:12.267328 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:46:12.267419 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.278335 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.278476 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:46:12.278583 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:46:12.281136 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:46:12.281820 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:46:12.282753 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:46:12.283353 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:46:12.285464 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:46:12.285604 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:46:12.285724 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:46:12.285821 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.296621 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.296771 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:46:12.296879 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:46:12.299495 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:46:12.300114 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:46:12.301032 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:46:12.307604 (MainThread): Using redshift connection "master".
2021-06-16 08:46:12.307761 (MainThread): On master: BEGIN
2021-06-16 08:46:12.307871 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:46:12.307965 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.319552 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.319712 (MainThread): Using redshift connection "master".
2021-06-16 08:46:12.319820 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:46:12.469568 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 08:46:12.470729 (MainThread): On master: ROLLBACK
2021-06-16 08:46:12.471728 (MainThread): Using redshift connection "master".
2021-06-16 08:46:12.471845 (MainThread): On master: BEGIN
2021-06-16 08:46:12.473577 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.473723 (MainThread): On master: COMMIT
2021-06-16 08:46:12.473831 (MainThread): Using redshift connection "master".
2021-06-16 08:46:12.473927 (MainThread): On master: COMMIT
2021-06-16 08:46:12.474832 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.475008 (MainThread): On master: Close
2021-06-16 08:46:12.475596 (MainThread): 08:46:12 | Concurrency: 1 threads (target='dev')
2021-06-16 08:46:12.475923 (MainThread): 08:46:12 | 
2021-06-16 08:46:12.477914 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:46:12.478243 (Thread-1): 08:46:12 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:46:12.478569 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:46:12.478730 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:46:12.483908 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.484286 (Thread-1): Compilation Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  'dbt_utils' is undefined
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/compilation.py", line 413, in _compile_node
    node,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  'dbt_utils' is undefined
2021-06-16 08:46:12.489536 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74b60fd0>]}
2021-06-16 08:46:12.489944 (Thread-1): 08:46:12 | 1 of 7 ERROR creating view model sifa_cleansing.cls_customers........ [ERROR in 0.01s]
2021-06-16 08:46:12.490220 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:46:12.490422 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:46:12.490930 (Thread-1): 08:46:12 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:46:12.491371 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.491518 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:46:12.494482 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:46:12.494827 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.515125 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.515304 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:46:12.515424 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:46:12.515517 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.527061 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.533423 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.533566 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:46:12.534622 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:46:12.535932 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.536070 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.536181 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.537102 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.537243 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.537347 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:46:12.538286 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.538454 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.538559 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.538653 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.539542 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.539675 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.539772 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:46:12.540682 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.542387 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.542509 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:46:12.543539 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:46:12.544439 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.544567 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.544672 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.545659 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.545794 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.545894 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:46:12.546787 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.572166 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:46:12.572610 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.572729 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:46:12.574507 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:46:12.584094 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.584262 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:46:12.585543 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.588252 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.588396 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:46:12.589637 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.600941 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.601092 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.601197 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.603461 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.605995 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.606124 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:46:12.607060 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.608973 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.609097 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:46:12.610615 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:46:12.611595 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.611726 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.611832 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:46:12.615060 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.615205 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:46:12.615310 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:46:12.616218 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.616783 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.616949 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:46:12.617838 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:46:12.618374 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74a39310>]}
2021-06-16 08:46:12.618810 (Thread-1): 08:46:12 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.13s]
2021-06-16 08:46:12.619132 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:46:12.619317 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:46:12.619759 (Thread-1): 08:46:12 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:46:12.620159 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.620306 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:46:12.623590 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:46:12.623946 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.642939 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.643098 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:46:12.643209 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:46:12.643302 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.654985 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.656847 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.656975 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:46:12.658141 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.659227 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.659362 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.659468 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.660365 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.660502 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.660609 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:46:12.661500 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.661673 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.661786 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.661881 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.662749 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.662877 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.663008 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:46:12.663947 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.665873 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.665997 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:46:12.667023 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.667936 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.668068 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.668173 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.669081 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.669220 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.669324 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:46:12.670216 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.677170 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:46:12.677588 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.677720 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:46:12.679599 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:46:12.682467 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.682593 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:46:12.683692 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.686262 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.686387 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:46:12.687437 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.688710 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.688836 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.688955 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.690851 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.691148 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.691259 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:46:12.692163 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.693845 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.693972 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:46:12.695395 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.696323 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.696454 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.696561 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:46:12.698039 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.698171 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:46:12.698277 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:46:12.699187 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.699709 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.699877 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:46:12.700788 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:46:12.701333 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74b4c550>]}
2021-06-16 08:46:12.701781 (Thread-1): 08:46:12 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.08s]
2021-06-16 08:46:12.702079 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:46:12.702268 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:46:12.702620 (Thread-1): 08:46:12 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:46:12.703053 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.703203 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:46:12.705708 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:46:12.706060 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.708116 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.708249 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:46:12.708369 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:46:12.708463 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.720178 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.721854 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.721978 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:46:12.723013 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.723997 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.724127 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.724248 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.725173 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.725307 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.725413 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:46:12.726291 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.726453 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.726556 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.726649 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.727529 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.727660 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.727756 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:46:12.728626 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.730284 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.730404 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:46:12.731351 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.732213 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.732346 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.732448 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.733343 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.733477 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.733586 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:46:12.734478 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.735171 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:46:12.735550 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.735678 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 'dummy'
  ) ;

2021-06-16 08:46:12.737204 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:46:12.739900 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.740027 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 08:46:12.741116 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.745156 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.745290 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:46:12.746378 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.747647 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.747775 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.747877 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.749713 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.749961 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.750067 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:46:12.751006 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.752606 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.752727 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:46:12.754026 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.754903 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.755037 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.755140 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:46:12.757031 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.757165 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:46:12.757266 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:46:12.758203 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.758720 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.758902 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:46:12.759878 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:46:12.760429 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f79f6c490>]}
2021-06-16 08:46:12.760867 (Thread-1): 08:46:12 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.06s]
2021-06-16 08:46:12.761161 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:46:12.761347 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:46:12.761693 (Thread-1): 08:46:12 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:46:12.762098 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.762242 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:46:12.810705 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:46:12.811158 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.813100 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.813235 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:46:12.813349 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:46:12.813443 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.824852 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.826856 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.827021 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:46:12.828062 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:46:12.829052 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.829179 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.829282 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.830188 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.830320 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.830419 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:46:12.831342 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.831507 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.831609 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.831701 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.832604 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.832729 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.832821 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:46:12.833747 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.835389 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.835515 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:46:12.836545 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:46:12.837558 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.837691 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.837801 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.838765 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.838907 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.839036 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:46:12.839987 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.840946 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:46:12.841327 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.841445 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 08:46:12.846117 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:46:12.848670 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.848799 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders" rename to "fact_orders__dbt_backup"
2021-06-16 08:46:12.849915 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.852500 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.852629 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 08:46:12.853646 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.854876 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.855029 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.855135 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.857096 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.857357 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.857469 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:46:12.858387 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.860163 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.860298 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:46:12.861636 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:46:12.862492 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.862619 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.862723 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:46:12.865700 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.865841 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:46:12.865943 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:46:12.866910 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.867446 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.867627 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:46:12.868522 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:46:12.869056 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74f08810>]}
2021-06-16 08:46:12.869523 (Thread-1): 08:46:12 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.11s]
2021-06-16 08:46:12.869817 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:46:12.870016 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:46:12.870277 (Thread-1): 08:46:12 | 6 of 7 SKIP relation sifa_core.dim_customers......................... [SKIP]
2021-06-16 08:46:12.870552 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:46:12.870726 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:46:12.871079 (Thread-1): 08:46:12 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:46:12.871502 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.871646 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:46:12.874655 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:46:12.875042 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.876968 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.877107 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:46:12.877222 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:46:12.877320 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:12.888654 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:12.890670 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.890794 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:46:12.891854 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.892849 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.892980 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.893090 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.894021 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.894163 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.894268 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:46:12.895128 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.895298 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.895401 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.895508 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.896411 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.896542 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.896650 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:46:12.897534 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.899247 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.899373 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:46:12.900360 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.901232 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.901358 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.901461 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.902351 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.902486 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.902585 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:46:12.903470 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.904118 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:46:12.904506 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.904627 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:46:12.906409 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:46:12.909125 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.909291 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:46:12.910332 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:46:12.911620 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.911752 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.911857 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.913567 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.913820 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.913929 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:46:12.914817 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.916619 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.916744 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:46:12.917802 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:46:12.918730 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.918863 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.918998 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:46:12.919959 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:12.920095 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:46:12.920202 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:46:12.921123 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:46:12.921666 (Thread-1): finished collecting timing info
2021-06-16 08:46:12.921834 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:46:12.922778 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:46:12.923354 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b810b7fb-7f8c-46a7-a38f-226486c174d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f79f75a50>]}
2021-06-16 08:46:12.923824 (Thread-1): 08:46:12 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:46:12.924111 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:46:13.010203 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:46:13.010472 (MainThread): Using redshift connection "master".
2021-06-16 08:46:13.010588 (MainThread): On master: BEGIN
2021-06-16 08:46:13.010699 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:46:13.010797 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:46:13.022373 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:46:13.022563 (MainThread): On master: COMMIT
2021-06-16 08:46:13.022680 (MainThread): Using redshift connection "master".
2021-06-16 08:46:13.022797 (MainThread): On master: COMMIT
2021-06-16 08:46:13.023747 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:46:13.023905 (MainThread): On master: Close
2021-06-16 08:46:13.024474 (MainThread): 08:46:13 | 
2021-06-16 08:46:13.024800 (MainThread): 08:46:13 | Finished running 4 view models, 3 table models in 0.86s.
2021-06-16 08:46:13.025032 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:46:13.025152 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:46:13.025244 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:46:13.032156 (MainThread): 
2021-06-16 08:46:13.032414 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:46:13.032650 (MainThread): 
2021-06-16 08:46:13.032903 (MainThread): Compilation Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 08:46:13.033186 (MainThread):   'dbt_utils' is undefined
2021-06-16 08:46:13.033449 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
2021-06-16 08:46:13.033780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f78311490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74dc2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f74dc2090>]}
2021-06-16 08:46:13.034030 (MainThread): Flushing usage events
2021-06-16 08:48:47.355440 (MainThread): Running with dbt=0.19.1
2021-06-16 08:48:47.604512 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:48:47.605031 (MainThread): Tracking: tracking
2021-06-16 08:48:47.610826 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f5aa84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f5a95690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f5a95990>]}
2021-06-16 08:48:47.611863 (MainThread): Set downloads directory='/tmp/dbt-downloads-q38k80t7'
2021-06-16 08:48:47.612443 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-06-16 08:48:47.728471 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-06-16 08:48:47.729084 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-16 08:48:47.806608 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-16 08:48:47.809170 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json
2021-06-16 08:48:47.899957 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json 200
2021-06-16 08:48:47.900581 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-16 08:48:47.979301 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-16 08:48:47.981788 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json
2021-06-16 08:48:48.071912 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json 200
2021-06-16 08:48:48.072602 (MainThread): Installing fishtown-analytics/dbt_utils@0.7.0
2021-06-16 08:48:48.299663 (MainThread):   Installed from version 0.7.0

2021-06-16 08:48:48.300117 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a6cf0bba-0fd4-4097-8489-cafbe1a57f20', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f5af0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f5a83710>]}
2021-06-16 08:48:48.300660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f5ae09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f86d85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f86d82d0>]}
2021-06-16 08:48:48.300889 (MainThread): Flushing usage events
2021-06-16 08:48:54.241893 (MainThread): Running with dbt=0.19.1
2021-06-16 08:48:54.480777 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:48:54.481266 (MainThread): Tracking: tracking
2021-06-16 08:48:54.487033 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ad858fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ad8c44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ad865a10>]}
2021-06-16 08:48:54.488048 (MainThread): Set downloads directory='/tmp/dbt-downloads-4tjhjzil'
2021-06-16 08:48:54.488626 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-06-16 08:48:54.614538 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-06-16 08:48:54.615211 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-16 08:48:54.663519 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-16 08:48:54.666082 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json
2021-06-16 08:48:54.785727 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json 200
2021-06-16 08:48:54.786377 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-16 08:48:54.835477 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-16 08:48:54.837948 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json
2021-06-16 08:48:54.932104 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json 200
2021-06-16 08:48:54.932811 (MainThread): Installing fishtown-analytics/dbt_utils@0.7.0
2021-06-16 08:48:55.095876 (MainThread):   Installed from version 0.7.0

2021-06-16 08:48:55.096305 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cfcbcf23-f002-429c-b0fb-e5bb48c70cf3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ad867150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ad8675d0>]}
2021-06-16 08:48:55.096798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b0521a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b04d4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ad8a2f50>]}
2021-06-16 08:48:55.097010 (MainThread): Flushing usage events
2021-06-16 08:49:07.762934 (MainThread): Running with dbt=0.19.1
2021-06-16 08:49:08.006908 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:49:08.007421 (MainThread): Tracking: tracking
2021-06-16 08:49:08.013187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e875b5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e875b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e875b5b50>]}
2021-06-16 08:49:08.039391 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e875b5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e875b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e875b5310>]}
2021-06-16 08:49:08.039717 (MainThread): Flushing usage events
2021-06-16 08:49:08.420649 (MainThread): Encountered an error:
2021-06-16 08:49:08.421341 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils
2021-06-16 08:49:08.425372 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 353, in load_projects
    project = self.new_project(str(path))
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 145, in new_project
    verify_version=getattr(self.args, 'version_check', False),
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 633, in from_project_root
    return partial.render(renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 303, in create_project
    verify_version=self.verify_version,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.19.1
    Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    macro_manifest: MacroManifest = adapter.load_macro_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 278, in load_macro_manifest
    self.config, self.connections.set_query_header
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 854, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 463, in load_macros
    projects = root_config.load_dependencies()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 333, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 359, in load_projects
    ) from e
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils

2021-06-16 08:49:42.681259 (MainThread): Running with dbt=0.19.1
2021-06-16 08:49:42.922641 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:49:42.923176 (MainThread): Tracking: tracking
2021-06-16 08:49:42.928916 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa422cef510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4200a2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4200a2d50>]}
2021-06-16 08:49:42.929896 (MainThread): Set downloads directory='/tmp/dbt-downloads-yoi9h5ow'
2021-06-16 08:49:42.930470 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-06-16 08:49:43.036414 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-06-16 08:49:43.037069 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-16 08:49:43.086304 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-16 08:49:43.088898 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json
2021-06-16 08:49:43.179841 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json 200
2021-06-16 08:49:43.180466 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-16 08:49:43.259737 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-16 08:49:43.262305 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json
2021-06-16 08:49:43.352380 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.7.0.json 200
2021-06-16 08:49:43.353072 (MainThread): Installing fishtown-analytics/dbt_utils@0.7.0
2021-06-16 08:49:43.596394 (MainThread):   Installed from version 0.7.0

2021-06-16 08:49:43.596850 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '311e00ce-9215-43a5-b94b-a84c3f6f44e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4200fa910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4200fae50>]}
2021-06-16 08:49:43.597346 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa422cef510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa422d65250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa423f2b490>]}
2021-06-16 08:49:43.597584 (MainThread): Flushing usage events
2021-06-16 08:49:48.303316 (MainThread): Running with dbt=0.19.1
2021-06-16 08:49:48.552062 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:49:48.552571 (MainThread): Tracking: tracking
2021-06-16 08:49:48.558409 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9e0f9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9b4b7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9b4b7a90>]}
2021-06-16 08:49:48.584113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9b510690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9b510650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9b510510>]}
2021-06-16 08:49:48.584412 (MainThread): Flushing usage events
2021-06-16 08:49:48.970116 (MainThread): Encountered an error:
2021-06-16 08:49:48.970753 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils
2021-06-16 08:49:48.972582 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 353, in load_projects
    project = self.new_project(str(path))
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 145, in new_project
    verify_version=getattr(self.args, 'version_check', False),
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 633, in from_project_root
    return partial.render(renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 303, in create_project
    verify_version=self.verify_version,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.19.1
    Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    macro_manifest: MacroManifest = adapter.load_macro_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 278, in load_macro_manifest
    self.config, self.connections.set_query_header
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 854, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 463, in load_macros
    projects = root_config.load_dependencies()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 333, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 359, in load_projects
    ) from e
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils

2021-06-16 08:50:56.718505 (MainThread): Running with dbt=0.19.1
2021-06-16 08:50:56.965343 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:50:56.965883 (MainThread): Tracking: tracking
2021-06-16 08:50:56.971759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29eb51fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29eb572110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ee1e8f50>]}
2021-06-16 08:50:56.972766 (MainThread): Set downloads directory='/tmp/dbt-downloads-9izsale0'
2021-06-16 08:50:56.973369 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-06-16 08:50:57.004288 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-06-16 08:50:57.004979 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-06-16 08:50:57.055574 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-06-16 08:50:57.059209 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29f3e9f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29eb0e3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29eb0e3e10>]}
2021-06-16 08:50:57.059482 (MainThread): Flushing usage events
2021-06-16 08:50:57.440639 (MainThread): Encountered an error:
2021-06-16 08:50:57.441265 (MainThread): Could not find a matching version for package fishtown-analytics/dbt_utils
  Requested range: >=0.20.0, <0.21.0
  Available versions: ['0.2.3', '0.1.4', '0.1.22', '0.6.6', '0.4.0', '0.2.0', '0.1.9', '0.6.4', '0.2.2', '0.1.17', '0.6.1', '0.1.19', '0.1.18', '0.1.5', '0.3.0', '0.1.23', '0.1.15', '0.1.3', '0.1.1', '0.6.5', '0.5.0', '0.1.6', '0.5.1', '0.1.12', '0.1.2', '0.6.3', '0.1.20', '0.1.16', '0.0.1', '0.6.0', '0.4.1', '0.1.14', '0.7.0', '0.2.5', '0.1.21', '0.2.4', '0.1.24', '0.1.13', '0.1.0', '0.6.2', '0.2.1', '0.1.11', '0.1.25', '0.1.10', '0.1.7', '0.1.8']
2021-06-16 08:50:57.443916 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/deps.py", line 53, in run
    final_deps = resolve_packages(packages, self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/deps/resolver.py", line 137, in resolve_packages
    target = final[package].resolved().fetch_metadata(config, renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/deps/registry.py", line 121, in resolved
    package_version_not_found(self.package, range_, available)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 691, in package_version_not_found
    available_versions))
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/exceptions.py", line 443, in raise_dependency_error
    raise DependencyException(msg)
dbt.exceptions.DependencyException: Could not find a matching version for package fishtown-analytics/dbt_utils
  Requested range: >=0.20.0, <0.21.0
  Available versions: ['0.2.3', '0.1.4', '0.1.22', '0.6.6', '0.4.0', '0.2.0', '0.1.9', '0.6.4', '0.2.2', '0.1.17', '0.6.1', '0.1.19', '0.1.18', '0.1.5', '0.3.0', '0.1.23', '0.1.15', '0.1.3', '0.1.1', '0.6.5', '0.5.0', '0.1.6', '0.5.1', '0.1.12', '0.1.2', '0.6.3', '0.1.20', '0.1.16', '0.0.1', '0.6.0', '0.4.1', '0.1.14', '0.7.0', '0.2.5', '0.1.21', '0.2.4', '0.1.24', '0.1.13', '0.1.0', '0.6.2', '0.2.1', '0.1.11', '0.1.25', '0.1.10', '0.1.7', '0.1.8']

2021-06-16 08:52:11.487269 (MainThread): Running with dbt=0.19.1
2021-06-16 08:52:11.733129 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:52:11.733661 (MainThread): Tracking: tracking
2021-06-16 08:52:11.739524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5f333550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5f383f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5f383290>]}
2021-06-16 08:52:11.740508 (MainThread): Set downloads directory='/tmp/dbt-downloads-rnvgh7xk'
2021-06-16 08:52:11.741017 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:52:12.312095 (MainThread): STDOUT: "b''"
2021-06-16 08:52:12.312398 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-06-16 08:52:12.312882 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:52:12.313033 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:52:12.316745 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:52:12.316988 (MainThread): STDERR: "b''"
2021-06-16 08:52:12.317123 (MainThread):   Checking out branch 0.1.21.
2021-06-16 08:52:12.317220 (MainThread): Executing "git remote set-branches origin 0.1.21"
2021-06-16 08:52:12.321365 (MainThread): STDOUT: "b''"
2021-06-16 08:52:12.321593 (MainThread): STDERR: "b''"
2021-06-16 08:52:12.321711 (MainThread): Executing "git fetch --tags --depth 1 origin 0.1.21"
2021-06-16 08:52:13.919534 (MainThread): STDOUT: "b''"
2021-06-16 08:52:13.919845 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.1.21     -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n'"
2021-06-16 08:52:13.919997 (MainThread): Executing "git tag --list"
2021-06-16 08:52:13.924185 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:52:13.924429 (MainThread): STDERR: "b''"
2021-06-16 08:52:13.924586 (MainThread): Executing "git reset --hard tags/0.1.21"
2021-06-16 08:52:13.945510 (MainThread): STDOUT: "b'HEAD is now at eeea5cc Merge pull request #113 from fishtown-analytics/fix/cast-in-union-tables\n'"
2021-06-16 08:52:13.945813 (MainThread): STDERR: "b''"
2021-06-16 08:52:13.945958 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:52:13.949748 (MainThread): STDOUT: "b'eeea5cccc8c6f135345af819df4604f97df814ad\n'"
2021-06-16 08:52:13.949994 (MainThread): STDERR: "b''"
2021-06-16 08:52:13.950125 (MainThread):   Checked out at eeea5cc.
2021-06-16 08:52:13.951120 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5f333790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5f333550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c5f3330d0>]}
2021-06-16 08:52:13.951525 (MainThread): Flushing usage events
2021-06-16 08:52:14.338606 (MainThread): Encountered an error:
2021-06-16 08:52:14.339285 (MainThread): Runtime Error
  Invalid config version: 1, expected 2

Error encountered in /tmp/dbt-downloads-rnvgh7xk/859fd0fa21176efee375a447937f7a46/dbt_project.yml
2021-06-16 08:52:14.342060 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/deps.py", line 53, in run
    final_deps = resolve_packages(packages, self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/deps/resolver.py", line 137, in resolve_packages
    target = final[package].resolved().fetch_metadata(config, renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/deps/base.py", line 85, in fetch_metadata
    self._cached_metadata = self._fetch_metadata(project, renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/deps/git.py", line 82, in _fetch_metadata
    loaded = Project.from_project_root(path, renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 632, in from_project_root
    partial = cls.partial_load(project_root, verify_version=verify_version)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 601, in partial_load
    verify_version=verify_version,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 454, in from_project_root
    path=os.path.join(project_root, 'dbt_project.yml')
dbt.exceptions.DbtProjectError: Runtime Error
  Invalid config version: 1, expected 2

Error encountered in /tmp/dbt-downloads-rnvgh7xk/859fd0fa21176efee375a447937f7a46/dbt_project.yml

2021-06-16 08:53:16.067663 (MainThread): Running with dbt=0.19.1
2021-06-16 08:53:16.310093 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:53:16.310599 (MainThread): Tracking: tracking
2021-06-16 08:53:16.316286 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eabef290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e7f32f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e7f32b90>]}
2021-06-16 08:53:16.317290 (MainThread): Set downloads directory='/tmp/dbt-downloads-15wuzck9'
2021-06-16 08:53:16.317785 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:53:16.808147 (MainThread): STDOUT: "b''"
2021-06-16 08:53:16.808466 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-06-16 08:53:16.808928 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:53:16.809066 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:53:16.812986 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:53:16.813234 (MainThread): STDERR: "b''"
2021-06-16 08:53:16.813365 (MainThread):   Checking out branch 0.7.0.
2021-06-16 08:53:16.813462 (MainThread): Executing "git remote set-branches origin 0.7.0"
2021-06-16 08:53:16.816883 (MainThread): STDOUT: "b''"
2021-06-16 08:53:16.817119 (MainThread): STDERR: "b''"
2021-06-16 08:53:16.817233 (MainThread): Executing "git fetch --tags --depth 1 origin 0.7.0"
2021-06-16 08:53:17.412750 (MainThread): STDOUT: "b''"
2021-06-16 08:53:17.413060 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.7.0      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n'"
2021-06-16 08:53:17.413206 (MainThread): Executing "git tag --list"
2021-06-16 08:53:17.417332 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:53:17.417572 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.417716 (MainThread): Executing "git reset --hard tags/0.7.0"
2021-06-16 08:53:17.426711 (MainThread): STDOUT: "b'HEAD is now at 2fbadf7 Update changelog in advance of 0.7.0 release\n'"
2021-06-16 08:53:17.427068 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.427218 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:53:17.430766 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:53:17.431055 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.431192 (MainThread):   Checked out at 2fbadf7.
2021-06-16 08:53:17.440245 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:53:17.443741 (MainThread): STDOUT: "b''"
2021-06-16 08:53:17.443972 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:53:17.444072 (MainThread): command return code=128
2021-06-16 08:53:17.444625 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:53:17.444757 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:53:17.447772 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:53:17.448014 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.448142 (MainThread):   Checking out branch 0.7.0.
2021-06-16 08:53:17.448235 (MainThread): Executing "git remote set-branches origin 0.7.0"
2021-06-16 08:53:17.451477 (MainThread): STDOUT: "b''"
2021-06-16 08:53:17.451718 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.451836 (MainThread): Executing "git fetch --tags --depth 1 origin 0.7.0"
2021-06-16 08:53:17.928399 (MainThread): STDOUT: "b''"
2021-06-16 08:53:17.928727 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.7.0      -> FETCH_HEAD\n'"
2021-06-16 08:53:17.928859 (MainThread): Executing "git tag --list"
2021-06-16 08:53:17.933119 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:53:17.933383 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.933537 (MainThread): Executing "git reset --hard tags/0.7.0"
2021-06-16 08:53:17.938368 (MainThread): STDOUT: "b'HEAD is now at 2fbadf7 Update changelog in advance of 0.7.0 release\n'"
2021-06-16 08:53:17.938608 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.938743 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:53:17.941828 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:53:17.942062 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.942190 (MainThread):   Already at 2fbadf7, nothing to do.
2021-06-16 08:53:17.951664 (MainThread): Installing https://github.com/fishtown-analytics/dbt-utils.git@0.7.0
2021-06-16 08:53:17.958696 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:53:17.962277 (MainThread): STDOUT: "b''"
2021-06-16 08:53:17.962511 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:53:17.962614 (MainThread): command return code=128
2021-06-16 08:53:17.962802 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:53:17.962967 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:53:17.966089 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:53:17.966330 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.966463 (MainThread):   Checking out branch 0.7.0.
2021-06-16 08:53:17.966571 (MainThread): Executing "git remote set-branches origin 0.7.0"
2021-06-16 08:53:17.969692 (MainThread): STDOUT: "b''"
2021-06-16 08:53:17.969937 (MainThread): STDERR: "b''"
2021-06-16 08:53:17.970053 (MainThread): Executing "git fetch --tags --depth 1 origin 0.7.0"
2021-06-16 08:53:18.444743 (MainThread): STDOUT: "b''"
2021-06-16 08:53:18.445073 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.7.0      -> FETCH_HEAD\n'"
2021-06-16 08:53:18.445204 (MainThread): Executing "git tag --list"
2021-06-16 08:53:18.449578 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:53:18.449817 (MainThread): STDERR: "b''"
2021-06-16 08:53:18.449966 (MainThread): Executing "git reset --hard tags/0.7.0"
2021-06-16 08:53:18.454751 (MainThread): STDOUT: "b'HEAD is now at 2fbadf7 Update changelog in advance of 0.7.0 release\n'"
2021-06-16 08:53:18.455070 (MainThread): STDERR: "b''"
2021-06-16 08:53:18.455212 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:53:18.458279 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:53:18.458511 (MainThread): STDERR: "b''"
2021-06-16 08:53:18.458638 (MainThread):   Already at 2fbadf7, nothing to do.
2021-06-16 08:53:18.458876 (MainThread):   Installed from revision 0.7.0

2021-06-16 08:53:18.459397 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '7ff7046c-5179-4141-b9bc-b81871181c89', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e7f3d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e7f3dd50>]}
2021-06-16 08:53:18.460017 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eabf5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eabef290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e7f99ed0>]}
2021-06-16 08:53:18.460243 (MainThread): Flushing usage events
2021-06-16 08:53:24.338457 (MainThread): Running with dbt=0.19.1
2021-06-16 08:53:24.581506 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:53:24.581985 (MainThread): Tracking: tracking
2021-06-16 08:53:24.587678 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c1521b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c1530690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c1530990>]}
2021-06-16 08:53:24.613257 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c15710d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c1571910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78c1571590>]}
2021-06-16 08:53:24.613565 (MainThread): Flushing usage events
2021-06-16 08:53:24.992774 (MainThread): Encountered an error:
2021-06-16 08:53:24.993421 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils
2021-06-16 08:53:24.995359 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 353, in load_projects
    project = self.new_project(str(path))
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 145, in new_project
    verify_version=getattr(self.args, 'version_check', False),
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 633, in from_project_root
    return partial.render(renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 303, in create_project
    verify_version=self.verify_version,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.19.1
    Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    macro_manifest: MacroManifest = adapter.load_macro_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 278, in load_macro_manifest
    self.config, self.connections.set_query_header
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 854, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 463, in load_macros
    projects = root_config.load_dependencies()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 333, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 359, in load_projects
    ) from e
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.20.0', '<0.21.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils

2021-06-16 08:54:28.128438 (MainThread): Running with dbt=0.19.1
2021-06-16 08:54:28.373473 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:54:28.373982 (MainThread): Tracking: tracking
2021-06-16 08:54:28.379700 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef68092f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef680ed950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef680ed7d0>]}
2021-06-16 08:54:28.380704 (MainThread): Set downloads directory='/tmp/dbt-downloads-g1jnlo6p'
2021-06-16 08:54:28.381228 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:54:29.261112 (MainThread): STDOUT: "b''"
2021-06-16 08:54:29.261426 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-06-16 08:54:29.261896 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:54:29.262042 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:29.265853 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:54:29.266099 (MainThread): STDERR: "b''"
2021-06-16 08:54:29.266236 (MainThread):   Checking out branch 0.6.0.
2021-06-16 08:54:29.266336 (MainThread): Executing "git remote set-branches origin 0.6.0"
2021-06-16 08:54:29.269654 (MainThread): STDOUT: "b''"
2021-06-16 08:54:29.269890 (MainThread): STDERR: "b''"
2021-06-16 08:54:29.270016 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.0"
2021-06-16 08:54:29.796639 (MainThread): STDOUT: "b''"
2021-06-16 08:54:29.796974 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.0      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n'"
2021-06-16 08:54:29.797117 (MainThread): Executing "git tag --list"
2021-06-16 08:54:29.801233 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:54:29.801470 (MainThread): STDERR: "b''"
2021-06-16 08:54:29.801611 (MainThread): Executing "git reset --hard tags/0.6.0"
2021-06-16 08:54:29.823865 (MainThread): STDOUT: "b'HEAD is now at 48567a6 Merge pull request #272 from fishtown-analytics/prepare-0.6.0-release\n'"
2021-06-16 08:54:29.824127 (MainThread): STDERR: "b''"
2021-06-16 08:54:29.824265 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:29.827765 (MainThread): STDOUT: "b'48567a6bbb78d6cac86ffa05c6748fe16baf4214\n'"
2021-06-16 08:54:29.828013 (MainThread): STDERR: "b''"
2021-06-16 08:54:29.828144 (MainThread):   Checked out at 48567a6.
2021-06-16 08:54:29.837169 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:54:29.840172 (MainThread): STDOUT: "b''"
2021-06-16 08:54:29.840402 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:54:29.840505 (MainThread): command return code=128
2021-06-16 08:54:29.841055 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:54:29.841192 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:29.844116 (MainThread): STDOUT: "b'48567a6bbb78d6cac86ffa05c6748fe16baf4214\n'"
2021-06-16 08:54:29.844353 (MainThread): STDERR: "b''"
2021-06-16 08:54:29.844485 (MainThread):   Checking out branch 0.6.0.
2021-06-16 08:54:29.844581 (MainThread): Executing "git remote set-branches origin 0.6.0"
2021-06-16 08:54:29.847743 (MainThread): STDOUT: "b''"
2021-06-16 08:54:29.847976 (MainThread): STDERR: "b''"
2021-06-16 08:54:29.848093 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.0"
2021-06-16 08:54:30.350375 (MainThread): STDOUT: "b''"
2021-06-16 08:54:30.350681 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.0      -> FETCH_HEAD\n'"
2021-06-16 08:54:30.350824 (MainThread): Executing "git tag --list"
2021-06-16 08:54:30.354955 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:54:30.355198 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.355342 (MainThread): Executing "git reset --hard tags/0.6.0"
2021-06-16 08:54:30.363434 (MainThread): STDOUT: "b'HEAD is now at 48567a6 Merge pull request #272 from fishtown-analytics/prepare-0.6.0-release\n'"
2021-06-16 08:54:30.363672 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.363808 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:30.366665 (MainThread): STDOUT: "b'48567a6bbb78d6cac86ffa05c6748fe16baf4214\n'"
2021-06-16 08:54:30.366924 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.367063 (MainThread):   Already at 48567a6, nothing to do.
2021-06-16 08:54:30.376377 (MainThread): Installing https://github.com/fishtown-analytics/dbt-utils.git@0.6.0
2021-06-16 08:54:30.385968 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:54:30.389563 (MainThread): STDOUT: "b''"
2021-06-16 08:54:30.389808 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:54:30.389914 (MainThread): command return code=128
2021-06-16 08:54:30.390113 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:54:30.390244 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:30.393367 (MainThread): STDOUT: "b'48567a6bbb78d6cac86ffa05c6748fe16baf4214\n'"
2021-06-16 08:54:30.393614 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.393742 (MainThread):   Checking out branch 0.6.0.
2021-06-16 08:54:30.393839 (MainThread): Executing "git remote set-branches origin 0.6.0"
2021-06-16 08:54:30.396954 (MainThread): STDOUT: "b''"
2021-06-16 08:54:30.397179 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.397295 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.0"
2021-06-16 08:54:30.859063 (MainThread): STDOUT: "b''"
2021-06-16 08:54:30.859368 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.0      -> FETCH_HEAD\n'"
2021-06-16 08:54:30.859503 (MainThread): Executing "git tag --list"
2021-06-16 08:54:30.863615 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:54:30.863850 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.864002 (MainThread): Executing "git reset --hard tags/0.6.0"
2021-06-16 08:54:30.868668 (MainThread): STDOUT: "b'HEAD is now at 48567a6 Merge pull request #272 from fishtown-analytics/prepare-0.6.0-release\n'"
2021-06-16 08:54:30.868902 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.869035 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:30.871993 (MainThread): STDOUT: "b'48567a6bbb78d6cac86ffa05c6748fe16baf4214\n'"
2021-06-16 08:54:30.872231 (MainThread): STDERR: "b''"
2021-06-16 08:54:30.872360 (MainThread):   Already at 48567a6, nothing to do.
2021-06-16 08:54:30.872598 (MainThread):   Installed from revision 0.6.0

2021-06-16 08:54:30.872924 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '2e72495f-a5de-4f00-8e45-e46bcfc5156a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef680e5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef680e59d0>]}
2021-06-16 08:54:30.873526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef680ed510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef680ed910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef680edfd0>]}
2021-06-16 08:54:30.873748 (MainThread): Flushing usage events
2021-06-16 08:54:35.145082 (MainThread): Running with dbt=0.19.1
2021-06-16 08:54:35.391090 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:54:35.391586 (MainThread): Tracking: tracking
2021-06-16 08:54:35.397282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddaee6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddaef4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddaef4b10>]}
2021-06-16 08:54:35.423256 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddaef4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddaf4e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddaf4e5d0>]}
2021-06-16 08:54:35.423580 (MainThread): Flushing usage events
2021-06-16 08:54:35.802940 (MainThread): Encountered an error:
2021-06-16 08:54:35.803579 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils
2021-06-16 08:54:35.805400 (MainThread): Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 353, in load_projects
    project = self.new_project(str(path))
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 145, in new_project
    verify_version=getattr(self.args, 'version_check', False),
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 633, in from_project_root
    return partial.render(renderer)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 303, in create_project
    verify_version=self.verify_version,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.19.1
    Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    macro_manifest: MacroManifest = adapter.load_macro_manifest()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 278, in load_macro_manifest
    self.config, self.connections.set_query_header
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 854, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/parser/manifest.py", line 463, in load_macros
    projects = root_config.load_dependencies()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 333, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/config/runtime.py", line 359, in load_projects
    ) from e
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.19.1
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils/dbt_project.yml

Error encountered in /home/ec2-user/northwinddbt/dbt_modules/dbt_utils

2021-06-16 08:54:52.818192 (MainThread): Running with dbt=0.19.1
2021-06-16 08:54:53.068265 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:54:53.068771 (MainThread): Tracking: tracking
2021-06-16 08:54:53.074565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d12935290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d128d7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d128d7cd0>]}
2021-06-16 08:54:53.075629 (MainThread): Set downloads directory='/tmp/dbt-downloads-jteai31_'
2021-06-16 08:54:53.076162 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:54:53.580942 (MainThread): STDOUT: "b''"
2021-06-16 08:54:53.581240 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-06-16 08:54:53.581710 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:54:53.581850 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:53.585483 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:54:53.585731 (MainThread): STDERR: "b''"
2021-06-16 08:54:53.585861 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:54:53.585956 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:54:53.589106 (MainThread): STDOUT: "b''"
2021-06-16 08:54:53.589346 (MainThread): STDERR: "b''"
2021-06-16 08:54:53.589462 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:54:54.108673 (MainThread): STDOUT: "b''"
2021-06-16 08:54:54.108989 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n'"
2021-06-16 08:54:54.109194 (MainThread): Executing "git tag --list"
2021-06-16 08:54:54.113284 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:54:54.113544 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.113688 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:54:54.135009 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:54:54.135279 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.135416 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:54.138689 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:54:54.138957 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.139083 (MainThread):   Checked out at ac78d49.
2021-06-16 08:54:54.148289 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:54:54.151511 (MainThread): STDOUT: "b''"
2021-06-16 08:54:54.151746 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:54:54.151856 (MainThread): command return code=128
2021-06-16 08:54:54.152417 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:54:54.152553 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:54.155631 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:54:54.155875 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.156009 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:54:54.156105 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:54:54.159298 (MainThread): STDOUT: "b''"
2021-06-16 08:54:54.159542 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.159658 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:54:54.625162 (MainThread): STDOUT: "b''"
2021-06-16 08:54:54.625483 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n'"
2021-06-16 08:54:54.625619 (MainThread): Executing "git tag --list"
2021-06-16 08:54:54.629942 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:54:54.630190 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.630336 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:54:54.637130 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:54:54.637391 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.637534 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:54.640801 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:54:54.641036 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.641171 (MainThread):   Already at ac78d49, nothing to do.
2021-06-16 08:54:54.650650 (MainThread): Installing https://github.com/fishtown-analytics/dbt-utils.git@0.6.3
2021-06-16 08:54:54.657779 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:54:54.661412 (MainThread): STDOUT: "b''"
2021-06-16 08:54:54.661650 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:54:54.661751 (MainThread): command return code=128
2021-06-16 08:54:54.661937 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:54:54.662059 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:54.665293 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:54:54.665539 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.665683 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:54:54.665778 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:54:54.669027 (MainThread): STDOUT: "b''"
2021-06-16 08:54:54.669290 (MainThread): STDERR: "b''"
2021-06-16 08:54:54.669408 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:54:55.112404 (MainThread): STDOUT: "b''"
2021-06-16 08:54:55.112712 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n'"
2021-06-16 08:54:55.112844 (MainThread): Executing "git tag --list"
2021-06-16 08:54:55.117073 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:54:55.117319 (MainThread): STDERR: "b''"
2021-06-16 08:54:55.117467 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:54:55.124114 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:54:55.124359 (MainThread): STDERR: "b''"
2021-06-16 08:54:55.124499 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:54:55.127539 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:54:55.127790 (MainThread): STDERR: "b''"
2021-06-16 08:54:55.127922 (MainThread):   Already at ac78d49, nothing to do.
2021-06-16 08:54:55.128161 (MainThread):   Installed from revision 0.6.3

2021-06-16 08:54:55.128490 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4913d4a-9550-44ab-b1ed-752d1fe7c2d5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d128d7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d128d7050>]}
2021-06-16 08:54:55.129107 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d166f2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d18c00e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d12935290>]}
2021-06-16 08:54:55.129327 (MainThread): Flushing usage events
2021-06-16 08:54:59.526313 (MainThread): Running with dbt=0.19.1
2021-06-16 08:54:59.769260 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:54:59.769744 (MainThread): Tracking: tracking
2021-06-16 08:54:59.775553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e4eee750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e22ae690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e22ae990>]}
2021-06-16 08:54:59.805468 (MainThread): Partial parsing not enabled
2021-06-16 08:54:59.806664 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:54:59.846209 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:54:59.864681 (MainThread): Parsing macros/relations.sql
2021-06-16 08:54:59.865599 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:54:59.866949 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:54:59.897156 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:54:59.900616 (MainThread): Parsing macros/relations.sql
2021-06-16 08:54:59.902605 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:54:59.906216 (MainThread): Parsing macros/core.sql
2021-06-16 08:54:59.912451 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:54:59.977142 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:54:59.990736 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:54:59.992196 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:54:59.994773 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:54:59.997872 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:55:00.000356 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:55:00.002069 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:55:00.021047 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:55:00.042839 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:55:00.045812 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:55:00.055703 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:55:00.087628 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:55:00.132916 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:55:00.135752 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:55:00.164074 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:55:00.174308 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:55:00.182228 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:55:00.191785 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:55:00.196004 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:55:00.198427 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:55:00.201313 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:55:00.205603 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 08:55:00.208893 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 08:55:00.210754 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 08:55:00.212133 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 08:55:00.215942 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 08:55:00.221300 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 08:55:00.231805 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 08:55:00.234391 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 08:55:00.238447 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 08:55:00.253257 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 08:55:00.255139 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 08:55:00.257574 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 08:55:00.260458 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 08:55:00.262287 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 08:55:00.266746 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 08:55:00.269126 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 08:55:00.270789 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 08:55:00.273618 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 08:55:00.275811 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 08:55:00.279659 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 08:55:00.282833 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 08:55:00.285938 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 08:55:00.294132 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 08:55:00.328578 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 08:55:00.330136 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 08:55:00.332434 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 08:55:00.334457 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 08:55:00.339748 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 08:55:00.341404 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 08:55:00.349349 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 08:55:00.350855 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 08:55:00.352858 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 08:55:00.356022 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 08:55:00.358241 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 08:55:00.360760 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 08:55:00.364611 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 08:55:00.369896 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 08:55:00.376030 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 08:55:00.379017 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 08:55:00.382919 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 08:55:00.386740 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 08:55:00.396251 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 08:55:00.397814 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 08:55:00.399288 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 08:55:00.401122 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 08:55:00.402973 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 08:55:00.407229 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 08:55:00.408813 (MainThread): Parsing macros/sql/star.sql
2021-06-16 08:55:00.413281 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 08:55:00.417736 (MainThread): Parsing macros/sql/union.sql
2021-06-16 08:55:00.429785 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 08:55:00.439354 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 08:55:00.441520 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 08:55:00.443261 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 08:55:00.446604 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 08:55:00.451727 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 08:55:00.453112 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 08:55:00.454152 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 08:55:00.455237 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 08:55:00.464584 (MainThread): Partial parsing not enabled
2021-06-16 08:55:00.510935 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:00.526820 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:00.532817 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:00.544786 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:55:00.546804 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:00.550486 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:55:00.552431 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:00.557297 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:55:00.559345 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:55:00.564205 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:55:00.566206 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:00.569850 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:55:00.833282 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:55:00.851561 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e1e46f10>]}
2021-06-16 08:55:00.859780 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e21e8a10>]}
2021-06-16 08:55:00.860162 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:55:00.861577 (MainThread): 
2021-06-16 08:55:00.862058 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:55:00.863566 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:55:00.879476 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:55:00.879626 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:55:00.879747 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:55:00.879841 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:00.898669 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:55:00.901631 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:55:00.902282 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:55:00.904682 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:55:00.904823 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:55:00.904939 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:55:00.905035 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:00.916965 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:55:00.917458 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:55:00.918053 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:55:00.920805 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:55:00.920944 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:55:00.921059 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:55:00.921153 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:00.932985 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:55:00.933519 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:55:00.935987 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:55:00.946091 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:55:00.946238 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:55:00.946350 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:55:00.946440 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:00.957656 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:00.957814 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:55:00.957937 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:55:00.960604 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:55:00.961362 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:55:00.962284 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:55:00.962933 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:55:00.965300 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:55:00.965435 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:55:00.965544 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:55:00.965635 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:00.976628 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:00.976778 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:55:00.976887 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:55:00.979435 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:55:00.980158 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:55:00.981069 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:55:00.981691 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:55:00.984080 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:55:00.984207 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:55:00.984317 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:55:00.984409 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:00.995236 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:00.995405 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:55:00.995518 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:55:00.997986 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 08:55:00.998675 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:55:00.999565 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:55:01.006578 (MainThread): Using redshift connection "master".
2021-06-16 08:55:01.006710 (MainThread): On master: BEGIN
2021-06-16 08:55:01.006833 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:55:01.007049 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.017951 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.018112 (MainThread): Using redshift connection "master".
2021-06-16 08:55:01.018220 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:55:01.168567 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 08:55:01.169696 (MainThread): On master: ROLLBACK
2021-06-16 08:55:01.170661 (MainThread): Using redshift connection "master".
2021-06-16 08:55:01.170782 (MainThread): On master: BEGIN
2021-06-16 08:55:01.172476 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.172612 (MainThread): On master: COMMIT
2021-06-16 08:55:01.172725 (MainThread): Using redshift connection "master".
2021-06-16 08:55:01.172820 (MainThread): On master: COMMIT
2021-06-16 08:55:01.173690 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.173832 (MainThread): On master: Close
2021-06-16 08:55:01.174408 (MainThread): 08:55:01 | Concurrency: 1 threads (target='dev')
2021-06-16 08:55:01.174771 (MainThread): 08:55:01 | 
2021-06-16 08:55:01.176715 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:55:01.177087 (Thread-1): 08:55:01 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:55:01.177443 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.177608 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:55:01.182532 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:55:01.182933 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.209217 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.209420 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:55:01.209538 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:55:01.209641 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.221271 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.228148 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.228296 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:55:01.229332 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.230398 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:55:01.230522 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.230624 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:55:01.231501 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.231638 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.231739 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:55:01.232595 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.232765 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:55:01.232869 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.232962 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:55:01.233867 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.234004 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.234103 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:55:01.234966 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.237076 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.237204 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:55:01.238240 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.239223 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:55:01.239362 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.239469 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:55:01.240381 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.240516 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.240616 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:55:01.241521 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.249874 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:55:01.250309 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:55:01.250429 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
    , 
    getdate()
           as dbt_load_timestamp
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:55:01.251732 (Thread-1): Postgres error: function getdate() does not exist
LINE 19:     getdate()
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-06-16 08:55:01.251879 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:55:01.252822 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.252995 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:55:01.253493 (Thread-1): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  function getdate() does not exist
  LINE 19:     getdate()
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function getdate() does not exist
LINE 19:     getdate()
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  function getdate() does not exist
  LINE 19:     getdate()
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 08:55:01.255478 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e1e6ff90>]}
2021-06-16 08:55:01.255883 (Thread-1): 08:55:01 | 1 of 7 ERROR creating view model sifa_cleansing.cls_customers........ [ERROR in 0.08s]
2021-06-16 08:55:01.256185 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:55:01.256378 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:55:01.256929 (Thread-1): 08:55:01 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:55:01.257358 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.257512 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:55:01.261096 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:55:01.261431 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.283606 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.283803 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:55:01.283918 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:55:01.284012 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.295427 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.297845 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.297974 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:55:01.299015 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:55:01.300023 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.300151 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.300256 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.301150 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.301288 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.301401 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:55:01.302297 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.302460 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.302562 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.302656 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.303527 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.303657 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.303753 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:55:01.304613 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.306800 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.306957 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:55:01.307925 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:55:01.308874 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.309000 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.309102 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.310012 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.310149 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.310249 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:55:01.311127 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.330238 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:55:01.330733 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.330858 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:55:01.332733 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:55:01.341443 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.341608 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:55:01.342821 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.345833 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.345969 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:55:01.347006 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.358134 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.358310 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.358415 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.360490 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.363018 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.363150 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:55:01.364090 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.366393 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.366517 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:55:01.368000 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:55:01.369026 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.369157 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.369266 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:55:01.372352 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.372500 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:55:01.372607 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:55:01.373528 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.374146 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.374322 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:55:01.375208 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:55:01.375797 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e1e83fd0>]}
2021-06-16 08:55:01.376259 (Thread-1): 08:55:01 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.12s]
2021-06-16 08:55:01.376559 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:55:01.376757 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:55:01.377220 (Thread-1): 08:55:01 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:55:01.377632 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.377781 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:55:01.381903 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:55:01.382288 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.384814 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.384988 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:55:01.385116 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:55:01.385214 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.397148 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.401377 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.401516 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:55:01.402601 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.403617 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.403765 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.403875 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.404789 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.404932 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.405036 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:55:01.405995 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.406162 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.406265 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.406359 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.407216 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.407359 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.407457 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:55:01.408316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.410395 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.410520 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:55:01.411509 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.412425 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.412554 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.412668 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.413620 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.413756 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.413858 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:55:01.415749 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.416425 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:55:01.416826 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.416946 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:55:01.418986 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:55:01.422080 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.422210 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:55:01.423322 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.426191 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.426322 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:55:01.427398 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.428724 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.428851 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.428955 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.431061 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.431335 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.431448 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:55:01.432364 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.434406 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.434529 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:55:01.435849 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.436736 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.436864 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.436969 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:55:01.438675 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.438813 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:55:01.438937 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:55:01.439846 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.440370 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.440543 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:55:01.441441 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:55:01.442021 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e218ff90>]}
2021-06-16 08:55:01.442488 (Thread-1): 08:55:01 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:55:01.442778 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:55:01.443002 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:55:01.443370 (Thread-1): 08:55:01 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:55:01.443802 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.443955 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:55:01.446861 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:55:01.447250 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.449587 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.449720 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:55:01.449829 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:55:01.449924 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.461598 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.464080 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.464223 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:55:01.465309 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.466356 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.466484 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.466590 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.467537 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.467683 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.467784 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:55:01.468671 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.468836 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.468939 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.469031 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.469969 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.470095 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.470190 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:55:01.471109 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.473329 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.473453 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:55:01.474457 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.475437 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.475567 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.475671 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.476619 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.476752 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.476850 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:55:01.477778 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.478540 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:55:01.478966 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.479092 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 'dummy'
  ) ;

2021-06-16 08:55:01.480692 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:55:01.483838 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.483966 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 08:55:01.485123 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.488212 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.488342 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:55:01.489406 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.490722 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.490845 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.490976 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.492824 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.493110 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.493220 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:55:01.494162 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.498192 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.498339 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:55:01.499736 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.500719 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.500843 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.500960 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:55:01.502764 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.502937 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:55:01.503050 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:55:01.504005 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.504699 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.504875 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:55:01.505795 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:55:01.506407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e2147350>]}
2021-06-16 08:55:01.506917 (Thread-1): 08:55:01 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.06s]
2021-06-16 08:55:01.507230 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:55:01.507433 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:55:01.507795 (Thread-1): 08:55:01 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:55:01.508222 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.508374 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:55:01.511391 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:55:01.511747 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.514022 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.514156 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:55:01.514268 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:55:01.514363 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.526844 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.529330 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.529469 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:55:01.530508 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:55:01.531544 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.531677 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.531782 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.532653 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.532786 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.532884 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:55:01.533767 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.533939 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.534042 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.534135 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.535014 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.535150 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.535257 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:55:01.536122 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.538295 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.538430 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:55:01.539380 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:55:01.540302 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.540425 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.540528 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.541428 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.541564 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.541665 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:55:01.543126 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.544157 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:55:01.544544 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.544672 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 08:55:01.549661 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:55:01.552872 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.552999 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders" rename to "fact_orders__dbt_backup"
2021-06-16 08:55:01.554061 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.556935 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.557066 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 08:55:01.558653 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.559914 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.560042 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.560153 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.562334 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.562595 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.562703 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:55:01.563639 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.565851 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.565986 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:55:01.567390 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:55:01.568360 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.568484 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.568594 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:55:01.571731 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.571869 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:55:01.571968 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:55:01.572874 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.573440 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.573613 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:55:01.574520 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:55:01.575126 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e1e0f6d0>]}
2021-06-16 08:55:01.575594 (Thread-1): 08:55:01 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.07s]
2021-06-16 08:55:01.575896 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:55:01.576087 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:55:01.576350 (Thread-1): 08:55:01 | 6 of 7 SKIP relation sifa_core.dim_customers......................... [SKIP]
2021-06-16 08:55:01.576602 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:55:01.576787 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:55:01.577108 (Thread-1): 08:55:01 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:55:01.577511 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.577661 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:55:01.581145 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:55:01.581508 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.584099 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.584241 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:55:01.584356 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:55:01.584450 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.595904 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.598244 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.598372 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:55:01.599520 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.600504 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.600637 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.600740 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.601663 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.601796 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.601917 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:55:01.602852 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.603039 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.603141 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.603239 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.604185 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.604315 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.604413 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:55:01.605346 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.609254 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.609393 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:55:01.610434 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.611386 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.611514 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.611616 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.612514 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.612651 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.612749 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:55:01.613633 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.614289 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:55:01.614667 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.614791 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:55:01.616654 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:55:01.619564 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.619692 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:55:01.620754 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:55:01.622064 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.622199 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.622316 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.624100 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.624402 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.624524 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:55:01.625501 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.627764 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.627899 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:55:01.628883 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:55:01.629814 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.629949 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.630063 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:55:01.630964 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.631105 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:55:01.631213 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:55:01.632100 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:55:01.632633 (Thread-1): finished collecting timing info
2021-06-16 08:55:01.632804 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:55:01.634558 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:55:01.635173 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2c9cc8f-ddb2-4af8-8403-ea0078009c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e2134c90>]}
2021-06-16 08:55:01.635639 (Thread-1): 08:55:01 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.06s]
2021-06-16 08:55:01.635926 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:55:01.686194 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:55:01.686457 (MainThread): Using redshift connection "master".
2021-06-16 08:55:01.686564 (MainThread): On master: BEGIN
2021-06-16 08:55:01.686670 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:55:01.686759 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:55:01.699218 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:55:01.699454 (MainThread): On master: COMMIT
2021-06-16 08:55:01.699562 (MainThread): Using redshift connection "master".
2021-06-16 08:55:01.699663 (MainThread): On master: COMMIT
2021-06-16 08:55:01.700600 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:55:01.700747 (MainThread): On master: Close
2021-06-16 08:55:01.701381 (MainThread): 08:55:01 | 
2021-06-16 08:55:01.701700 (MainThread): 08:55:01 | Finished running 4 view models, 3 table models in 0.84s.
2021-06-16 08:55:01.701939 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:55:01.702060 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:55:01.702154 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:55:01.710455 (MainThread): 
2021-06-16 08:55:01.710803 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:55:01.711095 (MainThread): 
2021-06-16 08:55:01.711383 (MainThread): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 08:55:01.711605 (MainThread):   function getdate() does not exist
2021-06-16 08:55:01.711816 (MainThread):   LINE 19:     getdate()
2021-06-16 08:55:01.712034 (MainThread):                ^
2021-06-16 08:55:01.712237 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-06-16 08:55:01.712434 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 08:55:01.712647 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
2021-06-16 08:55:01.712922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e1d5a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e1d5a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e21360d0>]}
2021-06-16 08:55:01.713163 (MainThread): Flushing usage events
2021-06-16 08:56:26.664067 (MainThread): Running with dbt=0.19.1
2021-06-16 08:56:26.912645 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:56:26.913163 (MainThread): Tracking: tracking
2021-06-16 08:56:26.919130 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709eb6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709eb68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709eb6bd0>]}
2021-06-16 08:56:26.950076 (MainThread): Partial parsing not enabled
2021-06-16 08:56:26.951307 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:56:26.991136 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:56:27.010320 (MainThread): Parsing macros/relations.sql
2021-06-16 08:56:27.011348 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:56:27.012680 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:56:27.043255 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:56:27.046821 (MainThread): Parsing macros/relations.sql
2021-06-16 08:56:27.048850 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:56:27.052492 (MainThread): Parsing macros/core.sql
2021-06-16 08:56:27.058835 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:56:27.124099 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:56:27.137829 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:56:27.139363 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:56:27.141885 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:56:27.144979 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:56:27.147457 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:56:27.149101 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:56:27.162989 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:56:27.184035 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:56:27.186983 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:56:27.196939 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:56:27.229024 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:56:27.274377 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:56:27.277179 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:56:27.305486 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:56:27.315606 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:56:27.323508 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:56:27.333129 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:56:27.337310 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:56:27.339692 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:56:27.342563 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:56:27.346722 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 08:56:27.349973 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 08:56:27.351866 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 08:56:27.353221 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 08:56:27.357067 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 08:56:27.362454 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 08:56:27.372927 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 08:56:27.375498 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 08:56:27.379437 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 08:56:27.394199 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 08:56:27.396150 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 08:56:27.398590 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 08:56:27.401451 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 08:56:27.403371 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 08:56:27.407884 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 08:56:27.410096 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 08:56:27.411764 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 08:56:27.414544 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 08:56:27.416682 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 08:56:27.420392 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 08:56:27.423705 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 08:56:27.426907 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 08:56:27.435084 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 08:56:27.469762 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 08:56:27.471379 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 08:56:27.473589 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 08:56:27.475639 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 08:56:27.480969 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 08:56:27.482670 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 08:56:27.490815 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 08:56:27.492348 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 08:56:27.494239 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 08:56:27.497384 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 08:56:27.499608 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 08:56:27.502018 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 08:56:27.505878 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 08:56:27.511236 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 08:56:27.517408 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 08:56:27.520450 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 08:56:27.524477 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 08:56:27.528486 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 08:56:27.537983 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 08:56:27.539565 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 08:56:27.540957 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 08:56:27.542771 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 08:56:27.544614 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 08:56:27.548891 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 08:56:27.550534 (MainThread): Parsing macros/sql/star.sql
2021-06-16 08:56:27.555046 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 08:56:27.559648 (MainThread): Parsing macros/sql/union.sql
2021-06-16 08:56:27.571569 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 08:56:27.581276 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 08:56:27.583392 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 08:56:27.585138 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 08:56:27.588515 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 08:56:27.593661 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 08:56:27.595135 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 08:56:27.596222 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 08:56:27.597310 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 08:56:27.606645 (MainThread): Partial parsing not enabled
2021-06-16 08:56:27.652918 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:27.668522 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:27.674349 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:27.686084 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:56:27.688094 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:27.691638 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:56:27.693514 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:27.698299 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:56:27.700241 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:56:27.705082 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:56:27.707100 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:27.710668 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:56:27.972354 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:56:27.990754 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709bf0650>]}
2021-06-16 08:56:27.998780 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709bc5990>]}
2021-06-16 08:56:27.999110 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:56:28.000486 (MainThread): 
2021-06-16 08:56:28.000971 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:56:28.002497 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:56:28.020385 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:56:28.020542 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:56:28.020657 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:56:28.020753 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.039616 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:56:28.042487 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:56:28.043181 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:56:28.045651 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:56:28.045779 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:56:28.045895 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:56:28.045993 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.056951 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:56:28.057444 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:56:28.058036 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:56:28.060703 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:56:28.060832 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:56:28.060951 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:56:28.061046 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.072208 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:56:28.072710 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:56:28.075234 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:56:28.085514 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:56:28.085657 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:56:28.085774 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:56:28.085871 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.096825 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.096968 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:56:28.097077 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:56:28.099739 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:56:28.100465 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:56:28.101397 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:56:28.102004 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:56:28.104486 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:56:28.104626 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:56:28.104739 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:56:28.104835 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.115716 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.115868 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:56:28.115991 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:56:28.118591 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 08:56:28.119256 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:56:28.120190 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:56:28.120756 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:56:28.123067 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:56:28.123198 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:56:28.123329 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:56:28.123422 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.134142 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.134287 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:56:28.134399 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:56:28.136965 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:56:28.137648 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:56:28.138604 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:56:28.145496 (MainThread): Using redshift connection "master".
2021-06-16 08:56:28.145631 (MainThread): On master: BEGIN
2021-06-16 08:56:28.145742 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:56:28.145836 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.156749 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.156893 (MainThread): Using redshift connection "master".
2021-06-16 08:56:28.157004 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:56:28.309045 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 08:56:28.310152 (MainThread): On master: ROLLBACK
2021-06-16 08:56:28.311114 (MainThread): Using redshift connection "master".
2021-06-16 08:56:28.311233 (MainThread): On master: BEGIN
2021-06-16 08:56:28.312902 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.313033 (MainThread): On master: COMMIT
2021-06-16 08:56:28.313136 (MainThread): Using redshift connection "master".
2021-06-16 08:56:28.313235 (MainThread): On master: COMMIT
2021-06-16 08:56:28.314125 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.314263 (MainThread): On master: Close
2021-06-16 08:56:28.314830 (MainThread): 08:56:28 | Concurrency: 1 threads (target='dev')
2021-06-16 08:56:28.315184 (MainThread): 08:56:28 | 
2021-06-16 08:56:28.317023 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:56:28.317349 (Thread-1): 08:56:28 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:56:28.317683 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.317836 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:56:28.322740 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:56:28.323130 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.348954 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.349113 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:56:28.349226 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:56:28.349327 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.360646 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.367184 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.367318 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:56:28.368339 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.369399 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:56:28.369524 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.369640 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:56:28.370519 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.370656 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.370755 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:56:28.371618 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.371784 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:56:28.371893 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.371985 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:56:28.372895 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.373069 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.373194 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:56:28.374085 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.376248 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.376381 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:56:28.377389 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.378319 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:56:28.378447 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.378562 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:56:28.379491 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.379632 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.379734 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:56:28.380676 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.388725 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:56:28.389105 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:56:28.389238 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
    , 
    getdate()
          as dbt_load_timestamp
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:56:28.390486 (Thread-1): Postgres error: function getdate() does not exist
LINE 19:     getdate()
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-06-16 08:56:28.390616 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:56:28.391537 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.391705 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:56:28.392170 (Thread-1): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  function getdate() does not exist
  LINE 19:     getdate()
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function getdate() does not exist
LINE 19:     getdate()
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  function getdate() does not exist
  LINE 19:     getdate()
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 08:56:28.393978 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709a94f50>]}
2021-06-16 08:56:28.394384 (Thread-1): 08:56:28 | 1 of 7 ERROR creating view model sifa_cleansing.cls_customers........ [ERROR in 0.08s]
2021-06-16 08:56:28.394686 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:56:28.394909 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:56:28.395444 (Thread-1): 08:56:28 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:56:28.395882 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.396033 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:56:28.399226 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:56:28.399536 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.419409 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.419609 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:56:28.419727 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:56:28.419823 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.431683 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.433798 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.433924 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:56:28.434948 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:56:28.435936 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.436062 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.436168 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.437057 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.437200 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.437302 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:56:28.438189 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.438353 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.438456 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.438557 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.439490 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.439670 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.439789 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:56:28.440738 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.442794 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.442943 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:56:28.444038 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:56:28.444969 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.445096 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.445219 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.446138 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.446278 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.446381 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:56:28.447289 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.466055 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:56:28.466466 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.466594 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:56:28.468337 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:56:28.476446 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.476588 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:56:28.477680 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.480449 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.480577 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:56:28.481560 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.492682 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.492821 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.492926 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.494610 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.497057 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.497197 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:56:28.498130 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.500316 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.500442 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:56:28.501943 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:56:28.502905 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.503049 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.503157 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:56:28.506027 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.506164 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:56:28.506267 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:56:28.507301 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.507851 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.508021 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:56:28.508907 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:56:28.509459 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27099aaad0>]}
2021-06-16 08:56:28.509894 (Thread-1): 08:56:28 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.11s]
2021-06-16 08:56:28.510182 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:56:28.510365 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:56:28.510809 (Thread-1): 08:56:28 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:56:28.511249 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.511394 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:56:28.515038 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:56:28.515376 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.517726 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.517856 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:56:28.517966 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:56:28.518061 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.529180 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.533113 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.533250 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:56:28.534291 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.535294 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.535435 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.535542 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.536446 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.536606 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.536707 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:56:28.537594 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.537771 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.537872 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.537963 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.538864 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.539013 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.539110 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:56:28.539974 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.541930 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.542051 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:56:28.543035 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.543948 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.544098 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.544205 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.545111 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.545257 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.545359 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:56:28.546235 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.546943 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:56:28.547324 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.547446 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:56:28.549216 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:56:28.552089 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.552215 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:56:28.553283 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.556077 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.556208 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:56:28.557248 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.558542 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.558670 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.558775 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.560604 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.560883 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.561015 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:56:28.561924 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.563998 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.564128 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:56:28.565444 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.566342 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.566486 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.566590 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:56:28.568263 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.568410 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:56:28.568514 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:56:28.569430 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.569930 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.570095 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:56:28.570968 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:56:28.571505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27099aaad0>]}
2021-06-16 08:56:28.571945 (Thread-1): 08:56:28 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:56:28.572225 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:56:28.572411 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:56:28.572752 (Thread-1): 08:56:28 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:56:28.573158 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.573314 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:56:28.576058 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:56:28.576368 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.578679 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.578809 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:56:28.578957 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:56:28.579066 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.590075 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.592219 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.592358 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:56:28.593399 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.594381 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.594518 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.594628 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.595519 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.595665 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.595771 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:56:28.596681 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.596866 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.596974 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.597071 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.597957 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.598100 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.598218 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:56:28.599062 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.601028 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.601161 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:56:28.602139 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.603085 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.603220 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.603330 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.604219 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.604357 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.604459 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:56:28.605355 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.606067 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:56:28.606438 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.606574 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 'dummy'
  ) ;

2021-06-16 08:56:28.608106 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:56:28.611084 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.611214 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 08:56:28.612294 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.615316 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.615459 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:56:28.616514 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.617859 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.617988 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.618095 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.619777 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.620125 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.620237 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:56:28.621137 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.624844 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.624975 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:56:28.626223 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.627145 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.627294 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.627405 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:56:28.628953 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.629086 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:56:28.629194 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:56:28.630073 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.630568 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.630732 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:56:28.631669 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:56:28.632216 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709d6c3d0>]}
2021-06-16 08:56:28.632657 (Thread-1): 08:56:28 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.06s]
2021-06-16 08:56:28.632937 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:56:28.633126 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:56:28.633493 (Thread-1): 08:56:28 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:56:28.633913 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.634063 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:56:28.636818 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:56:28.637156 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.639334 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.639468 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:56:28.639580 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:56:28.639684 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.650622 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.652645 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.652774 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:56:28.653769 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:56:28.654726 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.654863 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.655017 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.655921 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.656062 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.656167 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:56:28.657068 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.657245 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.657351 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.657448 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.658320 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.658457 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.658555 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:56:28.659431 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.661375 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.661505 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:56:28.662519 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:56:28.663458 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.663593 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.663703 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.664591 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.664731 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.664843 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:56:28.665717 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.666704 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:56:28.667083 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.667209 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 08:56:28.672018 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:56:28.675050 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.675179 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders" rename to "fact_orders__dbt_backup"
2021-06-16 08:56:28.676239 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.679099 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.679229 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 08:56:28.680249 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.681501 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.681628 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.681733 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.683553 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.683839 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.683954 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:56:28.684858 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.686916 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.687051 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:56:28.688396 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:56:28.689320 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.689446 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.689550 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:56:28.692615 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.692761 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:56:28.692863 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:56:28.693780 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.694286 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.694461 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:56:28.695344 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:56:28.695906 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709c5c490>]}
2021-06-16 08:56:28.696347 (Thread-1): 08:56:28 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.06s]
2021-06-16 08:56:28.696629 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:56:28.696816 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:56:28.697074 (Thread-1): 08:56:28 | 6 of 7 SKIP relation sifa_core.dim_customers......................... [SKIP]
2021-06-16 08:56:28.697321 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:56:28.697497 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:56:28.697809 (Thread-1): 08:56:28 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:56:28.698222 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.698371 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:56:28.701609 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:56:28.701937 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.704341 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.704479 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:56:28.704595 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:56:28.704691 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.715804 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.717832 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.717957 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:56:28.719043 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.719996 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.720192 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.720305 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.721221 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.721357 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.721473 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:56:28.722360 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.722529 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.722632 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.722725 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.723608 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.723744 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.723851 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:56:28.724740 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.728375 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.728504 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:56:28.729460 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.730339 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.730473 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.730580 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.731487 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.731627 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.731729 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:56:28.732639 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.733277 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:56:28.733644 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.733767 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:56:28.735505 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:56:28.738254 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.738379 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:56:28.739458 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:56:28.740785 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.740915 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.741019 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.742773 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.743061 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.743176 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:56:28.744064 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.746043 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.746167 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:56:28.747197 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:56:28.748091 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.748219 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.748324 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:56:28.749195 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.749335 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:56:28.749436 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:56:28.750329 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:56:28.750829 (Thread-1): finished collecting timing info
2021-06-16 08:56:28.751020 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:56:28.751966 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:56:28.752479 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76992722-a104-40cf-8c83-9a99b232e46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709d3fdd0>]}
2021-06-16 08:56:28.752910 (Thread-1): 08:56:28 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:56:28.753179 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:56:28.821019 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:56:28.821277 (MainThread): Using redshift connection "master".
2021-06-16 08:56:28.821389 (MainThread): On master: BEGIN
2021-06-16 08:56:28.821496 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:56:28.821588 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:56:28.833246 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:56:28.833415 (MainThread): On master: COMMIT
2021-06-16 08:56:28.833529 (MainThread): Using redshift connection "master".
2021-06-16 08:56:28.833633 (MainThread): On master: COMMIT
2021-06-16 08:56:28.834546 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:56:28.834690 (MainThread): On master: Close
2021-06-16 08:56:28.835233 (MainThread): 08:56:28 | 
2021-06-16 08:56:28.835533 (MainThread): 08:56:28 | Finished running 4 view models, 3 table models in 0.83s.
2021-06-16 08:56:28.835780 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:56:28.835892 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:56:28.835983 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:56:28.843893 (MainThread): 
2021-06-16 08:56:28.844173 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:56:28.844413 (MainThread): 
2021-06-16 08:56:28.844690 (MainThread): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 08:56:28.844902 (MainThread):   function getdate() does not exist
2021-06-16 08:56:28.845101 (MainThread):   LINE 19:     getdate()
2021-06-16 08:56:28.845337 (MainThread):                ^
2021-06-16 08:56:28.845533 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-06-16 08:56:28.845725 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 08:56:28.845926 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
2021-06-16 08:56:28.846187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709d7d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709d1f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2709d45110>]}
2021-06-16 08:56:28.846425 (MainThread): Flushing usage events
2021-06-16 08:56:54.360127 (MainThread): Running with dbt=0.19.1
2021-06-16 08:56:54.600485 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:56:54.600989 (MainThread): Tracking: tracking
2021-06-16 08:56:54.606799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d59aa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d594df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d594de90>]}
2021-06-16 08:56:54.607860 (MainThread): Set downloads directory='/tmp/dbt-downloads-o7ys990r'
2021-06-16 08:56:54.608376 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:56:55.096481 (MainThread): STDOUT: "b''"
2021-06-16 08:56:55.096805 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-06-16 08:56:55.097294 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:56:55.097443 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:56:55.101169 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:56:55.101416 (MainThread): STDERR: "b''"
2021-06-16 08:56:55.101555 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:56:55.101660 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:56:55.104949 (MainThread): STDOUT: "b''"
2021-06-16 08:56:55.105213 (MainThread): STDERR: "b''"
2021-06-16 08:56:55.105338 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:56:55.688746 (MainThread): STDOUT: "b''"
2021-06-16 08:56:55.689076 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n'"
2021-06-16 08:56:55.689217 (MainThread): Executing "git tag --list"
2021-06-16 08:56:55.693265 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:56:55.693544 (MainThread): STDERR: "b''"
2021-06-16 08:56:55.693695 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:56:55.715064 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:56:55.715374 (MainThread): STDERR: "b''"
2021-06-16 08:56:55.715515 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:56:55.719169 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:56:55.719413 (MainThread): STDERR: "b''"
2021-06-16 08:56:55.719541 (MainThread):   Checked out at ac78d49.
2021-06-16 08:56:55.728693 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:56:55.731839 (MainThread): STDOUT: "b''"
2021-06-16 08:56:55.732074 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:56:55.732179 (MainThread): command return code=128
2021-06-16 08:56:55.732768 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:56:55.732917 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:56:55.735977 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:56:55.736217 (MainThread): STDERR: "b''"
2021-06-16 08:56:55.736350 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:56:55.736449 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:56:55.739571 (MainThread): STDOUT: "b''"
2021-06-16 08:56:55.739814 (MainThread): STDERR: "b''"
2021-06-16 08:56:55.739933 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:56:56.228072 (MainThread): STDOUT: "b''"
2021-06-16 08:56:56.228389 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n'"
2021-06-16 08:56:56.228535 (MainThread): Executing "git tag --list"
2021-06-16 08:56:56.232580 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:56:56.232850 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.232997 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:56:56.241147 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:56:56.241392 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.241531 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:56:56.244527 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:56:56.244781 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.244920 (MainThread):   Already at ac78d49, nothing to do.
2021-06-16 08:56:56.254206 (MainThread): Installing https://github.com/fishtown-analytics/dbt-utils.git@0.6.3
2021-06-16 08:56:56.263276 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:56:56.266391 (MainThread): STDOUT: "b''"
2021-06-16 08:56:56.266622 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:56:56.266726 (MainThread): command return code=128
2021-06-16 08:56:56.266950 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:56:56.267086 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:56:56.270008 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:56:56.270243 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.270383 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:56:56.270488 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:56:56.273575 (MainThread): STDOUT: "b''"
2021-06-16 08:56:56.273824 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.273949 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:56:56.720487 (MainThread): STDOUT: "b''"
2021-06-16 08:56:56.720819 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n'"
2021-06-16 08:56:56.720963 (MainThread): Executing "git tag --list"
2021-06-16 08:56:56.725182 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:56:56.725430 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.725583 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:56:56.730155 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:56:56.730401 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.730544 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:56:56.733453 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:56:56.733703 (MainThread): STDERR: "b''"
2021-06-16 08:56:56.733850 (MainThread):   Already at ac78d49, nothing to do.
2021-06-16 08:56:56.734091 (MainThread):   Installed from revision 0.6.3

2021-06-16 08:56:56.734434 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '58bf159e-69af-4d88-9596-dacacf7d3ee2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d595ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d595e690>]}
2021-06-16 08:56:56.735190 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d59aa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d85ca510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d59bd4d0>]}
2021-06-16 08:56:56.735431 (MainThread): Flushing usage events
2021-06-16 08:58:47.244806 (MainThread): Running with dbt=0.19.1
2021-06-16 08:58:47.483363 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-06-16 08:58:47.483879 (MainThread): Tracking: tracking
2021-06-16 08:58:47.489672 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d603b8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d62f9dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d62f9df90>]}
2021-06-16 08:58:47.490692 (MainThread): Set downloads directory='/tmp/dbt-downloads-r486wcgb'
2021-06-16 08:58:47.491231 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:58:47.981909 (MainThread): STDOUT: "b''"
2021-06-16 08:58:47.982219 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-06-16 08:58:47.982680 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:58:47.982822 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:58:47.986568 (MainThread): STDOUT: "b'2fbadf78d072afb3fccbc5047ed2c39696503e9d\n'"
2021-06-16 08:58:47.986804 (MainThread): STDERR: "b''"
2021-06-16 08:58:47.986986 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:58:47.987097 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:58:47.990303 (MainThread): STDOUT: "b''"
2021-06-16 08:58:47.990538 (MainThread): STDERR: "b''"
2021-06-16 08:58:47.990662 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:58:48.597025 (MainThread): STDOUT: "b''"
2021-06-16 08:58:48.597348 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n'"
2021-06-16 08:58:48.597496 (MainThread): Executing "git tag --list"
2021-06-16 08:58:48.601684 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:58:48.601931 (MainThread): STDERR: "b''"
2021-06-16 08:58:48.602074 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:58:48.622957 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:58:48.623260 (MainThread): STDERR: "b''"
2021-06-16 08:58:48.623414 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:58:48.627131 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:58:48.627387 (MainThread): STDERR: "b''"
2021-06-16 08:58:48.627515 (MainThread):   Checked out at ac78d49.
2021-06-16 08:58:48.636854 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:58:48.640131 (MainThread): STDOUT: "b''"
2021-06-16 08:58:48.640381 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:58:48.640495 (MainThread): command return code=128
2021-06-16 08:58:48.641067 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:58:48.641222 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:58:48.644295 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:58:48.644548 (MainThread): STDERR: "b''"
2021-06-16 08:58:48.644685 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:58:48.644784 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:58:48.648111 (MainThread): STDOUT: "b''"
2021-06-16 08:58:48.648359 (MainThread): STDERR: "b''"
2021-06-16 08:58:48.648483 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:58:49.108944 (MainThread): STDOUT: "b''"
2021-06-16 08:58:49.109245 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n'"
2021-06-16 08:58:49.109374 (MainThread): Executing "git tag --list"
2021-06-16 08:58:49.113472 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:58:49.113727 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.113874 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:58:49.120575 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:58:49.120814 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.120962 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:58:49.124051 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:58:49.124297 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.124428 (MainThread):   Already at ac78d49, nothing to do.
2021-06-16 08:58:49.133792 (MainThread): Installing https://github.com/fishtown-analytics/dbt-utils.git@0.6.3
2021-06-16 08:58:49.142606 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-06-16 08:58:49.146008 (MainThread): STDOUT: "b''"
2021-06-16 08:58:49.146257 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-06-16 08:58:49.146363 (MainThread): command return code=128
2021-06-16 08:58:49.146559 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-06-16 08:58:49.146683 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:58:49.149668 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:58:49.149904 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.150030 (MainThread):   Checking out branch 0.6.3.
2021-06-16 08:58:49.150131 (MainThread): Executing "git remote set-branches origin 0.6.3"
2021-06-16 08:58:49.153179 (MainThread): STDOUT: "b''"
2021-06-16 08:58:49.153431 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.153547 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.3"
2021-06-16 08:58:49.631985 (MainThread): STDOUT: "b''"
2021-06-16 08:58:49.632309 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.3      -> FETCH_HEAD\n'"
2021-06-16 08:58:49.632437 (MainThread): Executing "git tag --list"
2021-06-16 08:58:49.636846 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n'"
2021-06-16 08:58:49.637109 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.637260 (MainThread): Executing "git reset --hard tags/0.6.3"
2021-06-16 08:58:49.642083 (MainThread): STDOUT: "b'HEAD is now at ac78d49 Merge pull request #309 from fishtown-analytics/bump/0.19.0\n'"
2021-06-16 08:58:49.642331 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.642468 (MainThread): Executing "git rev-parse HEAD"
2021-06-16 08:58:49.645752 (MainThread): STDOUT: "b'ac78d49590ca04758d8ecdeb042eb8152bba6b0f\n'"
2021-06-16 08:58:49.646005 (MainThread): STDERR: "b''"
2021-06-16 08:58:49.646137 (MainThread):   Already at ac78d49, nothing to do.
2021-06-16 08:58:49.646371 (MainThread):   Installed from revision 0.6.3

2021-06-16 08:58:49.646727 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '7291e941-382b-487e-955f-c9727c01e09d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d6035ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d6035ad90>]}
2021-06-16 08:58:49.647576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d603b8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d62f9d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d62f9d210>]}
2021-06-16 08:58:49.647802 (MainThread): Flushing usage events
2021-06-16 08:58:55.824169 (MainThread): Running with dbt=0.19.1
2021-06-16 08:58:56.062350 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:58:56.062828 (MainThread): Tracking: tracking
2021-06-16 08:58:56.068628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef42db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f2f37250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef43cb10>]}
2021-06-16 08:58:56.098378 (MainThread): Partial parsing not enabled
2021-06-16 08:58:56.099591 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:58:56.139572 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:58:56.158257 (MainThread): Parsing macros/relations.sql
2021-06-16 08:58:56.159197 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:58:56.160501 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:58:56.190680 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:58:56.194054 (MainThread): Parsing macros/relations.sql
2021-06-16 08:58:56.196070 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:58:56.199620 (MainThread): Parsing macros/core.sql
2021-06-16 08:58:56.205824 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:58:56.270640 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:58:56.283993 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:58:56.285443 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:58:56.287998 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:58:56.290967 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:58:56.293405 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:58:56.295072 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:58:56.308842 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:58:56.329583 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:58:56.332444 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:58:56.342371 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:58:56.374170 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:58:56.419612 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:58:56.422304 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:58:56.450766 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:58:56.460854 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:58:56.468579 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:58:56.478155 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:58:56.482359 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:58:56.484860 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:58:56.491053 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:58:56.495318 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 08:58:56.498624 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 08:58:56.500534 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 08:58:56.501867 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 08:58:56.505690 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 08:58:56.511073 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 08:58:56.521756 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 08:58:56.524465 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 08:58:56.528622 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 08:58:56.543552 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 08:58:56.545443 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 08:58:56.547995 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 08:58:56.550790 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 08:58:56.552675 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 08:58:56.557305 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 08:58:56.559674 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 08:58:56.561323 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 08:58:56.564235 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 08:58:56.566407 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 08:58:56.570210 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 08:58:56.573417 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 08:58:56.576667 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 08:58:56.584983 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 08:58:56.620037 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 08:58:56.621572 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 08:58:56.623840 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 08:58:56.625853 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 08:58:56.631153 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 08:58:56.632796 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 08:58:56.640992 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 08:58:56.642504 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 08:58:56.644488 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 08:58:56.647700 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 08:58:56.649860 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 08:58:56.652324 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 08:58:56.656318 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 08:58:56.661550 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 08:58:56.667750 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 08:58:56.670736 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 08:58:56.674679 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 08:58:56.678605 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 08:58:56.688245 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 08:58:56.689759 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 08:58:56.691176 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 08:58:56.693039 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 08:58:56.694943 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 08:58:56.699166 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 08:58:56.700816 (MainThread): Parsing macros/sql/star.sql
2021-06-16 08:58:56.705349 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 08:58:56.709780 (MainThread): Parsing macros/sql/union.sql
2021-06-16 08:58:56.721629 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 08:58:56.731320 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 08:58:56.733380 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 08:58:56.735150 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 08:58:56.738389 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 08:58:56.743565 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 08:58:56.745000 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 08:58:56.746087 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 08:58:56.747214 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 08:58:56.756371 (MainThread): Partial parsing not enabled
2021-06-16 08:58:56.802503 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:56.817995 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:56.823938 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:56.832664 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:58:56.834562 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:56.838185 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:58:56.840112 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:56.844961 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:58:56.847000 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:58:56.851701 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:58:56.853792 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:56.857350 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:58:57.116712 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 08:58:57.136739 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef18f850>]}
2021-06-16 08:58:57.144716 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef377510>]}
2021-06-16 08:58:57.145006 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 08:58:57.146382 (MainThread): 
2021-06-16 08:58:57.146912 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:58:57.148432 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:58:57.164044 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:58:57.164179 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:58:57.164293 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 08:58:57.164399 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.182485 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 08:58:57.185385 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:58:57.186019 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:58:57.188373 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:58:57.188498 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:58:57.188604 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:58:57.188694 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.199695 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:58:57.200147 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:58:57.200716 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 08:58:57.203333 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 08:58:57.203473 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 08:58:57.203586 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 08:58:57.203689 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.214858 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 08:58:57.215424 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 08:58:57.217890 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:58:57.227903 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:58:57.228034 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 08:58:57.228143 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 08:58:57.228234 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.238815 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.238997 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 08:58:57.239112 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 08:58:57.241669 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 08:58:57.242382 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 08:58:57.243250 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 08:58:57.243880 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 08:58:57.246229 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:58:57.246351 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 08:58:57.246461 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:58:57.246552 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.257082 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.257228 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 08:58:57.257339 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 08:58:57.259903 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 08:58:57.260576 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 08:58:57.261487 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 08:58:57.262051 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 08:58:57.264434 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:58:57.264569 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 08:58:57.264681 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 08:58:57.264783 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.275087 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.275229 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 08:58:57.275338 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 08:58:57.277779 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:58:57.278379 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 08:58:57.279260 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 08:58:57.286082 (MainThread): Using redshift connection "master".
2021-06-16 08:58:57.286216 (MainThread): On master: BEGIN
2021-06-16 08:58:57.286325 (MainThread): Opening a new connection, currently in state init
2021-06-16 08:58:57.286416 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.297150 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.297296 (MainThread): Using redshift connection "master".
2021-06-16 08:58:57.297406 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 08:58:57.449839 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 08:58:57.450946 (MainThread): On master: ROLLBACK
2021-06-16 08:58:57.451906 (MainThread): Using redshift connection "master".
2021-06-16 08:58:57.452026 (MainThread): On master: BEGIN
2021-06-16 08:58:57.453736 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.453869 (MainThread): On master: COMMIT
2021-06-16 08:58:57.453977 (MainThread): Using redshift connection "master".
2021-06-16 08:58:57.454081 (MainThread): On master: COMMIT
2021-06-16 08:58:57.454971 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.455129 (MainThread): On master: Close
2021-06-16 08:58:57.455685 (MainThread): 08:58:57 | Concurrency: 1 threads (target='dev')
2021-06-16 08:58:57.455976 (MainThread): 08:58:57 | 
2021-06-16 08:58:57.457715 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 08:58:57.458224 (Thread-1): 08:58:57 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 08:58:57.458583 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.458735 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 08:58:57.463471 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:58:57.463817 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.490700 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.490867 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:58:57.495062 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:58:57.495180 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.506580 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.513428 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.513579 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 08:58:57.514612 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.515742 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:58:57.515875 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.515980 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:58:57.516874 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.517012 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.517114 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:58:57.517969 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.518129 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:58:57.518231 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.518323 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:58:57.519194 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.519393 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.519517 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:58:57.520426 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.522593 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.522718 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 08:58:57.523693 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.524598 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:58:57.524729 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.524834 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 08:58:57.525708 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.525848 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.525952 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 08:58:57.526845 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.535306 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 08:58:57.535758 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:58:57.535882 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
    , 08:58:57          as dbt_load_timestamp
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 08:58:57.537209 (Thread-1): Postgres error: syntax error at or near ":"
LINE 18:     , 08:58:57          as dbt_load_timestamp
                 ^

2021-06-16 08:58:57.537343 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 08:58:57.538273 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.538442 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 08:58:57.538934 (Thread-1): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  syntax error at or near ":"
  LINE 18:     , 08:58:57          as dbt_load_timestamp
                   ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ":"
LINE 18:     , 08:58:57          as dbt_load_timestamp
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  syntax error at or near ":"
  LINE 18:     , 08:58:57          as dbt_load_timestamp
                   ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 08:58:57.540857 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5eefda810>]}
2021-06-16 08:58:57.541276 (Thread-1): 08:58:57 | 1 of 7 ERROR creating view model sifa_cleansing.cls_customers........ [ERROR in 0.08s]
2021-06-16 08:58:57.541561 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 08:58:57.541751 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:58:57.542277 (Thread-1): 08:58:57 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 08:58:57.542687 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.542835 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:58:57.546277 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:58:57.546605 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.566724 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.566902 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:58:57.567036 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:58:57.567140 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.578504 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.580680 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.580810 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 08:58:57.581842 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:58:57.582839 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.582997 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.583109 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.584117 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.584256 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.584360 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:58:57.585284 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.585459 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.585563 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.585659 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.586576 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.586705 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.586802 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:58:57.587726 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.589675 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.589800 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:58:57.590843 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:58:57.591759 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.591883 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.591987 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.592903 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.593036 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.593135 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:58:57.594027 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.613105 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 08:58:57.613598 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.613723 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 08:58:57.615542 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 08:58:57.623907 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.624047 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 08:58:57.625263 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.628194 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.628325 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 08:58:57.629305 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.642306 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.642449 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.642556 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.644518 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.647056 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.647187 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:58:57.648129 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.650279 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.650404 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 08:58:57.651963 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:58:57.652879 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.653005 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.653111 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 08:58:57.656084 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.656226 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:58:57.656330 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 08:58:57.657252 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.657809 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.657987 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 08:58:57.658870 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 08:58:57.659448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef11ae50>]}
2021-06-16 08:58:57.659890 (Thread-1): 08:58:57 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.12s]
2021-06-16 08:58:57.660176 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 08:58:57.660363 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:58:57.660820 (Thread-1): 08:58:57 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 08:58:57.661227 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.661372 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 08:58:57.665111 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:58:57.665488 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.667810 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.667944 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:58:57.668056 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:58:57.668150 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.679388 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.683340 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.683482 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 08:58:57.684541 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.685564 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.685692 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.685799 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.686710 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.686856 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.686990 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:58:57.687904 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.688082 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.688190 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.688287 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.689182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.689324 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.689423 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:58:57.690330 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.692530 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.692669 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:58:57.693659 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.694648 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.694778 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.694907 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.695837 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.695974 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.696076 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:58:57.696974 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.697624 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 08:58:57.698018 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.698137 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 08:58:57.699982 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:58:57.703049 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.703177 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 08:58:57.704362 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.707257 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.707394 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 08:58:57.708487 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.709731 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.709855 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.709968 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.711896 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.712158 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.712268 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:58:57.713259 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.715466 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.715600 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 08:58:57.716903 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.717822 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.717956 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.718062 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 08:58:57.719626 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.719766 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:58:57.719868 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 08:58:57.720753 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.721248 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.721416 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 08:58:57.722303 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 08:58:57.722854 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef057d10>]}
2021-06-16 08:58:57.723351 (Thread-1): 08:58:57 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 08:58:57.723649 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 08:58:57.723844 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 08:58:57.724206 (Thread-1): 08:58:57 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 08:58:57.724632 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.724791 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 08:58:57.727550 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:58:57.727898 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.730184 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.730322 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:58:57.730433 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:58:57.730528 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.741727 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.743786 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.743920 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 08:58:57.744941 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.745871 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.746005 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.746111 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.747046 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.747185 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.747293 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:58:57.748189 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.748348 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.748450 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.748551 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.749437 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.749564 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.749661 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:58:57.750553 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.752552 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.752692 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:58:57.753694 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.754596 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.754726 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.754832 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.755780 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.755917 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.756019 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:58:57.756943 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.757616 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 08:58:57.757984 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.758106 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 'dummy'
  ) ;

2021-06-16 08:58:57.759672 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:58:57.762543 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.762668 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 08:58:57.763734 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.766677 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.766838 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 08:58:57.767891 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.769209 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.769334 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.769436 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.771080 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.771354 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.771464 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:58:57.772386 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.776067 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.776196 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 08:58:57.777454 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.778321 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.778446 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.778551 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 08:58:57.780015 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.780151 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:58:57.780252 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 08:58:57.781169 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.781656 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.781818 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 08:58:57.782714 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 08:58:57.783270 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef31a690>]}
2021-06-16 08:58:57.783746 (Thread-1): 08:58:57 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.06s]
2021-06-16 08:58:57.784035 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 08:58:57.784224 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 08:58:57.784585 (Thread-1): 08:58:57 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 08:58:57.785007 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.785156 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 08:58:57.787912 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:58:57.788265 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.790427 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.790569 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:58:57.790696 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:58:57.790791 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.801701 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.803829 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.803956 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 08:58:57.804985 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:58:57.805928 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.806053 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.806157 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.807017 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.807160 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.807269 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:58:57.808160 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.808323 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.808427 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.808524 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.809381 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.809506 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.809600 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:58:57.810444 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.812423 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.812552 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:58:57.813521 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:58:57.814431 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.814558 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.814663 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.815563 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.815713 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.815825 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:58:57.816761 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.817708 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 08:58:57.818067 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.818184 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 08:58:57.822445 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 08:58:57.825425 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.825556 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders" rename to "fact_orders__dbt_backup"
2021-06-16 08:58:57.826586 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.829389 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.829515 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 08:58:57.830558 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.831807 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.831946 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.832053 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.833775 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.834051 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.834169 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:58:57.835074 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.837084 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.837207 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 08:58:57.838617 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 08:58:57.839658 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.839785 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.839894 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 08:58:57.842720 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.842851 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:58:57.842976 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 08:58:57.843903 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.844375 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.844538 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 08:58:57.845427 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 08:58:57.845968 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef30da90>]}
2021-06-16 08:58:57.846399 (Thread-1): 08:58:57 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.06s]
2021-06-16 08:58:57.846674 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 08:58:57.846859 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 08:58:57.847144 (Thread-1): 08:58:57 | 6 of 7 SKIP relation sifa_core.dim_customers......................... [SKIP]
2021-06-16 08:58:57.847389 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 08:58:57.847565 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:58:57.847883 (Thread-1): 08:58:57 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 08:58:57.848292 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.848441 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:58:57.851672 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:58:57.852007 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.854419 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.854550 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:58:57.854662 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 08:58:57.854756 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.866191 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.868207 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.868369 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 08:58:57.869398 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.870311 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.870436 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.870539 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.871417 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.871552 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.871651 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:58:57.872544 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.872710 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.872811 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.872905 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.873782 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.873925 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.874024 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:58:57.874894 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.878516 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.878638 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:58:57.879630 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.880502 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.880633 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.880737 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.881678 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.881809 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.881915 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:58:57.882833 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.883474 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 08:58:57.883824 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.883943 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 08:58:57.885859 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 08:58:57.888675 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.888807 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 08:58:57.889907 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 08:58:57.891181 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.891315 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.891420 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.893125 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.893382 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.893497 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:58:57.894378 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.896430 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.896576 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 08:58:57.897553 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 08:58:57.898428 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.898551 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.898660 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 08:58:57.899578 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.899714 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:58:57.899813 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 08:58:57.900687 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 08:58:57.901182 (Thread-1): finished collecting timing info
2021-06-16 08:58:57.901345 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 08:58:57.902234 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 08:58:57.902778 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84e9f99-1f3b-40f9-9cf8-828f9478da2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef2ce7d0>]}
2021-06-16 08:58:57.903252 (Thread-1): 08:58:57 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.05s]
2021-06-16 08:58:57.903534 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 08:58:57.969203 (MainThread): Acquiring new redshift connection "master".
2021-06-16 08:58:57.969446 (MainThread): Using redshift connection "master".
2021-06-16 08:58:57.969554 (MainThread): On master: BEGIN
2021-06-16 08:58:57.969660 (MainThread): Opening a new connection, currently in state closed
2021-06-16 08:58:57.969751 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 08:58:57.981148 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 08:58:57.981322 (MainThread): On master: COMMIT
2021-06-16 08:58:57.981441 (MainThread): Using redshift connection "master".
2021-06-16 08:58:57.981552 (MainThread): On master: COMMIT
2021-06-16 08:58:57.982442 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 08:58:57.982590 (MainThread): On master: Close
2021-06-16 08:58:57.983145 (MainThread): 08:58:57 | 
2021-06-16 08:58:57.983428 (MainThread): 08:58:57 | Finished running 4 view models, 3 table models in 0.84s.
2021-06-16 08:58:57.983703 (MainThread): Connection 'master' was properly closed.
2021-06-16 08:58:57.983814 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 08:58:57.983909 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 08:58:57.991845 (MainThread): 
2021-06-16 08:58:57.992094 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 08:58:57.992348 (MainThread): 
2021-06-16 08:58:57.992642 (MainThread): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 08:58:57.992867 (MainThread):   syntax error at or near ":"
2021-06-16 08:58:57.993127 (MainThread):   LINE 18:     , 08:58:57          as dbt_load_timestamp
2021-06-16 08:58:57.993383 (MainThread):                    ^
2021-06-16 08:58:57.993597 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 08:58:57.993838 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
2021-06-16 08:58:57.994124 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5eef1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5eeff2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ef338090>]}
2021-06-16 08:58:57.994380 (MainThread): Flushing usage events
2021-06-16 08:59:58.793714 (MainThread): Running with dbt=0.19.1
2021-06-16 08:59:59.031517 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 08:59:59.032003 (MainThread): Tracking: tracking
2021-06-16 08:59:59.037833 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff06104d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05e391810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05e391b10>]}
2021-06-16 08:59:59.067708 (MainThread): Partial parsing not enabled
2021-06-16 08:59:59.068896 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:59:59.108875 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:59:59.127492 (MainThread): Parsing macros/relations.sql
2021-06-16 08:59:59.128425 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:59:59.129726 (MainThread): Parsing macros/adapters.sql
2021-06-16 08:59:59.160149 (MainThread): Parsing macros/catalog.sql
2021-06-16 08:59:59.163562 (MainThread): Parsing macros/relations.sql
2021-06-16 08:59:59.165565 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 08:59:59.169202 (MainThread): Parsing macros/core.sql
2021-06-16 08:59:59.175452 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 08:59:59.240265 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 08:59:59.253911 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 08:59:59.255465 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 08:59:59.258041 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 08:59:59.261059 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 08:59:59.263583 (MainThread): Parsing macros/etc/query.sql
2021-06-16 08:59:59.265237 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 08:59:59.279225 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 08:59:59.300238 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 08:59:59.303081 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 08:59:59.312914 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 08:59:59.344649 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 08:59:59.389266 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 08:59:59.391950 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 08:59:59.420006 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 08:59:59.429998 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 08:59:59.437817 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 08:59:59.447350 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 08:59:59.451498 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 08:59:59.453916 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 08:59:59.456925 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 08:59:59.461098 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 08:59:59.464352 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 08:59:59.466286 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 08:59:59.467660 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 08:59:59.471382 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 08:59:59.476827 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 08:59:59.487480 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 08:59:59.490066 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 08:59:59.494018 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 08:59:59.509131 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 08:59:59.511040 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 08:59:59.513525 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 08:59:59.516537 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 08:59:59.518482 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 08:59:59.523131 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 08:59:59.525452 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 08:59:59.527187 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 08:59:59.530075 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 08:59:59.532265 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 08:59:59.536249 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 08:59:59.539647 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 08:59:59.542781 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 08:59:59.551353 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 08:59:59.586665 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 08:59:59.588336 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 08:59:59.590629 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 08:59:59.592687 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 08:59:59.598164 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 08:59:59.599882 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 08:59:59.608168 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 08:59:59.609711 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 08:59:59.611664 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 08:59:59.614819 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 08:59:59.617123 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 08:59:59.619689 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 08:59:59.623669 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 08:59:59.629113 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 08:59:59.635496 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 08:59:59.638639 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 08:59:59.642567 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 08:59:59.646648 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 08:59:59.656293 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 08:59:59.657891 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 08:59:59.659329 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 08:59:59.661188 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 08:59:59.663066 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 08:59:59.667433 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 08:59:59.669082 (MainThread): Parsing macros/sql/star.sql
2021-06-16 08:59:59.673646 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 08:59:59.678363 (MainThread): Parsing macros/sql/union.sql
2021-06-16 08:59:59.690721 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 08:59:59.700572 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 08:59:59.702640 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 08:59:59.704427 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 08:59:59.707852 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 08:59:59.713123 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 08:59:59.714576 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 08:59:59.715736 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 08:59:59.716838 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 08:59:59.726150 (MainThread): Partial parsing not enabled
2021-06-16 08:59:59.772354 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 08:59:59.787922 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 08:59:59.793776 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 08:59:59.802452 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:59:59.804356 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 08:59:59.807849 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:59:59.809767 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 08:59:59.814488 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:59:59.816462 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 08:59:59.821123 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 08:59:59.823317 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 08:59:59.826874 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:00:00.099232 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:00:00.119422 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05e2ef810>]}
2021-06-16 09:00:00.127922 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05e2c2a50>]}
2021-06-16 09:00:00.128291 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:00:00.129653 (MainThread): 
2021-06-16 09:00:00.130137 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:00:00.131662 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:00:00.147591 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:00:00.147741 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:00:00.147868 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 09:00:00.147969 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.165516 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 09:00:00.168518 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:00:00.169165 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:00:00.171571 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:00:00.171700 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:00:00.171812 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:00:00.171907 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.183263 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 09:00:00.183777 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:00:00.184377 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:00:00.187187 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:00:00.187320 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:00:00.187443 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:00:00.187540 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.199049 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 09:00:00.199664 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:00:00.202153 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:00:00.212301 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:00:00.212469 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 09:00:00.212581 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 09:00:00.212683 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.224104 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.224292 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:00:00.224406 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:00:00.227091 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:00:00.227943 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:00:00.228885 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 09:00:00.229542 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:00:00.232100 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:00:00.232228 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:00:00.232339 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:00:00.232445 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.243776 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.243924 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:00:00.244036 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:00:00.246658 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:00:00.247334 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:00:00.248252 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 09:00:00.248863 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:00:00.251254 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:00:00.251403 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:00:00.251517 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:00:00.251613 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.262612 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.262757 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:00:00.262868 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:00:00.265532 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 09:00:00.266210 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:00:00.267118 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:00:00.274229 (MainThread): Using redshift connection "master".
2021-06-16 09:00:00.274368 (MainThread): On master: BEGIN
2021-06-16 09:00:00.274486 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:00:00.274584 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.286000 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.286174 (MainThread): Using redshift connection "master".
2021-06-16 09:00:00.286289 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:00:00.437139 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 09:00:00.438276 (MainThread): On master: ROLLBACK
2021-06-16 09:00:00.439278 (MainThread): Using redshift connection "master".
2021-06-16 09:00:00.439421 (MainThread): On master: BEGIN
2021-06-16 09:00:00.441233 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.441381 (MainThread): On master: COMMIT
2021-06-16 09:00:00.441489 (MainThread): Using redshift connection "master".
2021-06-16 09:00:00.441588 (MainThread): On master: COMMIT
2021-06-16 09:00:00.442495 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.442639 (MainThread): On master: Close
2021-06-16 09:00:00.443242 (MainThread): 09:00:00 | Concurrency: 1 threads (target='dev')
2021-06-16 09:00:00.443626 (MainThread): 09:00:00 | 
2021-06-16 09:00:00.445377 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 09:00:00.445901 (Thread-1): 09:00:00 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 09:00:00.446257 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.446424 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 09:00:00.451201 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:00:00.451561 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.477774 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.477978 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:00:00.478116 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:00:00.478220 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.490011 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.496790 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.496940 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 09:00:00.498047 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.499152 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:00:00.499284 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.499403 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:00:00.500361 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.500505 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.500609 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:00:00.501505 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.501672 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:00:00.501777 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.501873 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:00:00.502773 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.502936 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.503046 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:00:00.503946 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.506257 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.506399 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 09:00:00.507419 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.508385 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:00:00.508512 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.508617 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:00:00.509548 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.509684 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.509785 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:00:00.510653 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.519120 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:00:00.519557 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:00:00.519679 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
    , CAST(09:00:00 as timestamp         as dbt_load_timestamp
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 09:00:00.520777 (Thread-1): Postgres error: syntax error at or near ":"
LINE 18:     , CAST(09:00:00 as timestamp         as dbt_load_timesta...
                      ^

2021-06-16 09:00:00.520900 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 09:00:00.521882 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.522059 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 09:00:00.522535 (Thread-1): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  syntax error at or near ":"
  LINE 18:     , CAST(09:00:00 as timestamp         as dbt_load_timesta...
                        ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ":"
LINE 18:     , CAST(09:00:00 as timestamp         as dbt_load_timesta...
                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
  syntax error at or near ":"
  LINE 18:     , CAST(09:00:00 as timestamp         as dbt_load_timesta...
                        ^
  compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 09:00:00.524548 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05df04590>]}
2021-06-16 09:00:00.524977 (Thread-1): 09:00:00 | 1 of 7 ERROR creating view model sifa_cleansing.cls_customers........ [ERROR in 0.08s]
2021-06-16 09:00:00.525280 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 09:00:00.525490 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:00:00.526052 (Thread-1): 09:00:00 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 09:00:00.526483 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.526638 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:00:00.530176 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 09:00:00.530506 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.550717 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.550921 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:00:00.551050 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:00:00.551150 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.562802 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.565205 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.565338 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 09:00:00.566400 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:00:00.567455 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.567591 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.567702 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.568658 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.568794 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.568896 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:00:00.569794 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.569966 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.570071 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.570167 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.571085 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.571218 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.571323 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:00:00.572222 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.574219 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.574349 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 09:00:00.575377 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:00:00.576285 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.576415 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.576525 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.577572 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.577712 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.577817 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:00:00.578748 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.597845 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 09:00:00.598288 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.598414 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 09:00:00.600163 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:00:00.608550 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.608694 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 09:00:00.609843 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.612676 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.612808 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 09:00:00.613846 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.624999 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.625159 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.625268 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.627024 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.631553 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.631694 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:00:00.632696 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.635113 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.635257 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 09:00:00.636905 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:00:00.637921 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.638061 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.638171 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:00:00.641015 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.641162 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:00:00.641264 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:00:00.642216 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.642808 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.643008 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 09:00:00.644000 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 09:00:00.644608 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05e057310>]}
2021-06-16 09:00:00.645086 (Thread-1): 09:00:00 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.12s]
2021-06-16 09:00:00.645402 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:00:00.645610 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 09:00:00.646093 (Thread-1): 09:00:00 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 09:00:00.646534 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.646699 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 09:00:00.650827 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 09:00:00.651257 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.653728 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.653866 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:00:00.653990 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:00:00.654092 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.665594 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.669868 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.670029 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 09:00:00.671117 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.672116 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.672244 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.672375 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.673304 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.673461 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.673567 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:00:00.674482 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.674666 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.674773 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.674872 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.675817 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.675951 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.676053 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:00:00.676978 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.679313 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.679445 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 09:00:00.680518 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.681545 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.681673 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.681780 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.682695 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.682832 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.682962 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:00:00.683883 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.684607 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 09:00:00.685008 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.685147 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 09:00:00.686983 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:00:00.690142 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.690272 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 09:00:00.691388 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.694209 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.694338 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 09:00:00.695443 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.696722 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.696849 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.696954 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.698801 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.699089 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.699209 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:00:00.700168 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.702212 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.702337 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 09:00:00.703674 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.704580 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.704716 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.704826 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:00:00.706399 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.706535 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:00:00.706635 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:00:00.707586 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.708127 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.708298 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 09:00:00.709230 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 09:00:00.709792 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05df96690>]}
2021-06-16 09:00:00.710247 (Thread-1): 09:00:00 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.06s]
2021-06-16 09:00:00.710545 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 09:00:00.710735 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 09:00:00.711126 (Thread-1): 09:00:00 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 09:00:00.711540 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.711689 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 09:00:00.714445 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 09:00:00.714816 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.717250 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.717390 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:00:00.717505 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:00:00.717604 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.729223 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.731518 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.731648 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 09:00:00.732695 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.733702 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.733832 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.733941 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.734875 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.735049 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.735151 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:00:00.736057 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.736224 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.736327 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.736421 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.737315 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.737444 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.737541 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:00:00.738454 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.740502 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.740638 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 09:00:00.741684 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.742587 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.742713 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.742819 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.743775 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.743914 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.744017 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:00:00.744967 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.745674 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 09:00:00.746054 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.746180 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 'dummy'
  ) ;

2021-06-16 09:00:00.747810 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:00:00.750795 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.750952 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 09:00:00.752109 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.755147 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.755293 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 09:00:00.756402 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.757735 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.757861 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.757973 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.759729 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.760036 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.760148 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:00:00.761192 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.765367 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.765533 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 09:00:00.767044 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.768051 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.768177 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.768282 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:00:00.769904 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.770045 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:00:00.770148 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:00:00.771094 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.771682 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.771853 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 09:00:00.772771 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 09:00:00.773353 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05e29e750>]}
2021-06-16 09:00:00.773827 (Thread-1): 09:00:00 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.06s]
2021-06-16 09:00:00.774126 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 09:00:00.774324 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 09:00:00.774694 (Thread-1): 09:00:00 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 09:00:00.775149 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.775310 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 09:00:00.778190 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 09:00:00.778541 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.780811 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.780949 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:00:00.781063 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:00:00.781159 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.792704 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.795092 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.795229 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 09:00:00.796351 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:00:00.797357 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.797483 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.797590 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.798503 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.798663 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.798774 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:00:00.799694 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.799873 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.799983 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.800091 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.800990 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.801119 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.801217 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:00:00.802130 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.804514 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.804658 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 09:00:00.805675 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:00:00.806658 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.806785 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.806912 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.807835 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.807971 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.808073 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:00:00.808976 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.809969 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 09:00:00.810354 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.810475 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 09:00:00.815519 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:00:00.818562 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.818687 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders" rename to "fact_orders__dbt_backup"
2021-06-16 09:00:00.819806 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.822552 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.822677 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 09:00:00.823752 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.825023 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.825154 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.825263 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.827265 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.827528 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.827640 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:00:00.828589 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.830592 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.830717 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 09:00:00.832184 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:00:00.833055 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.833180 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.833286 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:00:00.836200 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.836381 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:00:00.836497 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:00:00.837481 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.838034 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.838206 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 09:00:00.839143 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 09:00:00.839736 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05deb4d90>]}
2021-06-16 09:00:00.840210 (Thread-1): 09:00:00 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.06s]
2021-06-16 09:00:00.840509 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 09:00:00.840722 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 09:00:00.840993 (Thread-1): 09:00:00 | 6 of 7 SKIP relation sifa_core.dim_customers......................... [SKIP]
2021-06-16 09:00:00.841254 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 09:00:00.841433 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:00:00.841757 (Thread-1): 09:00:00 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 09:00:00.842175 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.842326 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:00:00.845733 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 09:00:00.846093 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.848500 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.848644 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:00:00.848759 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:00:00.848856 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.860356 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.862416 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.862542 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 09:00:00.863606 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.864621 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.864775 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.864885 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.865821 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.865974 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.866075 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:00:00.867001 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.867174 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.867289 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.867388 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.868311 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.868439 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.868536 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:00:00.869480 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.873222 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.873352 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 09:00:00.874437 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.875385 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.875520 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.875630 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.876559 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.876695 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.876798 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:00:00.877733 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.878368 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 09:00:00.878739 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.878905 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 09:00:00.880697 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:00:00.883591 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.883720 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 09:00:00.884777 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:00:00.886025 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.886151 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.886256 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.888071 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.888335 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.888448 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:00:00.889384 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.891426 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.891560 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 09:00:00.892579 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:00:00.893461 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.893586 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.893692 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:00:00.894581 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.894713 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:00:00.894814 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:00:00.895721 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:00:00.896231 (Thread-1): finished collecting timing info
2021-06-16 09:00:00.896402 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 09:00:00.897314 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 09:00:00.897863 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff60b9ce-6c60-4f99-9508-7f3ad82168da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05e057090>]}
2021-06-16 09:00:00.898320 (Thread-1): 09:00:00 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.06s]
2021-06-16 09:00:00.898605 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:00:00.952143 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:00:00.952394 (MainThread): Using redshift connection "master".
2021-06-16 09:00:00.952507 (MainThread): On master: BEGIN
2021-06-16 09:00:00.952624 (MainThread): Opening a new connection, currently in state closed
2021-06-16 09:00:00.952720 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:00:00.964509 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:00:00.964725 (MainThread): On master: COMMIT
2021-06-16 09:00:00.964843 (MainThread): Using redshift connection "master".
2021-06-16 09:00:00.964959 (MainThread): On master: COMMIT
2021-06-16 09:00:00.965887 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:00:00.966039 (MainThread): On master: Close
2021-06-16 09:00:00.966683 (MainThread): 09:00:00 | 
2021-06-16 09:00:00.967012 (MainThread): 09:00:00 | Finished running 4 view models, 3 table models in 0.84s.
2021-06-16 09:00:00.967259 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:00:00.967374 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 09:00:00.967481 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 09:00:00.975429 (MainThread): 
2021-06-16 09:00:00.975746 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 09:00:00.976010 (MainThread): 
2021-06-16 09:00:00.976322 (MainThread): Database Error in model cls_customers (models/northwind_cls/cls_customers.sql)
2021-06-16 09:00:00.976572 (MainThread):   syntax error at or near ":"
2021-06-16 09:00:00.976771 (MainThread):   LINE 18:     , CAST(09:00:00 as timestamp         as dbt_load_timesta...
2021-06-16 09:00:00.977005 (MainThread):                         ^
2021-06-16 09:00:00.977227 (MainThread):   compiled SQL at target/run/dbtintro_northwind/models/northwind_cls/cls_customers.sql
2021-06-16 09:00:00.977434 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
2021-06-16 09:00:00.977726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff061780590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05df43a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05df146d0>]}
2021-06-16 09:00:00.977998 (MainThread): Flushing usage events
2021-06-16 09:03:17.614417 (MainThread): Running with dbt=0.19.1
2021-06-16 09:03:17.861466 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 09:03:17.861939 (MainThread): Tracking: tracking
2021-06-16 09:03:17.867637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb2749d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb281810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb281b10>]}
2021-06-16 09:03:17.897553 (MainThread): Partial parsing not enabled
2021-06-16 09:03:17.898736 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:03:17.938514 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:03:17.957016 (MainThread): Parsing macros/relations.sql
2021-06-16 09:03:17.957976 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:03:17.959330 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:03:17.989474 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:03:17.992913 (MainThread): Parsing macros/relations.sql
2021-06-16 09:03:17.994977 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:03:17.998676 (MainThread): Parsing macros/core.sql
2021-06-16 09:03:18.005013 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 09:03:18.069992 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 09:03:18.083780 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 09:03:18.085307 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 09:03:18.087963 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 09:03:18.091042 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 09:03:18.093512 (MainThread): Parsing macros/etc/query.sql
2021-06-16 09:03:18.095204 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 09:03:18.109421 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 09:03:18.130680 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 09:03:18.133607 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 09:03:18.143490 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 09:03:18.175587 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 09:03:18.220572 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 09:03:18.223304 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 09:03:18.251327 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 09:03:18.261548 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 09:03:18.269434 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 09:03:18.278987 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 09:03:18.283195 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 09:03:18.285636 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 09:03:18.288558 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 09:03:18.292851 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 09:03:18.296211 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 09:03:18.298121 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 09:03:18.299510 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 09:03:18.303220 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 09:03:18.308635 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 09:03:18.319497 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 09:03:18.322123 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 09:03:18.326075 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 09:03:18.340690 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 09:03:18.342586 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 09:03:18.345097 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 09:03:18.347902 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 09:03:18.349780 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 09:03:18.354375 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 09:03:18.356624 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 09:03:18.358317 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 09:03:18.361094 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 09:03:18.363217 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 09:03:18.367021 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 09:03:18.370168 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 09:03:18.373268 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 09:03:18.381447 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 09:03:18.415462 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 09:03:18.417061 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 09:03:18.419262 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 09:03:18.421208 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 09:03:18.426533 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 09:03:18.428194 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 09:03:18.436204 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 09:03:18.437736 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 09:03:18.439632 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 09:03:18.442716 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 09:03:18.444919 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 09:03:18.447337 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 09:03:18.451137 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 09:03:18.456276 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 09:03:18.462433 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 09:03:18.465401 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 09:03:18.469296 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 09:03:18.473237 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 09:03:18.482724 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 09:03:18.484256 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 09:03:18.485679 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 09:03:18.487596 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 09:03:18.489410 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 09:03:18.493487 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 09:03:18.495066 (MainThread): Parsing macros/sql/star.sql
2021-06-16 09:03:18.499590 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 09:03:18.504024 (MainThread): Parsing macros/sql/union.sql
2021-06-16 09:03:18.516004 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 09:03:18.525839 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 09:03:18.528021 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 09:03:18.529724 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 09:03:18.532983 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 09:03:18.538111 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 09:03:18.539505 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 09:03:18.540541 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 09:03:18.541569 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 09:03:18.550842 (MainThread): Partial parsing not enabled
2021-06-16 09:03:18.597756 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:03:18.613288 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:03:18.619301 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:18.625112 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:03:18.627041 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:03:18.630575 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:03:18.632427 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:03:18.637377 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:03:18.639352 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:18.644090 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:03:18.646057 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:03:18.649832 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:03:18.914180 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:03:18.933838 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6392c672-090d-49f1-b422-eace91c4c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fac47e50>]}
2021-06-16 09:03:18.942410 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6392c672-090d-49f1-b422-eace91c4c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fafef590>]}
2021-06-16 09:03:18.942759 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:03:18.943987 (MainThread): 
2021-06-16 09:03:18.944502 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:03:18.945533 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:03:18.961092 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:03:18.961238 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:03:18.961350 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 09:03:18.961444 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:18.979646 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 09:03:18.982567 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:03:18.983254 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:03:18.985811 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:03:18.985938 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:03:18.986053 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:03:18.986148 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:18.998291 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 09:03:18.998873 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:03:19.001462 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:03:19.012226 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:03:19.012512 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:03:19.012638 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 09:03:19.012738 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:19.024227 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:03:19.024392 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:03:19.024507 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:03:19.027197 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 09:03:19.027982 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:03:19.028998 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:03:19.029623 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:03:19.032262 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:03:19.032394 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 09:03:19.032506 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:03:19.032602 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:19.043604 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:03:19.043776 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:03:19.043888 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:03:19.046362 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:03:19.047212 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:03:19.048175 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 09:03:19.048830 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:03:19.051399 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:03:19.051529 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:03:19.051649 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:03:19.051745 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:19.062851 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:03:19.063037 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:03:19.063157 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:03:19.065725 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:03:19.066441 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:03:19.067406 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 09:03:19.074502 (MainThread): Using redshift connection "master".
2021-06-16 09:03:19.074635 (MainThread): On master: BEGIN
2021-06-16 09:03:19.074750 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:03:19.074854 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:19.086723 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:03:19.086953 (MainThread): Using redshift connection "master".
2021-06-16 09:03:19.087085 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:03:19.237946 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 09:03:19.239168 (MainThread): On master: ROLLBACK
2021-06-16 09:03:19.240156 (MainThread): Using redshift connection "master".
2021-06-16 09:03:19.240285 (MainThread): On master: BEGIN
2021-06-16 09:03:19.242147 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.242290 (MainThread): On master: COMMIT
2021-06-16 09:03:19.242398 (MainThread): Using redshift connection "master".
2021-06-16 09:03:19.242496 (MainThread): On master: COMMIT
2021-06-16 09:03:19.243445 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.243606 (MainThread): On master: Close
2021-06-16 09:03:19.244157 (MainThread): 09:03:19 | Concurrency: 1 threads (target='dev')
2021-06-16 09:03:19.244489 (MainThread): 09:03:19 | 
2021-06-16 09:03:19.246197 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 09:03:19.246537 (Thread-1): 09:03:19 | 1 of 2 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 09:03:19.246915 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.247082 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 09:03:19.251635 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:03:19.252000 (Thread-1): finished collecting timing info
2021-06-16 09:03:19.278392 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.278596 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:03:19.278719 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:03:19.278820 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:19.290796 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:03:19.297723 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.297883 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 09:03:19.299066 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:03:19.300327 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.300456 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.300563 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.301503 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.301642 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.301745 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:03:19.302641 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.302806 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.302933 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.303037 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.303988 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.304166 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.304291 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:03:19.305231 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.307545 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.307676 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 09:03:19.308693 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:03:19.309596 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.309720 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.309824 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.310745 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.310893 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.311003 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:03:19.311918 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.318846 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:03:19.319286 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.319409 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))         as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
    , CURRENT_DATE        as dbt_load_timestamp
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 09:03:19.321789 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:03:19.330191 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.330334 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 09:03:19.331870 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:03:19.336366 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.336505 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 09:03:19.337613 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:03:19.349081 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.349286 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.349394 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.351115 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.353601 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.353729 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:03:19.354679 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.357041 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.357171 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 09:03:19.358598 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:03:19.359613 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.359742 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.359846 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:03:19.361331 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.361465 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:03:19.361566 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:03:19.362487 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.363050 (Thread-1): finished collecting timing info
2021-06-16 09:03:19.363220 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 09:03:19.364137 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 09:03:19.364698 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6392c672-090d-49f1-b422-eace91c4c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fad0a310>]}
2021-06-16 09:03:19.365159 (Thread-1): 09:03:19 | 1 of 2 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.12s]
2021-06-16 09:03:19.365467 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 09:03:19.365841 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 09:03:19.366104 (Thread-1): 09:03:19 | 2 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 09:03:19.366534 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.366685 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 09:03:19.370477 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 09:03:19.370829 (Thread-1): finished collecting timing info
2021-06-16 09:03:19.390807 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.391024 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:03:19.391148 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:03:19.391245 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:19.403038 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:03:19.405368 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.405494 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 09:03:19.406534 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:03:19.407534 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.407663 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.407768 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.408693 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.408836 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.408937 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:03:19.409830 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.409992 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.410095 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.410197 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.411088 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.411219 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.411317 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:03:19.412473 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.414427 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.414552 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 09:03:19.415613 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:03:19.416466 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.416590 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.416694 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.417603 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.417737 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.417848 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:03:19.418709 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.437430 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 09:03:19.437880 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.438000 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 09:03:19.440206 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 09:03:19.443486 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.443616 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 09:03:19.444714 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:03:19.447470 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.447599 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 09:03:19.448597 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:03:19.449865 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.450028 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.450142 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.452238 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.452521 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.452635 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:03:19.453625 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.455707 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.455830 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 09:03:19.457112 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:03:19.458060 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.458191 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.458295 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:03:19.461199 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.461334 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:03:19.461434 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:03:19.462338 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:03:19.462863 (Thread-1): finished collecting timing info
2021-06-16 09:03:19.463054 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 09:03:19.463976 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 09:03:19.464546 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6392c672-090d-49f1-b422-eace91c4c3d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fac36fd0>]}
2021-06-16 09:03:19.465005 (Thread-1): 09:03:19 | 2 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.10s]
2021-06-16 09:03:19.465296 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 09:03:19.550864 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:03:19.551143 (MainThread): Using redshift connection "master".
2021-06-16 09:03:19.551255 (MainThread): On master: BEGIN
2021-06-16 09:03:19.551363 (MainThread): Opening a new connection, currently in state closed
2021-06-16 09:03:19.551464 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:03:19.563196 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:03:19.563352 (MainThread): On master: COMMIT
2021-06-16 09:03:19.563469 (MainThread): Using redshift connection "master".
2021-06-16 09:03:19.563568 (MainThread): On master: COMMIT
2021-06-16 09:03:19.564638 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:03:19.564786 (MainThread): On master: Close
2021-06-16 09:03:19.565243 (MainThread): 09:03:19 | 
2021-06-16 09:03:19.565529 (MainThread): 09:03:19 | Finished running 1 view model, 1 table model in 0.62s.
2021-06-16 09:03:19.565829 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:03:19.565940 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 09:03:19.566034 (MainThread): Connection 'model.dbtintro_northwind.dim_customers' was properly closed.
2021-06-16 09:03:19.574869 (MainThread): 
2021-06-16 09:03:19.575180 (MainThread): Completed successfully
2021-06-16 09:03:19.575440 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 09:03:19.575812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb294650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb1bfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fadb1d10>]}
2021-06-16 09:03:19.576104 (MainThread): Flushing usage events
2021-06-16 09:04:13.767677 (MainThread): Running with dbt=0.19.1
2021-06-16 09:04:14.018842 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['tag:customer'], partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 09:04:14.019370 (MainThread): Tracking: tracking
2021-06-16 09:04:14.025335 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e608f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e674790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e614b10>]}
2021-06-16 09:04:14.056385 (MainThread): Partial parsing not enabled
2021-06-16 09:04:14.057644 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:04:14.097758 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:04:14.116673 (MainThread): Parsing macros/relations.sql
2021-06-16 09:04:14.117704 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:04:14.119084 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:04:14.149890 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:04:14.153344 (MainThread): Parsing macros/relations.sql
2021-06-16 09:04:14.155398 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:04:14.159118 (MainThread): Parsing macros/core.sql
2021-06-16 09:04:14.165536 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 09:04:14.231344 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 09:04:14.245114 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 09:04:14.246674 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 09:04:14.249386 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 09:04:14.252472 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 09:04:14.255051 (MainThread): Parsing macros/etc/query.sql
2021-06-16 09:04:14.256702 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 09:04:14.270919 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 09:04:14.292398 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 09:04:14.295379 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 09:04:14.305326 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 09:04:14.337470 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 09:04:14.382661 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 09:04:14.385492 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 09:04:14.414052 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 09:04:14.424291 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 09:04:14.431992 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 09:04:14.441701 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 09:04:14.446153 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 09:04:14.448670 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 09:04:14.451636 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 09:04:14.455818 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 09:04:14.459096 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 09:04:14.460983 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 09:04:14.462293 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 09:04:14.466021 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 09:04:14.471409 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 09:04:14.482188 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 09:04:14.484855 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 09:04:14.488897 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 09:04:14.503963 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 09:04:14.505957 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 09:04:14.508535 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 09:04:14.511477 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 09:04:14.513334 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 09:04:14.517913 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 09:04:14.520226 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 09:04:14.521879 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 09:04:14.524792 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 09:04:14.527032 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 09:04:14.530876 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 09:04:14.534210 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 09:04:14.537438 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 09:04:14.545692 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 09:04:14.581261 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 09:04:14.582985 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 09:04:14.585284 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 09:04:14.587367 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 09:04:14.592721 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 09:04:14.594446 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 09:04:14.602733 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 09:04:14.604366 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 09:04:14.606348 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 09:04:14.609515 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 09:04:14.611707 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 09:04:14.614159 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 09:04:14.618186 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 09:04:14.623677 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 09:04:14.630177 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 09:04:14.633283 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 09:04:14.637443 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 09:04:14.641416 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 09:04:14.651079 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 09:04:14.652604 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 09:04:14.654031 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 09:04:14.655973 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 09:04:14.657855 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 09:04:14.662000 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 09:04:14.663638 (MainThread): Parsing macros/sql/star.sql
2021-06-16 09:04:14.668275 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 09:04:14.672775 (MainThread): Parsing macros/sql/union.sql
2021-06-16 09:04:14.684891 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 09:04:14.694852 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 09:04:14.697132 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 09:04:14.698863 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 09:04:14.702126 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 09:04:14.707362 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 09:04:14.708792 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 09:04:14.709831 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 09:04:14.710849 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 09:04:14.720330 (MainThread): Partial parsing not enabled
2021-06-16 09:04:14.766765 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:14.782576 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:14.788747 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:14.794943 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:14.796880 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:14.800486 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:14.802347 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:14.807321 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:14.809300 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:14.814243 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:14.816282 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:14.820126 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:15.084578 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:04:15.105098 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f735e405-4eb7-4310-ae5c-30de998fe536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e3a6d90>]}
2021-06-16 09:04:15.113560 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f735e405-4eb7-4310-ae5c-30de998fe536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6dff01d0>]}
2021-06-16 09:04:15.113953 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:04:15.115185 (MainThread): 
2021-06-16 09:04:15.115681 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:04:15.116716 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:04:15.132652 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:04:15.132840 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:04:15.132955 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 09:04:15.133051 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.152224 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 09:04:15.155357 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:04:15.156075 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:04:15.158557 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:04:15.158686 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:04:15.158795 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:04:15.158915 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.170656 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.01 seconds
2021-06-16 09:04:15.171309 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:04:15.173834 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:04:15.184505 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:04:15.184804 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 09:04:15.184933 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 09:04:15.185033 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.196674 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:15.196872 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:04:15.197004 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:04:15.199700 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:04:15.200526 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:04:15.201654 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 09:04:15.202334 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:04:15.205013 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:04:15.205144 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:04:15.205254 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:04:15.205357 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.216587 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:15.216748 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:04:15.216862 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:04:15.219626 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 09:04:15.220394 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:04:15.221334 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:04:15.221960 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:04:15.224441 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:04:15.224573 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:04:15.224685 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:04:15.224785 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.236068 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:15.236242 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:04:15.236358 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:04:15.238998 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:04:15.239702 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:04:15.240603 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 09:04:15.247834 (MainThread): Using redshift connection "master".
2021-06-16 09:04:15.247984 (MainThread): On master: BEGIN
2021-06-16 09:04:15.248110 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:04:15.248204 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.259657 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:15.259846 (MainThread): Using redshift connection "master".
2021-06-16 09:04:15.259965 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:04:15.411174 (MainThread): SQL status: SELECT 7 in 0.15 seconds
2021-06-16 09:04:15.412295 (MainThread): On master: ROLLBACK
2021-06-16 09:04:15.413303 (MainThread): Using redshift connection "master".
2021-06-16 09:04:15.413425 (MainThread): On master: BEGIN
2021-06-16 09:04:15.415244 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.415381 (MainThread): On master: COMMIT
2021-06-16 09:04:15.415487 (MainThread): Using redshift connection "master".
2021-06-16 09:04:15.415582 (MainThread): On master: COMMIT
2021-06-16 09:04:15.416499 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.416639 (MainThread): On master: Close
2021-06-16 09:04:15.417182 (MainThread): 09:04:15 | Concurrency: 1 threads (target='dev')
2021-06-16 09:04:15.417472 (MainThread): 09:04:15 | 
2021-06-16 09:04:15.419174 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 09:04:15.419532 (Thread-1): 09:04:15 | 1 of 2 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 09:04:15.419872 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.420031 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 09:04:15.424503 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:04:15.424875 (Thread-1): finished collecting timing info
2021-06-16 09:04:15.450980 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.451178 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:15.451293 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:15.451388 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.462869 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:15.469662 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.469799 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 09:04:15.470857 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:15.471954 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.472084 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.472193 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.473138 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.473281 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.473394 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:15.474264 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.474434 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.474545 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.474654 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.475520 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.475651 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.475748 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:15.476618 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.478739 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.478862 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 09:04:15.479873 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:15.480828 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.480953 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.481057 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.481905 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.482039 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.482140 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:15.483018 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.489914 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:04:15.490309 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.490428 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))             as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
    , CURRENT_TIMESTAMP                               as dbt_load_timestamp
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 09:04:15.492668 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:04:15.501115 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.501276 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 09:04:15.502461 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:15.506873 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.507028 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 09:04:15.508175 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:15.519232 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.519426 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.519545 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.522798 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.525349 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.525483 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:15.526421 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.528856 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.528983 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 09:04:15.530355 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:15.531361 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.531492 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.531598 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:15.533194 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.533367 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:15.533484 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:15.534384 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.535024 (Thread-1): finished collecting timing info
2021-06-16 09:04:15.535198 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 09:04:15.536098 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 09:04:15.536688 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f735e405-4eb7-4310-ae5c-30de998fe536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e174410>]}
2021-06-16 09:04:15.537146 (Thread-1): 09:04:15 | 1 of 2 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.12s]
2021-06-16 09:04:15.537457 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 09:04:15.537855 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 09:04:15.538130 (Thread-1): 09:04:15 | 2 of 2 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 09:04:15.538560 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.538706 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 09:04:15.542758 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 09:04:15.543145 (Thread-1): finished collecting timing info
2021-06-16 09:04:15.563469 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.563637 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:15.563750 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:15.563844 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.575238 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:15.577593 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.577723 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 09:04:15.578764 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:15.579761 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.579901 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.580007 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.580896 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.581033 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.581132 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:15.582052 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.582217 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.582318 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.582412 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.583336 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.583472 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.583572 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:15.584461 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.586656 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.586782 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 09:04:15.587771 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:15.588711 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.588840 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.588947 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.589837 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.589982 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.590079 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:15.590955 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.610190 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 09:04:15.610675 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.610797 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 09:04:15.613177 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 09:04:15.616638 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.616767 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 09:04:15.617900 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:15.620743 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.620909 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 09:04:15.621942 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:15.623252 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.623394 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.623503 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.625134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.625420 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.625532 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:15.626431 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.628540 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.628666 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 09:04:15.629894 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:15.630769 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.630914 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.631027 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:15.633774 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.633918 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:15.634022 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:15.634928 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:15.635537 (Thread-1): finished collecting timing info
2021-06-16 09:04:15.635713 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 09:04:15.636645 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 09:04:15.637228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f735e405-4eb7-4310-ae5c-30de998fe536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e1f0090>]}
2021-06-16 09:04:15.637684 (Thread-1): 09:04:15 | 2 of 2 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.10s]
2021-06-16 09:04:15.637975 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 09:04:15.721762 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:04:15.722018 (MainThread): Using redshift connection "master".
2021-06-16 09:04:15.722129 (MainThread): On master: BEGIN
2021-06-16 09:04:15.722235 (MainThread): Opening a new connection, currently in state closed
2021-06-16 09:04:15.722326 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:15.734442 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:15.734682 (MainThread): On master: COMMIT
2021-06-16 09:04:15.734800 (MainThread): Using redshift connection "master".
2021-06-16 09:04:15.734941 (MainThread): On master: COMMIT
2021-06-16 09:04:15.735919 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:15.736107 (MainThread): On master: Close
2021-06-16 09:04:15.736692 (MainThread): 09:04:15 | 
2021-06-16 09:04:15.736979 (MainThread): 09:04:15 | Finished running 1 view model, 1 table model in 0.62s.
2021-06-16 09:04:15.737263 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:04:15.737375 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 09:04:15.737470 (MainThread): Connection 'model.dbtintro_northwind.dim_customers' was properly closed.
2021-06-16 09:04:15.746431 (MainThread): 
2021-06-16 09:04:15.746737 (MainThread): Completed successfully
2021-06-16 09:04:15.746990 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-16 09:04:15.747360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e236d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6dfe9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6e5480d0>]}
2021-06-16 09:04:15.747650 (MainThread): Flushing usage events
2021-06-16 09:04:21.032899 (MainThread): Running with dbt=0.19.1
2021-06-16 09:04:21.287212 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-16 09:04:21.287725 (MainThread): Tracking: tracking
2021-06-16 09:04:21.293479 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04369f1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04369f1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436a00b10>]}
2021-06-16 09:04:21.323261 (MainThread): Partial parsing not enabled
2021-06-16 09:04:21.324512 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:04:21.365371 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:04:21.384034 (MainThread): Parsing macros/relations.sql
2021-06-16 09:04:21.385012 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:04:21.386330 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:04:21.416487 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:04:21.419953 (MainThread): Parsing macros/relations.sql
2021-06-16 09:04:21.421897 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:04:21.425487 (MainThread): Parsing macros/core.sql
2021-06-16 09:04:21.431712 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 09:04:21.496641 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 09:04:21.510259 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 09:04:21.511780 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 09:04:21.514327 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 09:04:21.517452 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 09:04:21.519959 (MainThread): Parsing macros/etc/query.sql
2021-06-16 09:04:21.521563 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 09:04:21.535604 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 09:04:21.556808 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 09:04:21.559726 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 09:04:21.569615 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 09:04:21.601267 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 09:04:21.646647 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 09:04:21.649496 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 09:04:21.677784 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 09:04:21.688387 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 09:04:21.696297 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 09:04:21.705901 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 09:04:21.710177 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 09:04:21.712595 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 09:04:21.715617 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 09:04:21.719965 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 09:04:21.723237 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 09:04:21.725188 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 09:04:21.726531 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 09:04:21.730282 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 09:04:21.735744 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 09:04:21.746305 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 09:04:21.748936 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 09:04:21.753013 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 09:04:21.767896 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 09:04:21.769896 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 09:04:21.772360 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 09:04:21.775282 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 09:04:21.777135 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 09:04:21.781656 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 09:04:21.784163 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 09:04:21.785873 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 09:04:21.788728 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 09:04:21.790839 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 09:04:21.794655 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 09:04:21.798006 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 09:04:21.801204 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 09:04:21.809566 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 09:04:21.844657 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 09:04:21.846364 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 09:04:21.848662 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 09:04:21.850654 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 09:04:21.856160 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 09:04:21.857893 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 09:04:21.866013 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 09:04:21.867616 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 09:04:21.869509 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 09:04:21.872608 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 09:04:21.874754 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 09:04:21.877201 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 09:04:21.881167 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 09:04:21.886584 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 09:04:21.892783 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 09:04:21.895837 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 09:04:21.899813 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 09:04:21.903810 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 09:04:21.913304 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 09:04:21.914877 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 09:04:21.916369 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 09:04:21.918218 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 09:04:21.920142 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 09:04:21.924403 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 09:04:21.926050 (MainThread): Parsing macros/sql/star.sql
2021-06-16 09:04:21.930560 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 09:04:21.935084 (MainThread): Parsing macros/sql/union.sql
2021-06-16 09:04:21.947155 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 09:04:21.956811 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 09:04:21.958931 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 09:04:21.960624 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 09:04:21.963980 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 09:04:21.969151 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 09:04:21.970559 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 09:04:21.971699 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 09:04:21.972773 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 09:04:21.981927 (MainThread): Partial parsing not enabled
2021-06-16 09:04:22.028188 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.043615 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:22.049637 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.055628 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:22.057624 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:22.061294 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:22.063196 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:22.068022 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:22.069953 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:22.074735 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:22.076773 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:22.080638 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:04:22.345058 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:04:22.365080 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436722510>]}
2021-06-16 09:04:22.373616 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04364cf650>]}
2021-06-16 09:04:22.374068 (MainThread): Found 7 models, 6 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:04:22.375447 (MainThread): 
2021-06-16 09:04:22.375951 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:04:22.377454 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:04:22.393359 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:04:22.393545 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:04:22.393665 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 09:04:22.393765 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.431039 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.04 seconds
2021-06-16 09:04:22.434158 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:04:22.434877 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:04:22.437435 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:04:22.437583 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:04:22.437697 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:04:22.437805 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.460350 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 09:04:22.461031 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:04:22.461686 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres".
2021-06-16 09:04:22.464776 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres".
2021-06-16 09:04:22.464915 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-06-16 09:04:22.465032 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:04:22.465129 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.486258 (ThreadPoolExecutor-0_0): SQL status: SELECT 12 in 0.02 seconds
2021-06-16 09:04:22.486815 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-06-16 09:04:22.489385 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:04:22.499533 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:04:22.499669 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:04:22.499783 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 09:04:22.499879 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.527424 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2021-06-16 09:04:22.527630 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:04:22.527752 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:04:22.533171 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-06-16 09:04:22.533986 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:04:22.536459 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:04:22.537153 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:04:22.539724 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:04:22.539857 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 09:04:22.539971 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:04:22.540067 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.562394 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:04:22.562608 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:04:22.562720 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:04:22.565376 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:04:22.566215 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:04:22.567210 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 09:04:22.567881 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:04:22.570457 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:04:22.570584 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:04:22.570694 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:04:22.570787 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.584395 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:22.584588 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:04:22.584708 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:04:22.587309 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:04:22.588064 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:04:22.588980 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 09:04:22.596191 (MainThread): Using redshift connection "master".
2021-06-16 09:04:22.596331 (MainThread): On master: BEGIN
2021-06-16 09:04:22.596458 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:04:22.596553 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.618164 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:04:22.618379 (MainThread): Using redshift connection "master".
2021-06-16 09:04:22.618496 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:04:22.762368 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-06-16 09:04:22.763541 (MainThread): On master: ROLLBACK
2021-06-16 09:04:22.764614 (MainThread): Using redshift connection "master".
2021-06-16 09:04:22.764748 (MainThread): On master: BEGIN
2021-06-16 09:04:22.766590 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.766725 (MainThread): On master: COMMIT
2021-06-16 09:04:22.766832 (MainThread): Using redshift connection "master".
2021-06-16 09:04:22.766956 (MainThread): On master: COMMIT
2021-06-16 09:04:22.767888 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.768033 (MainThread): On master: Close
2021-06-16 09:04:22.768604 (MainThread): 09:04:22 | Concurrency: 1 threads (target='dev')
2021-06-16 09:04:22.768946 (MainThread): 09:04:22 | 
2021-06-16 09:04:22.772655 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 09:04:22.773179 (Thread-1): 09:04:22 | 1 of 7 START view model sifa_cleansing.cls_customers................. [RUN]
2021-06-16 09:04:22.773556 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.773715 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 09:04:22.777957 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:04:22.778324 (Thread-1): finished collecting timing info
2021-06-16 09:04:22.804119 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.804307 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:22.804429 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:22.804530 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.822256 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:04:22.828983 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.829124 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" cascade
2021-06-16 09:04:22.830173 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:22.831245 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.831386 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.831496 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.832397 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.832544 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.832648 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:22.833586 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.833761 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.833868 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.833970 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.834888 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.835050 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.835151 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:22.836087 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.838125 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.838252 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 09:04:22.839241 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:22.840138 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.840265 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.840370 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.841304 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.841443 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.841545 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:22.842461 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.850787 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:04:22.851203 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.851328 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */


  create view "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" as (
    


select
      m.index
    , CAST(m."CustomerID" as varchar(12))             as customer_id
    , CAST(m."CompanyName" as varchar(50))            as company_name
    , CAST(m."ContactName" as varchar(50))            as contact_person
    , CAST(m."ContactTitle" as varchar(50))           as contact_position
    , CAST(m."Address" as varchar(50))                as street
    , CAST(m."City" as varchar(50))                   as city
    , CAST(m."Country" as varchar(50))                as country
    , CAST(m."Phone" as varchar(50))                  as phone
    , CURRENT_TIMESTAMP                               as dbt_load_timestamp
from "postgres"."northwind"."customers" m
  ) ;

2021-06-16 09:04:22.853553 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:04:22.861733 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.861871 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers" rename to "cls_customers__dbt_backup"
2021-06-16 09:04:22.863099 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:22.865978 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.866115 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
alter table "postgres"."sifa_cleansing"."cls_customers__dbt_tmp" rename to "cls_customers"
2021-06-16 09:04:22.867242 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:22.878153 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.878300 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.878408 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.880208 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.882570 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.882695 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:22.883694 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.885838 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.885963 (Thread-1): On model.dbtintro_northwind.cls_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_customers"} */
drop view if exists "postgres"."sifa_cleansing"."cls_customers__dbt_backup" cascade
2021-06-16 09:04:22.887416 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:22.888377 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.888509 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.888619 (Thread-1): On model.dbtintro_northwind.cls_customers: COMMIT
2021-06-16 09:04:22.890266 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.890402 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:04:22.890504 (Thread-1): On model.dbtintro_northwind.cls_customers: BEGIN
2021-06-16 09:04:22.891972 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.892532 (Thread-1): finished collecting timing info
2021-06-16 09:04:22.892710 (Thread-1): On model.dbtintro_northwind.cls_customers: ROLLBACK
2021-06-16 09:04:22.894786 (Thread-1): On model.dbtintro_northwind.cls_customers: Close
2021-06-16 09:04:22.895350 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436591e50>]}
2021-06-16 09:04:22.895770 (Thread-1): 09:04:22 | 1 of 7 OK created view model sifa_cleansing.cls_customers............ [CREATE VIEW in 0.12s]
2021-06-16 09:04:22.896063 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 09:04:22.896265 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:04:22.896790 (Thread-1): 09:04:22 | 2 of 7 START table model sifa.my_first_dbt_model..................... [RUN]
2021-06-16 09:04:22.897221 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.897375 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:04:22.901059 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 09:04:22.901414 (Thread-1): finished collecting timing info
2021-06-16 09:04:22.921168 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.921379 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:04:22.921500 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:22.921601 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:22.934523 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:22.936989 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.937125 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_tmp" cascade
2021-06-16 09:04:22.938191 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:22.939217 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.939360 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.939470 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.940395 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.940542 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.940652 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:04:22.941533 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.941702 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.941806 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.941901 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.942798 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.942947 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.943052 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:04:22.943930 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.945883 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.946017 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 09:04:22.947003 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:22.947903 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.948034 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.948149 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.949081 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.949221 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.949326 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:04:22.950237 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.968899 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 09:04:22.969358 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.969491 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */


  create  table
    "postgres"."sifa"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-06-16 09:04:22.971227 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:04:22.974432 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.974561 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2021-06-16 09:04:22.975702 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:22.978642 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.978818 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
alter table "postgres"."sifa"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2021-06-16 09:04:22.979919 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:22.981243 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.981370 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.981474 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.983621 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:22.983896 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.984005 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:04:22.985012 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:22.988805 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.988946 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_first_dbt_model"} */
drop table if exists "postgres"."sifa"."my_first_dbt_model__dbt_backup" cascade
2021-06-16 09:04:22.991237 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:22.992110 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.992238 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.992358 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: COMMIT
2021-06-16 09:04:22.997645 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-06-16 09:04:22.997792 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:04:22.997901 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: BEGIN
2021-06-16 09:04:23.002273 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.002830 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.003032 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: ROLLBACK
2021-06-16 09:04:23.006663 (Thread-1): On model.dbtintro_northwind.my_first_dbt_model: Close
2021-06-16 09:04:23.007240 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04364f1310>]}
2021-06-16 09:04:23.007673 (Thread-1): 09:04:23 | 2 of 7 OK created table model sifa.my_first_dbt_model................ [SELECT 2 in 0.11s]
2021-06-16 09:04:23.007958 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:04:23.008152 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 09:04:23.008614 (Thread-1): 09:04:23 | 3 of 7 START view model sifa_cleansing.cls_order_details............. [RUN]
2021-06-16 09:04:23.009053 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.009224 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 09:04:23.013265 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 09:04:23.013614 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.015993 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.016133 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:04:23.016252 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:23.016352 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:23.028981 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:23.031344 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.031474 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" cascade
2021-06-16 09:04:23.032528 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.033517 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.033645 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.033750 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.034674 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.034807 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.034926 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:04:23.035857 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.036025 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.036130 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.036225 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.037279 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.037416 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.037517 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:04:23.038394 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.040376 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.040503 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 09:04:23.041504 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.042382 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.042509 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.042614 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.043499 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.043637 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.043736 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:04:23.044706 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.045396 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 09:04:23.045771 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.045893 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */


  create view "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" as (
    


select index
    , "OrderID" as order_id
    , "ProductID" as product_id
    , "UnitPrice" as unit_price
    , "Quantity" as quantity
from "postgres"."northwind"."order_details"
  ) ;

2021-06-16 09:04:23.047732 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:04:23.050755 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.050906 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details" rename to "cls_order_details__dbt_backup"
2021-06-16 09:04:23.052095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.055049 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.055193 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
alter table "postgres"."sifa_cleansing"."cls_order_details__dbt_tmp" rename to "cls_order_details"
2021-06-16 09:04:23.056256 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.057593 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.057720 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.057826 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.059559 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.059823 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.059933 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:04:23.060835 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.062848 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.063003 (Thread-1): On model.dbtintro_northwind.cls_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_order_details"} */
drop view if exists "postgres"."sifa_cleansing"."cls_order_details__dbt_backup" cascade
2021-06-16 09:04:23.064746 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.065740 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.065874 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.065993 (Thread-1): On model.dbtintro_northwind.cls_order_details: COMMIT
2021-06-16 09:04:23.069282 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.069437 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:04:23.069543 (Thread-1): On model.dbtintro_northwind.cls_order_details: BEGIN
2021-06-16 09:04:23.074213 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.074767 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.074962 (Thread-1): On model.dbtintro_northwind.cls_order_details: ROLLBACK
2021-06-16 09:04:23.078945 (Thread-1): On model.dbtintro_northwind.cls_order_details: Close
2021-06-16 09:04:23.079502 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043658cfd0>]}
2021-06-16 09:04:23.079917 (Thread-1): 09:04:23 | 3 of 7 OK created view model sifa_cleansing.cls_order_details........ [CREATE VIEW in 0.07s]
2021-06-16 09:04:23.080197 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 09:04:23.080387 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 09:04:23.080765 (Thread-1): 09:04:23 | 4 of 7 START view model sifa_cleansing.cls_orders.................... [RUN]
2021-06-16 09:04:23.081161 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.081311 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 09:04:23.084115 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 09:04:23.084474 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.086843 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.087015 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:04:23.087141 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:23.087239 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:23.103849 (Thread-1): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:04:23.106295 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.106439 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" cascade
2021-06-16 09:04:23.107607 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.108623 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.108754 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.108860 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.109784 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.109930 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.110034 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:04:23.111014 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.111183 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.111295 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.111391 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.112327 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.112459 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.112560 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:04:23.113489 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.117349 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.117491 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 09:04:23.118609 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.119542 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.119675 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.119782 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.120728 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.120863 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.120964 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:04:23.121938 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.122575 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 09:04:23.122971 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.123098 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */


  create view "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" as (
    


select 'dummy'
  ) ;

2021-06-16 09:04:23.124728 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:04:23.127766 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.127902 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders" rename to "cls_orders__dbt_backup"
2021-06-16 09:04:23.129000 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.131768 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.131901 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
alter table "postgres"."sifa_cleansing"."cls_orders__dbt_tmp" rename to "cls_orders"
2021-06-16 09:04:23.132996 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.134308 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.134438 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.134548 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.136322 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.136608 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.136719 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:04:23.137666 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.139771 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.139902 (Thread-1): On model.dbtintro_northwind.cls_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.cls_orders"} */
drop view if exists "postgres"."sifa_cleansing"."cls_orders__dbt_backup" cascade
2021-06-16 09:04:23.141170 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.142049 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.142177 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.142285 (Thread-1): On model.dbtintro_northwind.cls_orders: COMMIT
2021-06-16 09:04:23.143935 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.144080 (Thread-1): Using redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:04:23.144189 (Thread-1): On model.dbtintro_northwind.cls_orders: BEGIN
2021-06-16 09:04:23.145102 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.145637 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.145811 (Thread-1): On model.dbtintro_northwind.cls_orders: ROLLBACK
2021-06-16 09:04:23.146726 (Thread-1): On model.dbtintro_northwind.cls_orders: Close
2021-06-16 09:04:23.147307 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04367e1f50>]}
2021-06-16 09:04:23.147779 (Thread-1): 09:04:23 | 4 of 7 OK created view model sifa_cleansing.cls_orders............... [CREATE VIEW in 0.07s]
2021-06-16 09:04:23.148082 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 09:04:23.148276 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 09:04:23.148646 (Thread-1): 09:04:23 | 5 of 7 START table model sifa_core.fact_orders....................... [RUN]
2021-06-16 09:04:23.149059 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.149207 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 09:04:23.151919 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 09:04:23.152258 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.154491 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.154626 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:04:23.154751 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:23.154852 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:23.167112 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:23.169303 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.169442 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_tmp" cascade
2021-06-16 09:04:23.171111 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:23.172097 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.172238 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.172347 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.176099 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.176283 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.176413 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:04:23.181555 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:23.181744 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.181856 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.181964 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.186949 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.187111 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.187225 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:04:23.190561 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.192850 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.192982 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 09:04:23.197711 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:23.198822 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.198980 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.199092 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.202794 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.202953 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.203063 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:04:23.204482 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.205563 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 09:04:23.205952 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.206076 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */


  create  table
    "postgres"."sifa_core"."fact_orders__dbt_tmp"
    
    
  as (
    


select 'dummy'
  );
2021-06-16 09:04:23.210585 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:04:23.213796 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.213939 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders" rename to "fact_orders__dbt_backup"
2021-06-16 09:04:23.215051 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.217898 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.218033 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
alter table "postgres"."sifa_core"."fact_orders__dbt_tmp" rename to "fact_orders"
2021-06-16 09:04:23.219149 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.220454 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.220598 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.220706 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.222453 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.222729 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.222837 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:04:23.223846 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.225976 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.226103 (Thread-1): On model.dbtintro_northwind.fact_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.fact_orders"} */
drop table if exists "postgres"."sifa_core"."fact_orders__dbt_backup" cascade
2021-06-16 09:04:23.227710 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:23.228582 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.228710 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.228817 (Thread-1): On model.dbtintro_northwind.fact_orders: COMMIT
2021-06-16 09:04:23.231861 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.231999 (Thread-1): Using redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:04:23.232100 (Thread-1): On model.dbtintro_northwind.fact_orders: BEGIN
2021-06-16 09:04:23.233080 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.233699 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.233880 (Thread-1): On model.dbtintro_northwind.fact_orders: ROLLBACK
2021-06-16 09:04:23.234892 (Thread-1): On model.dbtintro_northwind.fact_orders: Close
2021-06-16 09:04:23.235556 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04366c8e50>]}
2021-06-16 09:04:23.236010 (Thread-1): 09:04:23 | 5 of 7 OK created table model sifa_core.fact_orders.................. [SELECT 1 in 0.09s]
2021-06-16 09:04:23.236320 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 09:04:23.236513 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 09:04:23.236868 (Thread-1): 09:04:23 | 6 of 7 START table model sifa_core.dim_customers..................... [RUN]
2021-06-16 09:04:23.237285 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.237434 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 09:04:23.242985 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 09:04:23.243349 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.245597 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.245731 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:23.245843 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:23.245947 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:23.257450 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:23.259607 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.259740 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_tmp" cascade
2021-06-16 09:04:23.260814 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:23.261789 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.261927 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.262046 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.263116 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.263264 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.263384 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:23.267577 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.267749 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.267855 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.267951 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.272352 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.272490 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.272596 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:23.276107 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.278422 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.278554 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 09:04:23.279729 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:23.280741 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.280876 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.280988 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.285450 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.285597 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.285701 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:23.288999 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.290084 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 09:04:23.290473 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.290595 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */


  create  table
    "postgres"."sifa_core"."dim_customers__dbt_tmp"
    
    
  as (
    


select *
from "postgres"."sifa_cleansing"."cls_customers"
  );
2021-06-16 09:04:23.293069 (Thread-1): SQL status: SELECT 91 in 0.00 seconds
2021-06-16 09:04:23.296410 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.296543 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers" rename to "dim_customers__dbt_backup"
2021-06-16 09:04:23.299073 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.302009 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.302137 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
alter table "postgres"."sifa_core"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-06-16 09:04:23.304532 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.305826 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.305963 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.306082 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.307984 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.308252 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.308377 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:23.309335 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.311468 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.311600 (Thread-1): On model.dbtintro_northwind.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.dim_customers"} */
drop table if exists "postgres"."sifa_core"."dim_customers__dbt_backup" cascade
2021-06-16 09:04:23.312925 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-06-16 09:04:23.313821 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.313962 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.314074 (Thread-1): On model.dbtintro_northwind.dim_customers: COMMIT
2021-06-16 09:04:23.316871 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.317013 (Thread-1): Using redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:04:23.317117 (Thread-1): On model.dbtintro_northwind.dim_customers: BEGIN
2021-06-16 09:04:23.318206 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.318716 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.318918 (Thread-1): On model.dbtintro_northwind.dim_customers: ROLLBACK
2021-06-16 09:04:23.319875 (Thread-1): On model.dbtintro_northwind.dim_customers: Close
2021-06-16 09:04:23.320446 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436612d90>]}
2021-06-16 09:04:23.320898 (Thread-1): 09:04:23 | 6 of 7 OK created table model sifa_core.dim_customers................ [SELECT 91 in 0.08s]
2021-06-16 09:04:23.321193 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 09:04:23.321382 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:04:23.321778 (Thread-1): 09:04:23 | 7 of 7 START view model sifa.my_second_dbt_model..................... [RUN]
2021-06-16 09:04:23.322198 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.322346 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:04:23.325578 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 09:04:23.325931 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.328252 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.328400 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:04:23.328522 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:04:23.328629 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:23.342206 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:23.344536 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.344676 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_tmp" cascade
2021-06-16 09:04:23.345772 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.346753 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.346900 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.347029 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.347960 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.348099 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.348201 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:04:23.349086 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.349270 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.349376 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.349485 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.350376 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.350509 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.350608 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:04:23.351595 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.353582 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.353709 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 09:04:23.354705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.355617 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.355750 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.355858 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.356851 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.356991 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.357100 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:04:23.358053 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.358764 (Thread-1): Writing runtime SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 09:04:23.359167 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.359298 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */


  create view "postgres"."sifa"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."sifa"."my_first_dbt_model"
where id = 1
  ) ;

2021-06-16 09:04:23.361089 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-06-16 09:04:23.365815 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.365962 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
alter table "postgres"."sifa"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2021-06-16 09:04:23.367097 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-06-16 09:04:23.368424 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.368574 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.368685 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.370323 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.370584 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.370696 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:04:23.371652 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.373769 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.373904 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "model.dbtintro_northwind.my_second_dbt_model"} */
drop view if exists "postgres"."sifa"."my_second_dbt_model__dbt_backup" cascade
2021-06-16 09:04:23.374971 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-06-16 09:04:23.375936 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.376064 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.376169 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: COMMIT
2021-06-16 09:04:23.377089 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.377224 (Thread-1): Using redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:04:23.377323 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: BEGIN
2021-06-16 09:04:23.378192 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-06-16 09:04:23.378736 (Thread-1): finished collecting timing info
2021-06-16 09:04:23.378935 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: ROLLBACK
2021-06-16 09:04:23.379894 (Thread-1): On model.dbtintro_northwind.my_second_dbt_model: Close
2021-06-16 09:04:23.380459 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a713691c-e3bb-4229-a0e4-822b01d58b37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043652f690>]}
2021-06-16 09:04:23.380916 (Thread-1): 09:04:23 | 7 of 7 OK created view model sifa.my_second_dbt_model................ [CREATE VIEW in 0.06s]
2021-06-16 09:04:23.381204 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:04:23.480361 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:04:23.480622 (MainThread): Using redshift connection "master".
2021-06-16 09:04:23.480738 (MainThread): On master: BEGIN
2021-06-16 09:04:23.480850 (MainThread): Opening a new connection, currently in state closed
2021-06-16 09:04:23.480945 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:04:23.493164 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:04:23.493368 (MainThread): On master: COMMIT
2021-06-16 09:04:23.493490 (MainThread): Using redshift connection "master".
2021-06-16 09:04:23.493599 (MainThread): On master: COMMIT
2021-06-16 09:04:23.494567 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-06-16 09:04:23.494756 (MainThread): On master: Close
2021-06-16 09:04:23.495367 (MainThread): 09:04:23 | 
2021-06-16 09:04:23.495671 (MainThread): 09:04:23 | Finished running 4 view models, 3 table models in 1.12s.
2021-06-16 09:04:23.495926 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:04:23.496046 (MainThread): Connection 'list_postgres' was properly closed.
2021-06-16 09:04:23.496144 (MainThread): Connection 'model.dbtintro_northwind.my_second_dbt_model' was properly closed.
2021-06-16 09:04:23.504085 (MainThread): 
2021-06-16 09:04:23.504339 (MainThread): Completed successfully
2021-06-16 09:04:23.504580 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-06-16 09:04:23.504910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436548550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044c28f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436555290>]}
2021-06-16 09:04:23.505231 (MainThread): Flushing usage events
2021-06-16 09:09:58.748867 (MainThread): Running with dbt=0.19.1
2021-06-16 09:09:58.987942 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-16 09:09:58.988446 (MainThread): Tracking: tracking
2021-06-16 09:09:58.994090 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9598106e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9598114750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9598114a50>]}
2021-06-16 09:09:59.023706 (MainThread): Partial parsing not enabled
2021-06-16 09:09:59.024905 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:09:59.064714 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:09:59.083389 (MainThread): Parsing macros/relations.sql
2021-06-16 09:09:59.084368 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:09:59.085723 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:09:59.116176 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:09:59.119661 (MainThread): Parsing macros/relations.sql
2021-06-16 09:09:59.121580 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:09:59.125316 (MainThread): Parsing macros/core.sql
2021-06-16 09:09:59.131573 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 09:09:59.196518 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 09:09:59.210064 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 09:09:59.211534 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 09:09:59.214065 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 09:09:59.217169 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 09:09:59.219720 (MainThread): Parsing macros/etc/query.sql
2021-06-16 09:09:59.221308 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 09:09:59.235217 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 09:09:59.256407 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 09:09:59.259258 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 09:09:59.269005 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 09:09:59.300658 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 09:09:59.346346 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 09:09:59.349229 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 09:09:59.377559 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 09:09:59.388078 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 09:09:59.396188 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 09:09:59.405695 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 09:09:59.409973 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 09:09:59.412407 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 09:09:59.415430 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 09:09:59.419748 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 09:09:59.423164 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 09:09:59.425046 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 09:09:59.426367 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 09:09:59.430195 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 09:09:59.435503 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 09:09:59.446066 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 09:09:59.448672 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 09:09:59.452643 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 09:09:59.467399 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 09:09:59.469246 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 09:09:59.471779 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 09:09:59.474593 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 09:09:59.476467 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 09:09:59.481122 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 09:09:59.483438 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 09:09:59.485087 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 09:09:59.487924 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 09:09:59.490036 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 09:09:59.493941 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 09:09:59.497288 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 09:09:59.500516 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 09:09:59.508795 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 09:09:59.543722 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 09:09:59.545307 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 09:09:59.547666 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 09:09:59.549638 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 09:09:59.555012 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 09:09:59.556723 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 09:09:59.564930 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 09:09:59.566493 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 09:09:59.568504 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 09:09:59.571606 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 09:09:59.573764 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 09:09:59.576291 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 09:09:59.580323 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 09:09:59.585546 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 09:09:59.591912 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 09:09:59.594975 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 09:09:59.599032 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 09:09:59.603050 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 09:09:59.612583 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 09:09:59.614100 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 09:09:59.615552 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 09:09:59.617467 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 09:09:59.619419 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 09:09:59.623659 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 09:09:59.625278 (MainThread): Parsing macros/sql/star.sql
2021-06-16 09:09:59.629884 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 09:09:59.634645 (MainThread): Parsing macros/sql/union.sql
2021-06-16 09:09:59.646938 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 09:09:59.656770 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 09:09:59.658980 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 09:09:59.660718 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 09:09:59.664080 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 09:09:59.669352 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 09:09:59.670745 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 09:09:59.671844 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 09:09:59.672883 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 09:09:59.682222 (MainThread): Partial parsing not enabled
2021-06-16 09:09:59.728771 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:09:59.744527 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:09:59.750527 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:09:59.756422 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:09:59.758295 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:09:59.761749 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:09:59.763678 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:09:59.768462 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:09:59.770372 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:09:59.775148 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:09:59.777128 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:09:59.780938 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:09:59.793361 (MainThread): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:10:00.059024 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:10:00.077847 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1321e484-40d3-49c6-8c73-819ac41fb272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9597c80b90>]}
2021-06-16 09:10:00.086515 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1321e484-40d3-49c6-8c73-819ac41fb272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9597e11350>]}
2021-06-16 09:10:00.086864 (MainThread): Found 7 models, 7 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:10:00.088465 (MainThread): 
2021-06-16 09:10:00.088962 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:10:00.091117 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:10:00.107952 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:10:00.108143 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:10:00.108261 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 09:10:00.108362 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.126776 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:10:00.126989 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:10:00.127106 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:10:00.129820 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 09:10:00.132982 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:10:00.133927 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:10:00.134602 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:10:00.137229 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:10:00.137355 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:10:00.137467 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:10:00.137562 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.148993 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.149155 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:10:00.149268 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:10:00.151986 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:10:00.152660 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:10:00.153585 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 09:10:00.154223 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:10:00.156659 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:10:00.156786 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 09:10:00.156904 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:10:00.156997 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.168201 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.168352 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:10:00.168462 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:10:00.171140 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:10:00.171837 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:10:00.172791 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 09:10:00.180206 (MainThread): Using redshift connection "master".
2021-06-16 09:10:00.180360 (MainThread): On master: BEGIN
2021-06-16 09:10:00.180477 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:10:00.180583 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.192266 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.192433 (MainThread): Using redshift connection "master".
2021-06-16 09:10:00.192552 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:10:00.336700 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-06-16 09:10:00.337779 (MainThread): On master: ROLLBACK
2021-06-16 09:10:00.338768 (MainThread): On master: Close
2021-06-16 09:10:00.339346 (MainThread): 09:10:00 | Concurrency: 1 threads (target='dev')
2021-06-16 09:10:00.339630 (MainThread): 09:10:00 | 
2021-06-16 09:10:00.341593 (Thread-1): Began running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:10:00.341796 (Thread-1): 09:10:00 | 1 of 7 START test assert_orderamount................................. [RUN]
2021-06-16 09:10:00.342119 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:10:00.342269 (Thread-1): Compiling test.dbtintro_northwind.assert_orderamount
2021-06-16 09:10:00.355861 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.assert_orderamount"
2021-06-16 09:10:00.356238 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.356448 (Thread-1): Using redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:10:00.356564 (Thread-1): On test.dbtintro_northwind.assert_orderamount: BEGIN
2021-06-16 09:10:00.356683 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:10:00.356775 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.368192 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.368345 (Thread-1): Using redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:10:00.368454 (Thread-1): On test.dbtintro_northwind.assert_orderamount: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.assert_orderamount"} */

with dbt__CTE__INTERNAL_test as (
-- ASSERTION: Check order quantity in range

select *
from "postgres"."sifa_cleansing"."cls_order_details"
where quantity > 1
  and unit_price > 0



-- Command: dbt test --data
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-16 09:10:00.371267 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:10:00.371583 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.371746 (Thread-1): On test.dbtintro_northwind.assert_orderamount: ROLLBACK
2021-06-16 09:10:00.372670 (Thread-1): On test.dbtintro_northwind.assert_orderamount: Close
2021-06-16 09:10:00.373192 (Thread-1): 09:10:00 | 1 of 7 FAIL 8345 assert_orderamount.................................. [FAIL 8345 in 0.03s]
2021-06-16 09:10:00.373507 (Thread-1): Finished running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:10:00.373750 (Thread-1): Began running node test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 09:10:00.374013 (Thread-1): 09:10:00 | 2 of 7 START test not_null_cls_customers_CustomerID.................. [RUN]
2021-06-16 09:10:00.374439 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_cls_customers_CustomerID".
2021-06-16 09:10:00.374587 (Thread-1): Compiling test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 09:10:00.384349 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_cls_customers_CustomerID"
2021-06-16 09:10:00.384747 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.384957 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_cls_customers_CustomerID".
2021-06-16 09:10:00.385071 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: BEGIN
2021-06-16 09:10:00.385176 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:10:00.385311 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.397349 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.397537 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_cls_customers_CustomerID".
2021-06-16 09:10:00.397661 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_cls_customers_CustomerID"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa_cleansing"."cls_customers"
where CustomerID is null



2021-06-16 09:10:00.398863 (Thread-1): Postgres error: column "customerid" does not exist
LINE 10: where CustomerID is null
               ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".

2021-06-16 09:10:00.399033 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: ROLLBACK
2021-06-16 09:10:00.399983 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.400160 (Thread-1): On test.dbtintro_northwind.not_null_cls_customers_CustomerID: Close
2021-06-16 09:10:00.400642 (Thread-1): Database Error in test not_null_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 10: where CustomerID is null
                 ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/not_null_cls_customers_CustomerID.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "customerid" does not exist
LINE 10: where CustomerID is null
               ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 65, in execute_schema_test
    fetch=True,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test not_null_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 10: where CustomerID is null
                 ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/not_null_cls_customers_CustomerID.sql
2021-06-16 09:10:00.402002 (Thread-1): 09:10:00 | 2 of 7 ERROR not_null_cls_customers_CustomerID....................... [ERROR in 0.03s]
2021-06-16 09:10:00.402295 (Thread-1): Finished running node test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 09:10:00.402487 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 09:10:00.402798 (Thread-1): 09:10:00 | 3 of 7 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-06-16 09:10:00.403251 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 09:10:00.403401 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 09:10:00.408375 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_first_dbt_model_id"
2021-06-16 09:10:00.408722 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.408913 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 09:10:00.409027 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: BEGIN
2021-06-16 09:10:00.409131 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:10:00.409223 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.422700 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.422891 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 09:10:00.423045 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa"."my_first_dbt_model"
where id is null



2021-06-16 09:10:00.424327 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:10:00.424645 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.424820 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: ROLLBACK
2021-06-16 09:10:00.425729 (Thread-1): On test.dbtintro_northwind.not_null_my_first_dbt_model_id: Close
2021-06-16 09:10:00.426282 (Thread-1): 09:10:00 | 3 of 7 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 0.02s]
2021-06-16 09:10:00.426581 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 09:10:00.426831 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 09:10:00.427126 (Thread-1): 09:10:00 | 4 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-06-16 09:10:00.427547 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 09:10:00.427693 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 09:10:00.432802 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_second_dbt_model_id"
2021-06-16 09:10:00.433189 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.433380 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 09:10:00.433493 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: BEGIN
2021-06-16 09:10:00.433611 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:10:00.433718 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.446010 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.446177 (Thread-1): Using redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 09:10:00.446286 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from "postgres"."sifa"."my_second_dbt_model"
where id is null



2021-06-16 09:10:00.447670 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:10:00.447974 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.448137 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: ROLLBACK
2021-06-16 09:10:00.449058 (Thread-1): On test.dbtintro_northwind.not_null_my_second_dbt_model_id: Close
2021-06-16 09:10:00.449565 (Thread-1): 09:10:00 | 4 of 7 PASS not_null_my_second_dbt_model_id.......................... [PASS in 0.02s]
2021-06-16 09:10:00.449865 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 09:10:00.450097 (Thread-1): Began running node test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 09:10:00.450346 (Thread-1): 09:10:00 | 5 of 7 START test unique_cls_customers_CustomerID.................... [RUN]
2021-06-16 09:10:00.450746 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_cls_customers_CustomerID".
2021-06-16 09:10:00.450916 (Thread-1): Compiling test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 09:10:00.460678 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_cls_customers_CustomerID"
2021-06-16 09:10:00.461045 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.461249 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_cls_customers_CustomerID".
2021-06-16 09:10:00.461363 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: BEGIN
2021-06-16 09:10:00.461467 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:10:00.461559 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.474196 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.474372 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_cls_customers_CustomerID".
2021-06-16 09:10:00.474486 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_cls_customers_CustomerID"} */

    
    



select count(*) as validation_errors
from (

    select
        CustomerID

    from "postgres"."sifa_cleansing"."cls_customers"
    where CustomerID is not null
    group by CustomerID
    having count(*) > 1

) validation_errors



2021-06-16 09:10:00.475715 (Thread-1): Postgres error: column "customerid" does not exist
LINE 12:         CustomerID
                 ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".

2021-06-16 09:10:00.475848 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: ROLLBACK
2021-06-16 09:10:00.476762 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.476925 (Thread-1): On test.dbtintro_northwind.unique_cls_customers_CustomerID: Close
2021-06-16 09:10:00.477395 (Thread-1): Database Error in test unique_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 12:         CustomerID
                   ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/unique_cls_customers_CustomerID.sql
Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "customerid" does not exist
LINE 12:         CustomerID
                 ^
HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/task/test.py", line 65, in execute_schema_test
    fetch=True,
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib64/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/ec2-user/.local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test unique_cls_customers_CustomerID (models/northwind_cls/schema.yml)
  column "customerid" does not exist
  LINE 12:         CustomerID
                   ^
  HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
  compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/unique_cls_customers_CustomerID.sql
2021-06-16 09:10:00.477918 (Thread-1): 09:10:00 | 5 of 7 ERROR unique_cls_customers_CustomerID......................... [ERROR in 0.03s]
2021-06-16 09:10:00.478196 (Thread-1): Finished running node test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 09:10:00.478381 (Thread-1): Began running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 09:10:00.478746 (Thread-1): 09:10:00 | 6 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-06-16 09:10:00.479174 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 09:10:00.479320 (Thread-1): Compiling test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 09:10:00.485583 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_first_dbt_model_id"
2021-06-16 09:10:00.485943 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.486124 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 09:10:00.486235 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: BEGIN
2021-06-16 09:10:00.486338 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:10:00.486460 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.497843 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.497995 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 09:10:00.498106 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from "postgres"."sifa"."my_first_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors



2021-06-16 09:10:00.499666 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:10:00.499974 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.500134 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: ROLLBACK
2021-06-16 09:10:00.501073 (Thread-1): On test.dbtintro_northwind.unique_my_first_dbt_model_id: Close
2021-06-16 09:10:00.501587 (Thread-1): 09:10:00 | 6 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 0.02s]
2021-06-16 09:10:00.501888 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 09:10:00.502114 (Thread-1): Began running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 09:10:00.502361 (Thread-1): 09:10:00 | 7 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-06-16 09:10:00.502807 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 09:10:00.502985 (Thread-1): Compiling test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 09:10:00.507953 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_second_dbt_model_id"
2021-06-16 09:10:00.508327 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.508519 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 09:10:00.508635 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: BEGIN
2021-06-16 09:10:00.508741 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:10:00.508832 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:00.520257 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:00.520429 (Thread-1): Using redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 09:10:00.520541 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from "postgres"."sifa"."my_second_dbt_model"
    where id is not null
    group by id
    having count(*) > 1

) validation_errors



2021-06-16 09:10:00.522071 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:10:00.522367 (Thread-1): finished collecting timing info
2021-06-16 09:10:00.522536 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: ROLLBACK
2021-06-16 09:10:00.523475 (Thread-1): On test.dbtintro_northwind.unique_my_second_dbt_model_id: Close
2021-06-16 09:10:00.524003 (Thread-1): 09:10:00 | 7 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 0.02s]
2021-06-16 09:10:00.524327 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 09:10:00.542155 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:10:00.542592 (MainThread): 09:10:00 | 
2021-06-16 09:10:00.542883 (MainThread): 09:10:00 | Finished running 7 tests in 0.45s.
2021-06-16 09:10:00.543150 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:10:00.543265 (MainThread): Connection 'test.dbtintro_northwind.unique_my_second_dbt_model_id' was properly closed.
2021-06-16 09:10:00.551349 (MainThread): 
2021-06-16 09:10:00.551647 (MainThread): Completed with 4 errors and 0 warnings:
2021-06-16 09:10:00.551896 (MainThread): 
2021-06-16 09:10:00.552130 (MainThread): Failure in test assert_orderamount (tests/assert_orderamount.sql)
2021-06-16 09:10:00.552441 (MainThread):   Got 8345 results, expected 0.
2021-06-16 09:10:00.552667 (MainThread): 
2021-06-16 09:10:00.552924 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/tests/assert_orderamount.sql
2021-06-16 09:10:00.553154 (MainThread): 
2021-06-16 09:10:00.553356 (MainThread): Database Error in test not_null_cls_customers_CustomerID (models/northwind_cls/schema.yml)
2021-06-16 09:10:00.553554 (MainThread):   column "customerid" does not exist
2021-06-16 09:10:00.553740 (MainThread):   LINE 10: where CustomerID is null
2021-06-16 09:10:00.553915 (MainThread):                  ^
2021-06-16 09:10:00.554082 (MainThread):   HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
2021-06-16 09:10:00.554264 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/not_null_cls_customers_CustomerID.sql
2021-06-16 09:10:00.554451 (MainThread): 
2021-06-16 09:10:00.554639 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/example/schema.yml)
2021-06-16 09:10:00.554827 (MainThread):   Got 1 result, expected 0.
2021-06-16 09:10:00.555050 (MainThread): 
2021-06-16 09:10:00.555239 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/models/example/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-06-16 09:10:00.555429 (MainThread): 
2021-06-16 09:10:00.555615 (MainThread): Database Error in test unique_cls_customers_CustomerID (models/northwind_cls/schema.yml)
2021-06-16 09:10:00.555792 (MainThread):   column "customerid" does not exist
2021-06-16 09:10:00.555953 (MainThread):   LINE 12:         CustomerID
2021-06-16 09:10:00.556121 (MainThread):                    ^
2021-06-16 09:10:00.556293 (MainThread):   HINT:  Perhaps you meant to reference the column "cls_customers.customer_id".
2021-06-16 09:10:00.556456 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/models/northwind_cls/schema.yml/schema_test/unique_cls_customers_CustomerID.sql
2021-06-16 09:10:00.556648 (MainThread): 
Done. PASS=3 WARN=0 ERROR=4 SKIP=0 TOTAL=7
2021-06-16 09:10:00.556923 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9597fd7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9597fb6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9597ec4550>]}
2021-06-16 09:10:00.557173 (MainThread): Flushing usage events
2021-06-16 09:10:38.475314 (MainThread): Running with dbt=0.19.1
2021-06-16 09:10:38.716651 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-06-16 09:10:38.717157 (MainThread): Tracking: tracking
2021-06-16 09:10:38.722782 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc09fc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbde16310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbddbcf90>]}
2021-06-16 09:10:38.752905 (MainThread): Partial parsing not enabled
2021-06-16 09:10:38.754115 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:10:38.793721 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:10:38.812139 (MainThread): Parsing macros/relations.sql
2021-06-16 09:10:38.813097 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:10:38.814481 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:10:38.844409 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:10:38.847824 (MainThread): Parsing macros/relations.sql
2021-06-16 09:10:38.849823 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:10:38.853481 (MainThread): Parsing macros/core.sql
2021-06-16 09:10:38.859750 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 09:10:38.923696 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 09:10:38.937173 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 09:10:38.938618 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 09:10:38.941184 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 09:10:38.944224 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 09:10:38.946719 (MainThread): Parsing macros/etc/query.sql
2021-06-16 09:10:38.948334 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 09:10:38.961925 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 09:10:38.982685 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 09:10:38.985463 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 09:10:38.995046 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 09:10:39.026244 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 09:10:39.071057 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 09:10:39.073777 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 09:10:39.101748 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 09:10:39.111893 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 09:10:39.119695 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 09:10:39.129169 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 09:10:39.133339 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 09:10:39.135741 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 09:10:39.138678 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 09:10:39.142853 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 09:10:39.146104 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 09:10:39.148075 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 09:10:39.149429 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 09:10:39.153142 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 09:10:39.158549 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 09:10:39.169164 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 09:10:39.171709 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 09:10:39.175727 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 09:10:39.190465 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 09:10:39.192334 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 09:10:39.194797 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 09:10:39.197726 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 09:10:39.199589 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 09:10:39.204091 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 09:10:39.206416 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 09:10:39.208163 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 09:10:39.210934 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 09:10:39.213080 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 09:10:39.216970 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 09:10:39.220252 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 09:10:39.223354 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 09:10:39.231587 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 09:10:39.266427 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 09:10:39.268118 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 09:10:39.270309 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 09:10:39.272297 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 09:10:39.277572 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 09:10:39.279242 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 09:10:39.287259 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 09:10:39.288760 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 09:10:39.290624 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 09:10:39.293678 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 09:10:39.295923 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 09:10:39.298415 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 09:10:39.302213 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 09:10:39.307444 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 09:10:39.313560 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 09:10:39.316656 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 09:10:39.320544 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 09:10:39.324501 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 09:10:39.333861 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 09:10:39.335437 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 09:10:39.336829 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 09:10:39.338700 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 09:10:39.340536 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 09:10:39.344813 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 09:10:39.346390 (MainThread): Parsing macros/sql/star.sql
2021-06-16 09:10:39.350823 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 09:10:39.355373 (MainThread): Parsing macros/sql/union.sql
2021-06-16 09:10:39.367106 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 09:10:39.376677 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 09:10:39.378788 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 09:10:39.380504 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 09:10:39.383878 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 09:10:39.389022 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 09:10:39.390397 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 09:10:39.391477 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 09:10:39.392503 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 09:10:39.401503 (MainThread): Partial parsing not enabled
2021-06-16 09:10:39.447269 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:10:39.462540 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:10:39.468419 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:10:39.474164 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:10:39.476105 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:10:39.479677 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:10:39.481507 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:10:39.486153 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:10:39.488094 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:10:39.492713 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:10:39.494679 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:10:39.498535 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:10:39.510992 (MainThread): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:10:39.770954 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:10:39.789211 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35726c81-645f-47bb-9704-29d92cc27579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbdb57c90>]}
2021-06-16 09:10:39.797651 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35726c81-645f-47bb-9704-29d92cc27579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbd954510>]}
2021-06-16 09:10:39.797990 (MainThread): Found 7 models, 7 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:10:39.799524 (MainThread): 
2021-06-16 09:10:39.800014 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:10:39.801861 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:10:39.818286 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:10:39.818440 (ThreadPoolExecutor-0_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:10:39.818555 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-16 09:10:39.818651 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:39.836572 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:10:39.836737 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:10:39.836847 (ThreadPoolExecutor-0_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:10:39.839543 (ThreadPoolExecutor-0_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:10:39.842535 (ThreadPoolExecutor-0_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:10:39.843510 (ThreadPoolExecutor-0_0): On list_postgres_sifa_core: Close
2021-06-16 09:10:39.844163 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:10:39.846666 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:10:39.846787 (ThreadPoolExecutor-0_0): On list_postgres_sifa: BEGIN
2021-06-16 09:10:39.846921 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:10:39.847023 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:39.857980 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:39.858130 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:10:39.858244 (ThreadPoolExecutor-0_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:10:39.860849 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:10:39.861555 (ThreadPoolExecutor-0_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:10:39.862709 (ThreadPoolExecutor-0_0): On list_postgres_sifa: Close
2021-06-16 09:10:39.863331 (ThreadPoolExecutor-0_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:10:39.865780 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:10:39.865899 (ThreadPoolExecutor-0_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:10:39.866002 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-16 09:10:39.866091 (ThreadPoolExecutor-0_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:39.877235 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:39.877374 (ThreadPoolExecutor-0_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:10:39.877479 (ThreadPoolExecutor-0_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:10:39.880067 (ThreadPoolExecutor-0_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 09:10:39.880725 (ThreadPoolExecutor-0_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:10:39.881667 (ThreadPoolExecutor-0_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:10:39.888630 (MainThread): Using redshift connection "master".
2021-06-16 09:10:39.888759 (MainThread): On master: BEGIN
2021-06-16 09:10:39.888866 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:10:39.888967 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:10:39.900485 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:10:39.900670 (MainThread): Using redshift connection "master".
2021-06-16 09:10:39.900780 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:10:40.078330 (MainThread): SQL status: SELECT 7 in 0.18 seconds
2021-06-16 09:10:40.079533 (MainThread): On master: ROLLBACK
2021-06-16 09:10:40.080532 (MainThread): On master: Close
2021-06-16 09:10:40.081116 (MainThread): 09:10:40 | Concurrency: 1 threads (target='dev')
2021-06-16 09:10:40.081409 (MainThread): 09:10:40 | 
2021-06-16 09:10:40.083387 (Thread-1): Began running node model.dbtintro_northwind.cls_customers
2021-06-16 09:10:40.083793 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:10:40.083955 (Thread-1): Compiling model.dbtintro_northwind.cls_customers
2021-06-16 09:10:40.088269 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_customers"
2021-06-16 09:10:40.088627 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.088805 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.089176 (Thread-1): Finished running node model.dbtintro_northwind.cls_customers
2021-06-16 09:10:40.089354 (Thread-1): Began running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:10:40.089940 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:10:40.090085 (Thread-1): Compiling model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:10:40.093191 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_first_dbt_model"
2021-06-16 09:10:40.093495 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.093662 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.094029 (Thread-1): Finished running node model.dbtintro_northwind.my_first_dbt_model
2021-06-16 09:10:40.094210 (Thread-1): Began running node model.dbtintro_northwind.cls_order_details
2021-06-16 09:10:40.094726 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:10:40.094867 (Thread-1): Compiling model.dbtintro_northwind.cls_order_details
2021-06-16 09:10:40.098637 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_order_details"
2021-06-16 09:10:40.098965 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.099141 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.099520 (Thread-1): Finished running node model.dbtintro_northwind.cls_order_details
2021-06-16 09:10:40.099704 (Thread-1): Began running node model.dbtintro_northwind.cls_orders
2021-06-16 09:10:40.100191 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:10:40.100334 (Thread-1): Compiling model.dbtintro_northwind.cls_orders
2021-06-16 09:10:40.102812 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.cls_orders"
2021-06-16 09:10:40.103136 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.103300 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.103666 (Thread-1): Finished running node model.dbtintro_northwind.cls_orders
2021-06-16 09:10:40.103841 (Thread-1): Began running node model.dbtintro_northwind.fact_orders
2021-06-16 09:10:40.104229 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:10:40.104367 (Thread-1): Compiling model.dbtintro_northwind.fact_orders
2021-06-16 09:10:40.106814 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.fact_orders"
2021-06-16 09:10:40.107156 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.107373 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.107751 (Thread-1): Finished running node model.dbtintro_northwind.fact_orders
2021-06-16 09:10:40.107941 (Thread-1): Began running node model.dbtintro_northwind.dim_customers
2021-06-16 09:10:40.108330 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:10:40.108469 (Thread-1): Compiling model.dbtintro_northwind.dim_customers
2021-06-16 09:10:40.111874 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.dim_customers"
2021-06-16 09:10:40.112167 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.112331 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.112675 (Thread-1): Finished running node model.dbtintro_northwind.dim_customers
2021-06-16 09:10:40.112873 (Thread-1): Began running node test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 09:10:40.113274 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_cls_customers_CustomerID".
2021-06-16 09:10:40.113411 (Thread-1): Compiling test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 09:10:40.124460 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_cls_customers_CustomerID"
2021-06-16 09:10:40.124853 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.125042 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.125431 (Thread-1): Finished running node test.dbtintro_northwind.not_null_cls_customers_CustomerID
2021-06-16 09:10:40.125661 (Thread-1): Began running node test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 09:10:40.126089 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_cls_customers_CustomerID".
2021-06-16 09:10:40.126235 (Thread-1): Compiling test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 09:10:40.136023 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_cls_customers_CustomerID"
2021-06-16 09:10:40.136401 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.136586 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.136999 (Thread-1): Finished running node test.dbtintro_northwind.unique_cls_customers_CustomerID
2021-06-16 09:10:40.137192 (Thread-1): Began running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:10:40.137619 (Thread-1): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:10:40.137774 (Thread-1): Compiling model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:10:40.141019 (Thread-1): Writing injected SQL for node "model.dbtintro_northwind.my_second_dbt_model"
2021-06-16 09:10:40.141345 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.141510 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.141852 (Thread-1): Finished running node model.dbtintro_northwind.my_second_dbt_model
2021-06-16 09:10:40.142055 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 09:10:40.142590 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_first_dbt_model_id".
2021-06-16 09:10:40.142730 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 09:10:40.147329 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_first_dbt_model_id"
2021-06-16 09:10:40.147656 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.147846 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.148210 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_first_dbt_model_id
2021-06-16 09:10:40.148387 (Thread-1): Began running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 09:10:40.148779 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_first_dbt_model_id".
2021-06-16 09:10:40.148917 (Thread-1): Compiling test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 09:10:40.153312 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_first_dbt_model_id"
2021-06-16 09:10:40.153641 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.153815 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.154192 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_first_dbt_model_id
2021-06-16 09:10:40.154379 (Thread-1): Began running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:10:40.154779 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:10:40.154946 (Thread-1): Compiling test.dbtintro_northwind.assert_orderamount
2021-06-16 09:10:40.168221 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.assert_orderamount"
2021-06-16 09:10:40.168576 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.168748 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.169163 (Thread-1): Finished running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:10:40.169347 (Thread-1): Began running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 09:10:40.169753 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.not_null_my_second_dbt_model_id".
2021-06-16 09:10:40.169893 (Thread-1): Compiling test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 09:10:40.174421 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.not_null_my_second_dbt_model_id"
2021-06-16 09:10:40.174737 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.174948 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.175290 (Thread-1): Finished running node test.dbtintro_northwind.not_null_my_second_dbt_model_id
2021-06-16 09:10:40.175518 (Thread-1): Began running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 09:10:40.175919 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.unique_my_second_dbt_model_id".
2021-06-16 09:10:40.176061 (Thread-1): Compiling test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 09:10:40.180535 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.unique_my_second_dbt_model_id"
2021-06-16 09:10:40.180827 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.180993 (Thread-1): finished collecting timing info
2021-06-16 09:10:40.181357 (Thread-1): Finished running node test.dbtintro_northwind.unique_my_second_dbt_model_id
2021-06-16 09:10:40.183413 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:10:40.183588 (MainThread): Connection 'test.dbtintro_northwind.unique_my_second_dbt_model_id' was properly closed.
2021-06-16 09:10:40.192648 (MainThread): 09:10:40 | Done.
2021-06-16 09:10:40.193003 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbdb35d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbda788d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbda78e90>]}
2021-06-16 09:10:40.193272 (MainThread): Flushing usage events
2021-06-16 09:11:24.823579 (MainThread): Running with dbt=0.19.1
2021-06-16 09:11:25.067812 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-16 09:11:25.068298 (MainThread): Tracking: tracking
2021-06-16 09:11:25.073894 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa0619ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa0619f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa0627a10>]}
2021-06-16 09:11:25.104264 (MainThread): Partial parsing not enabled
2021-06-16 09:11:25.105484 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:11:25.145333 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:11:25.164012 (MainThread): Parsing macros/relations.sql
2021-06-16 09:11:25.164964 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:11:25.166333 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:11:25.196613 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:11:25.200127 (MainThread): Parsing macros/relations.sql
2021-06-16 09:11:25.202063 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:11:25.205733 (MainThread): Parsing macros/core.sql
2021-06-16 09:11:25.211966 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 09:11:25.277031 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 09:11:25.290484 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 09:11:25.291924 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 09:11:25.294498 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 09:11:25.297585 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 09:11:25.300059 (MainThread): Parsing macros/etc/query.sql
2021-06-16 09:11:25.301715 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 09:11:25.315652 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 09:11:25.336636 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 09:11:25.339460 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 09:11:25.349139 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 09:11:25.380729 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 09:11:25.425453 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 09:11:25.428152 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 09:11:25.456028 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 09:11:25.465996 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 09:11:25.473660 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 09:11:25.483203 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 09:11:25.487326 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 09:11:25.489768 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 09:11:25.492733 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 09:11:25.496933 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 09:11:25.500166 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 09:11:25.502026 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 09:11:25.503386 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 09:11:25.507356 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 09:11:25.512652 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 09:11:25.523304 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 09:11:25.525882 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 09:11:25.529926 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 09:11:25.544611 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 09:11:25.546517 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 09:11:25.549016 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 09:11:25.551867 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 09:11:25.553741 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 09:11:25.558442 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 09:11:25.560821 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 09:11:25.562472 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 09:11:25.565269 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 09:11:25.567495 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 09:11:25.571267 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 09:11:25.574452 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 09:11:25.577646 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 09:11:25.585877 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 09:11:25.620816 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 09:11:25.622380 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 09:11:25.624659 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 09:11:25.626679 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 09:11:25.632061 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 09:11:25.633729 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 09:11:25.641833 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 09:11:25.643405 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 09:11:25.645344 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 09:11:25.648611 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 09:11:25.650765 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 09:11:25.653186 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 09:11:25.657224 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 09:11:25.662477 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 09:11:25.668817 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 09:11:25.671823 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 09:11:25.675842 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 09:11:25.679845 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 09:11:25.689359 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 09:11:25.690866 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 09:11:25.692282 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 09:11:25.694173 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 09:11:25.696086 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 09:11:25.700313 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 09:11:25.701886 (MainThread): Parsing macros/sql/star.sql
2021-06-16 09:11:25.706446 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 09:11:25.711008 (MainThread): Parsing macros/sql/union.sql
2021-06-16 09:11:25.722950 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 09:11:25.732687 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 09:11:25.734789 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 09:11:25.736584 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 09:11:25.739895 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 09:11:25.744996 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 09:11:25.746415 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 09:11:25.747551 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 09:11:25.748609 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 09:11:25.757988 (MainThread): Partial parsing not enabled
2021-06-16 09:11:25.804100 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:11:25.819450 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:11:25.825279 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:11:25.831044 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:11:25.832917 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:11:25.836513 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:11:25.838414 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:11:25.843361 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:11:25.845386 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:11:25.850077 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:11:25.851996 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:11:25.855787 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:11:25.868203 (MainThread): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:11:26.131251 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:11:26.150050 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99b71e93-3a15-417e-adaa-46274ae69803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa0379cd0>]}
2021-06-16 09:11:26.158683 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99b71e93-3a15-417e-adaa-46274ae69803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa06cab90>]}
2021-06-16 09:11:26.159058 (MainThread): Found 7 models, 7 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:11:26.160554 (MainThread): 
2021-06-16 09:11:26.161032 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:11:26.163155 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:11:26.179913 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:11:26.180091 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:11:26.180214 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 09:11:26.180310 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:11:26.199360 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:11:26.199600 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:11:26.199716 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:11:26.202386 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 09:11:26.205673 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:11:26.206641 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:11:26.207355 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:11:26.209986 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:11:26.210109 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 09:11:26.210219 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:11:26.210312 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:11:26.221975 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:11:26.222158 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:11:26.222273 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:11:26.224988 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:11:26.225790 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:11:26.226761 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 09:11:26.227450 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:11:26.229995 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:11:26.230120 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:11:26.230230 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:11:26.230325 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:11:26.241529 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:11:26.241754 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:11:26.241870 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:11:26.244556 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:11:26.245358 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:11:26.246318 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 09:11:26.253735 (MainThread): Using redshift connection "master".
2021-06-16 09:11:26.253899 (MainThread): On master: BEGIN
2021-06-16 09:11:26.254017 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:11:26.254113 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:11:26.265526 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:11:26.265741 (MainThread): Using redshift connection "master".
2021-06-16 09:11:26.265853 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:11:26.410119 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-06-16 09:11:26.411244 (MainThread): On master: ROLLBACK
2021-06-16 09:11:26.412186 (MainThread): On master: Close
2021-06-16 09:11:26.412748 (MainThread): 09:11:26 | Concurrency: 1 threads (target='dev')
2021-06-16 09:11:26.413035 (MainThread): 09:11:26 | 
2021-06-16 09:11:26.414853 (Thread-1): Began running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:11:26.415083 (Thread-1): 09:11:26 | 1 of 1 START test assert_orderamount................................. [RUN]
2021-06-16 09:11:26.415428 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:11:26.415580 (Thread-1): Compiling test.dbtintro_northwind.assert_orderamount
2021-06-16 09:11:26.429249 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.assert_orderamount"
2021-06-16 09:11:26.429666 (Thread-1): finished collecting timing info
2021-06-16 09:11:26.429877 (Thread-1): Using redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:11:26.430001 (Thread-1): On test.dbtintro_northwind.assert_orderamount: BEGIN
2021-06-16 09:11:26.430112 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:11:26.430256 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:11:26.441521 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:11:26.441698 (Thread-1): Using redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:11:26.441817 (Thread-1): On test.dbtintro_northwind.assert_orderamount: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.assert_orderamount"} */

with dbt__CTE__INTERNAL_test as (
-- ASSERTION: Check order quantity in range

select *
from "postgres"."sifa_cleansing"."cls_order_details"
where quantity > 1
  and unit_price > 0



-- Command: dbt test --data
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-16 09:11:26.444464 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:11:26.444822 (Thread-1): finished collecting timing info
2021-06-16 09:11:26.445002 (Thread-1): On test.dbtintro_northwind.assert_orderamount: ROLLBACK
2021-06-16 09:11:26.445947 (Thread-1): On test.dbtintro_northwind.assert_orderamount: Close
2021-06-16 09:11:26.446503 (Thread-1): 09:11:26 | 1 of 1 FAIL 8345 assert_orderamount.................................. [FAIL 8345 in 0.03s]
2021-06-16 09:11:26.446848 (Thread-1): Finished running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:11:26.515418 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:11:26.515869 (MainThread): 09:11:26 | 
2021-06-16 09:11:26.516152 (MainThread): 09:11:26 | Finished running 1 test in 0.36s.
2021-06-16 09:11:26.516378 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:11:26.516490 (MainThread): Connection 'test.dbtintro_northwind.assert_orderamount' was properly closed.
2021-06-16 09:11:26.524165 (MainThread): 
2021-06-16 09:11:26.524439 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 09:11:26.524696 (MainThread): 
2021-06-16 09:11:26.524973 (MainThread): Failure in test assert_orderamount (tests/assert_orderamount.sql)
2021-06-16 09:11:26.525256 (MainThread):   Got 8345 results, expected 0.
2021-06-16 09:11:26.525527 (MainThread): 
2021-06-16 09:11:26.525753 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/tests/assert_orderamount.sql
2021-06-16 09:11:26.526000 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-16 09:11:26.526323 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa0357190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa017f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa01e1490>]}
2021-06-16 09:11:26.526592 (MainThread): Flushing usage events
2021-06-16 09:12:08.126681 (MainThread): Running with dbt=0.19.1
2021-06-16 09:12:08.370874 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=True, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/ec2-user/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-16 09:12:08.371378 (MainThread): Tracking: tracking
2021-06-16 09:12:08.377148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f05cf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ed98b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ed98ba50>]}
2021-06-16 09:12:08.406920 (MainThread): Partial parsing not enabled
2021-06-16 09:12:08.408093 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:12:08.447464 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:12:08.466055 (MainThread): Parsing macros/relations.sql
2021-06-16 09:12:08.467025 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:12:08.468346 (MainThread): Parsing macros/adapters.sql
2021-06-16 09:12:08.498752 (MainThread): Parsing macros/catalog.sql
2021-06-16 09:12:08.502392 (MainThread): Parsing macros/relations.sql
2021-06-16 09:12:08.504399 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-06-16 09:12:08.508008 (MainThread): Parsing macros/core.sql
2021-06-16 09:12:08.514155 (MainThread): Parsing macros/adapters/common.sql
2021-06-16 09:12:08.579175 (MainThread): Parsing macros/etc/datetime.sql
2021-06-16 09:12:08.592829 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-16 09:12:08.594277 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-16 09:12:08.596848 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-16 09:12:08.599900 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-16 09:12:08.602387 (MainThread): Parsing macros/etc/query.sql
2021-06-16 09:12:08.604065 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-16 09:12:08.618185 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-16 09:12:08.639559 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-16 09:12:08.642450 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-16 09:12:08.652404 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-16 09:12:08.684635 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-16 09:12:08.729938 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-16 09:12:08.732704 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-16 09:12:08.761074 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-16 09:12:08.771427 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-16 09:12:08.779409 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-16 09:12:08.789285 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-16 09:12:08.793504 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-16 09:12:08.796025 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-16 09:12:08.799024 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-16 09:12:08.803290 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-06-16 09:12:08.806580 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-06-16 09:12:08.808492 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-06-16 09:12:08.809828 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-06-16 09:12:08.813625 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-06-16 09:12:08.818971 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-06-16 09:12:08.829409 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-06-16 09:12:08.831979 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-06-16 09:12:08.836003 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-06-16 09:12:08.850915 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-06-16 09:12:08.852766 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-06-16 09:12:08.855257 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-06-16 09:12:08.858053 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-06-16 09:12:08.859919 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-06-16 09:12:08.864452 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-06-16 09:12:08.866796 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-06-16 09:12:08.868475 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-06-16 09:12:08.871289 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-06-16 09:12:08.873455 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-06-16 09:12:08.877281 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-06-16 09:12:08.880652 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-06-16 09:12:08.883864 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-06-16 09:12:08.892107 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-06-16 09:12:08.926982 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-06-16 09:12:08.928565 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-06-16 09:12:08.930743 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-06-16 09:12:08.932705 (MainThread): Parsing macros/schema_tests/equality.sql
2021-06-16 09:12:08.937944 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-06-16 09:12:08.939600 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-06-16 09:12:08.947659 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-06-16 09:12:08.949198 (MainThread): Parsing macros/schema_tests/recency.sql
2021-06-16 09:12:08.951144 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-06-16 09:12:08.954252 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-06-16 09:12:08.956473 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-06-16 09:12:08.958858 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-06-16 09:12:08.962807 (MainThread): Parsing macros/sql/generate_series.sql
2021-06-16 09:12:08.968153 (MainThread): Parsing macros/sql/get_column_values.sql
2021-06-16 09:12:08.974317 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-06-16 09:12:08.977322 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-06-16 09:12:08.981251 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-06-16 09:12:08.985246 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-06-16 09:12:08.994654 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-06-16 09:12:08.996230 (MainThread): Parsing macros/sql/groupby.sql
2021-06-16 09:12:08.997631 (MainThread): Parsing macros/sql/nullcheck.sql
2021-06-16 09:12:08.999514 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-06-16 09:12:09.001365 (MainThread): Parsing macros/sql/pivot.sql
2021-06-16 09:12:09.005540 (MainThread): Parsing macros/sql/safe_add.sql
2021-06-16 09:12:09.007117 (MainThread): Parsing macros/sql/star.sql
2021-06-16 09:12:09.011625 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-06-16 09:12:09.016041 (MainThread): Parsing macros/sql/union.sql
2021-06-16 09:12:09.027842 (MainThread): Parsing macros/sql/unpivot.sql
2021-06-16 09:12:09.037444 (MainThread): Parsing macros/web/get_url_host.sql
2021-06-16 09:12:09.039527 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-06-16 09:12:09.041244 (MainThread): Parsing macros/web/get_url_path.sql
2021-06-16 09:12:09.044553 (MainThread): Parsing macros/datetime/date_spine.sql
2021-06-16 09:12:09.049563 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-06-16 09:12:09.050988 (MainThread): Parsing macros/logger/log_info.sql
2021-06-16 09:12:09.052013 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-06-16 09:12:09.053068 (MainThread): Parsing macros/logger/pretty_time.sql
2021-06-16 09:12:09.062255 (MainThread): Partial parsing not enabled
2021-06-16 09:12:09.108425 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_first_dbt_model".
2021-06-16 09:12:09.123851 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.my_second_dbt_model".
2021-06-16 09:12:09.129876 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_customers".
2021-06-16 09:12:09.136120 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:12:09.138167 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_orders".
2021-06-16 09:12:09.141904 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:12:09.143870 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.cls_order_details".
2021-06-16 09:12:09.148959 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:12:09.150968 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.dim_customers".
2021-06-16 09:12:09.155987 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:12:09.158027 (MainThread): Acquiring new redshift connection "model.dbtintro_northwind.fact_orders".
2021-06-16 09:12:09.161924 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-16 09:12:09.174605 (MainThread): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:12:09.438520 (MainThread): WARNING: Found documentation for resource "country_revenue" which was not found or is disabled
2021-06-16 09:12:09.457284 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c905690-e277-4039-9954-2758050e62fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ed6bd190>]}
2021-06-16 09:12:09.465629 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c905690-e277-4039-9954-2758050e62fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ed6c3350>]}
2021-06-16 09:12:09.465918 (MainThread): Found 7 models, 7 tests, 0 snapshots, 0 analyses, 295 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-16 09:12:09.467438 (MainThread): 
2021-06-16 09:12:09.467937 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:12:09.469978 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:12:09.486204 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:12:09.486349 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: BEGIN
2021-06-16 09:12:09.486460 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-16 09:12:09.486552 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:12:09.503410 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2021-06-16 09:12:09.503584 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_cleansing".
2021-06-16 09:12:09.503700 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_cleansing"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_cleansing'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_cleansing'
  
2021-06-16 09:12:09.506424 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-06-16 09:12:09.509622 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: ROLLBACK
2021-06-16 09:12:09.510573 (ThreadPoolExecutor-1_0): On list_postgres_sifa_cleansing: Close
2021-06-16 09:12:09.511246 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa".
2021-06-16 09:12:09.513785 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:12:09.513908 (ThreadPoolExecutor-1_0): On list_postgres_sifa: BEGIN
2021-06-16 09:12:09.514018 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:12:09.514127 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:12:09.525508 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:12:09.525661 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa".
2021-06-16 09:12:09.525772 (ThreadPoolExecutor-1_0): On list_postgres_sifa: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa'
  
2021-06-16 09:12:09.528467 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2021-06-16 09:12:09.529207 (ThreadPoolExecutor-1_0): On list_postgres_sifa: ROLLBACK
2021-06-16 09:12:09.530143 (ThreadPoolExecutor-1_0): On list_postgres_sifa: Close
2021-06-16 09:12:09.530773 (ThreadPoolExecutor-1_0): Acquiring new redshift connection "list_postgres_sifa_core".
2021-06-16 09:12:09.533264 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:12:09.533385 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: BEGIN
2021-06-16 09:12:09.533491 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-16 09:12:09.533582 (ThreadPoolExecutor-1_0): Connecting to Redshift using 'database' credentials
2021-06-16 09:12:09.545218 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:12:09.545362 (ThreadPoolExecutor-1_0): Using redshift connection "list_postgres_sifa_core".
2021-06-16 09:12:09.545481 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_sifa_core"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'sifa_core'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'sifa_core'
  
2021-06-16 09:12:09.548192 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2021-06-16 09:12:09.548851 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: ROLLBACK
2021-06-16 09:12:09.549758 (ThreadPoolExecutor-1_0): On list_postgres_sifa_core: Close
2021-06-16 09:12:09.556760 (MainThread): Using redshift connection "master".
2021-06-16 09:12:09.556898 (MainThread): On master: BEGIN
2021-06-16 09:12:09.557006 (MainThread): Opening a new connection, currently in state init
2021-06-16 09:12:09.557096 (MainThread): Connecting to Redshift using 'database' credentials
2021-06-16 09:12:09.568605 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:12:09.568801 (MainThread): Using redshift connection "master".
2021-06-16 09:12:09.568915 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-06-16 09:12:09.713143 (MainThread): SQL status: SELECT 7 in 0.14 seconds
2021-06-16 09:12:09.714293 (MainThread): On master: ROLLBACK
2021-06-16 09:12:09.715290 (MainThread): On master: Close
2021-06-16 09:12:09.715885 (MainThread): 09:12:09 | Concurrency: 1 threads (target='dev')
2021-06-16 09:12:09.716175 (MainThread): 09:12:09 | 
2021-06-16 09:12:09.718030 (Thread-1): Began running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:12:09.718234 (Thread-1): 09:12:09 | 1 of 1 START test assert_orderamount................................. [RUN]
2021-06-16 09:12:09.718569 (Thread-1): Acquiring new redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:12:09.718722 (Thread-1): Compiling test.dbtintro_northwind.assert_orderamount
2021-06-16 09:12:09.732443 (Thread-1): Writing injected SQL for node "test.dbtintro_northwind.assert_orderamount"
2021-06-16 09:12:09.732832 (Thread-1): finished collecting timing info
2021-06-16 09:12:09.733033 (Thread-1): Using redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:12:09.733146 (Thread-1): On test.dbtintro_northwind.assert_orderamount: BEGIN
2021-06-16 09:12:09.733253 (Thread-1): Opening a new connection, currently in state closed
2021-06-16 09:12:09.733397 (Thread-1): Connecting to Redshift using 'database' credentials
2021-06-16 09:12:09.745398 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-06-16 09:12:09.745554 (Thread-1): Using redshift connection "test.dbtintro_northwind.assert_orderamount".
2021-06-16 09:12:09.745670 (Thread-1): On test.dbtintro_northwind.assert_orderamount: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "default", "target_name": "dev", "node_id": "test.dbtintro_northwind.assert_orderamount"} */

with dbt__CTE__INTERNAL_test as (
-- ASSERTION: Check order quantity in range

select *
from "postgres"."sifa_cleansing"."cls_order_details"
where quantity < 3
  or unit_price <= 0



-- Command: dbt test --data
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-16 09:12:09.748236 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-06-16 09:12:09.748559 (Thread-1): finished collecting timing info
2021-06-16 09:12:09.748729 (Thread-1): On test.dbtintro_northwind.assert_orderamount: ROLLBACK
2021-06-16 09:12:09.749658 (Thread-1): On test.dbtintro_northwind.assert_orderamount: Close
2021-06-16 09:12:09.750180 (Thread-1): 09:12:09 | 1 of 1 FAIL 251 assert_orderamount................................... [FAIL 251 in 0.03s]
2021-06-16 09:12:09.750459 (Thread-1): Finished running node test.dbtintro_northwind.assert_orderamount
2021-06-16 09:12:09.818562 (MainThread): Acquiring new redshift connection "master".
2021-06-16 09:12:09.819030 (MainThread): 09:12:09 | 
2021-06-16 09:12:09.819324 (MainThread): 09:12:09 | Finished running 1 test in 0.35s.
2021-06-16 09:12:09.819553 (MainThread): Connection 'master' was properly closed.
2021-06-16 09:12:09.819663 (MainThread): Connection 'test.dbtintro_northwind.assert_orderamount' was properly closed.
2021-06-16 09:12:09.827195 (MainThread): 
2021-06-16 09:12:09.827464 (MainThread): Completed with 1 error and 0 warnings:
2021-06-16 09:12:09.827688 (MainThread): 
2021-06-16 09:12:09.827976 (MainThread): Failure in test assert_orderamount (tests/assert_orderamount.sql)
2021-06-16 09:12:09.828211 (MainThread):   Got 251 results, expected 0.
2021-06-16 09:12:09.828432 (MainThread): 
2021-06-16 09:12:09.828681 (MainThread):   compiled SQL at target/compiled/dbtintro_northwind/tests/assert_orderamount.sql
2021-06-16 09:12:09.828910 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-16 09:12:09.829210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ed4a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ed4d4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ed4d4cd0>]}
2021-06-16 09:12:09.829452 (MainThread): Flushing usage events
